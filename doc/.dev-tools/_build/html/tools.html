
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>tools package &#8212; ProtoMS 3.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head>
  <body>

<!--<div style="background-color: white; text-align: center; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci" style="width: 10em"/></a>
</div>-->

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/dolphin.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">tools package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-tools.ambertools">tools.ambertools module</a></li>
<li><a class="reference internal" href="#module-tools.build_template">tools.build_template module</a></li>
<li><a class="reference internal" href="#module-tools.calc_clusters">tools.calc_clusters module</a></li>
<li><a class="reference internal" href="#module-tools.calc_density">tools.calc_density module</a></li>
<li><a class="reference internal" href="#module-tools.calc_dg">tools.calc_dg module</a></li>
<li><a class="reference internal" href="#tools-calc-dg-cycle-module">tools.calc_dg_cycle module</a></li>
<li><a class="reference internal" href="#module-tools.calc_gci">tools.calc_gci module</a></li>
<li><a class="reference internal" href="#module-tools.calc_replicapath">tools.calc_replicapath module</a></li>
<li><a class="reference internal" href="#module-tools.calc_rmsd">tools.calc_rmsd module</a></li>
<li><a class="reference internal" href="#module-tools.calc_series">tools.calc_series module</a></li>
<li><a class="reference internal" href="#tools-calc-ti-decomposed-module">tools.calc_ti_decomposed module</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#module-tools.clear_gcmcbox">tools.clear_gcmcbox module</a></li>
<li><a class="reference internal" href="#module-tools.convertatomnames">tools.convertatomnames module</a></li>
<li><a class="reference internal" href="#module-tools.convertwater">tools.convertwater module</a></li>
<li><a class="reference internal" href="#module-tools.distribute_waters">tools.distribute_waters module</a></li>
<li><a class="reference internal" href="#module-tools.divide_pdb">tools.divide_pdb module</a></li>
<li><a class="reference internal" href="#module-tools.free_energy_base">tools.free_energy_base module</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#tools-gcmc-free-energy-base-module">tools.gcmc_free_energy_base module</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#module-tools.generate_input">tools.generate_input module</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#module-tools.make_dummy">tools.make_dummy module</a></li>
<li><a class="reference internal" href="#module-tools.make_gcmcbox">tools.make_gcmcbox module</a></li>
<li><a class="reference internal" href="#module-tools.make_single">tools.make_single module</a></li>
<li><a class="reference internal" href="#module-tools.merge_templates">tools.merge_templates module</a></li>
<li><a class="reference internal" href="#module-tools.pms2pymbar">tools.pms2pymbar module</a></li>
<li><a class="reference internal" href="#module-tools.scoop">tools.scoop module</a></li>
<li><a class="reference internal" href="#module-tools.simulationobjects">tools.simulationobjects module</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#module-tools.solvate">tools.solvate module</a></li>
<li><a class="reference internal" href="#module-tools.split_jawswater">tools.split_jawswater module</a></li>
<li><a class="reference internal" href="#module-tools">Module contents</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tools.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tools-package">
<h1>tools package<a class="headerlink" href="#tools-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tools.ambertools">
<span id="tools-ambertools-module"></span><h2>tools.ambertools module<a class="headerlink" href="#module-tools.ambertools" title="Permalink to this headline">¶</a></h2>
<p>Routines that wrap AmberTools programs</p>
<p>This module defines two public functions:
run_antechamber
run_parmchk</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.ambertools.get_arg_parser">
<code class="descclassname">tools.ambertools.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.ambertools.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.ambertools.run_antechamber">
<code class="descclassname">tools.ambertools.</code><code class="descname">run_antechamber</code><span class="sig-paren">(</span><em>lig</em>, <em>charge</em>, <em>resnam=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.ambertools.run_antechamber" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for antechamber with default parameters and AM1-BCC charges</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lig</strong> : PDBFile or string</p>
<blockquote>
<div><p>the ligand to run Antechamber on</p>
</div></blockquote>
<p><strong>charge</strong> : int</p>
<blockquote>
<div><p>the net charge of the ligand</p>
</div></blockquote>
<p><strong>resnam</strong> : string, optional</p>
<blockquote>
<div><p>the residue name of the ligand</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">string</p>
<blockquote class="last">
<div><p>the filename of the created prepi file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.ambertools.run_parmchk">
<code class="descclassname">tools.ambertools.</code><code class="descname">run_parmchk</code><span class="sig-paren">(</span><em>lig</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.ambertools.run_parmchk" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for parmcheck with default parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lig</strong> : PDBFile or string</p>
<blockquote>
<div><p>the ligand to run Parmcheck on</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">string</p>
<blockquote class="last">
<div><p>the filename of the created frcmod file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.build_template">
<span id="tools-build-template-module"></span><h2>tools.build_template module<a class="headerlink" href="#module-tools.build_template" title="Permalink to this headline">¶</a></h2>
<p>Routines to build a ProtoMS template file</p>
<p>The module defines a two public function
build_template
make_zmat</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="class">
<dt id="tools.build_template.PrepiAtom">
<em class="property">class </em><code class="descclassname">tools.build_template.</code><code class="descname">PrepiAtom</code><a class="headerlink" href="#tools.build_template.PrepiAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to encapsulate an atom in an Amber prepi file
and its connectivity</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>atype</strong></td>
<td>(string) the atom type</td>
</tr>
<tr class="row-even"><td><strong>bondidx</strong></td>
<td>(int) the index of the atom this atom is bonded to in the prepi z-matrix</td>
</tr>
<tr class="row-odd"><td><strong>bonds</strong></td>
<td>(list) names of all atoms this atom is bonded to</td>
</tr>
<tr class="row-even"><td><strong>charge</strong></td>
<td>(float) the charge</td>
</tr>
<tr class="row-odd"><td><strong>index</strong></td>
<td>(int) the serial number in the prepi file</td>
</tr>
<tr class="row-even"><td><strong>is_on_loop</strong></td>
<td>(dictionary) a flag for each atom in bonds indicating if the bond is part of a loop</td>
</tr>
<tr class="row-odd"><td><strong>loop_closure</strong></td>
<td>(dictionary) a flag for each atom in bonds indicating if the bond was part of a loop statement in the prepi file</td>
</tr>
<tr class="row-even"><td><strong>name</strong></td>
<td>(string) the atom name</td>
</tr>
<tr class="row-odd"><td><strong>traversed</strong></td>
<td>(dictionary) a flag for each atom in bonds indicating if the bond has been traversed</td>
</tr>
<tr class="row-even"><td><strong>zmat</strong></td>
<td>(list) atom names of the atoms defined to this atom in the z-matrix</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.add_bond" title="tools.build_template.PrepiAtom.add_bond"><code class="xref py py-obj docutils literal"><span class="pre">add_bond</span></code></a>(atomname[,&nbsp;loop_closure])</td>
<td>Add a bond to this atom</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.backward_bond" title="tools.build_template.PrepiAtom.backward_bond"><code class="xref py py-obj docutils literal"><span class="pre">backward_bond</span></code></a>(exclude,&nbsp;defined)</td>
<td>Find an atom, bonded to this atom that has</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.improper_dihedral" title="tools.build_template.PrepiAtom.improper_dihedral"><code class="xref py py-obj docutils literal"><span class="pre">improper_dihedral</span></code></a>(exclude,&nbsp;defined)</td>
<td>Look for the definition of an improper dihedral:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.next_bond" title="tools.build_template.PrepiAtom.next_bond"><code class="xref py py-obj docutils literal"><span class="pre">next_bond</span></code></a>(defined[,&nbsp;update])</td>
<td>Find an atom, bonded to this atom that</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.read" title="tools.build_template.PrepiAtom.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(record,&nbsp;atomlist)</td>
<td>Read a line from an Amber prepi-file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.sort_bonds" title="tools.build_template.PrepiAtom.sort_bonds"><code class="xref py py-obj docutils literal"><span class="pre">sort_bonds</span></code></a>(metric)</td>
<td>Sort the bonds based on some metric</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.build_template.PrepiAtom.add_bond">
<code class="descname">add_bond</code><span class="sig-paren">(</span><em>atomname</em>, <em>loop_closure=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.add_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a bond to this atom</p>
</dd></dl>

<dl class="method">
<dt id="tools.build_template.PrepiAtom.backward_bond">
<code class="descname">backward_bond</code><span class="sig-paren">(</span><em>exclude</em>, <em>defined</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.backward_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an atom, bonded to this atom that has
already been defined but is not in the list of excluded atoms</p>
</dd></dl>

<dl class="method">
<dt id="tools.build_template.PrepiAtom.improper_dihedral">
<code class="descname">improper_dihedral</code><span class="sig-paren">(</span><em>exclude</em>, <em>defined</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.improper_dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>Look for the definition of an improper dihedral:
see if at least two bonds to this atom has been defined, 
excluding the bond in the exclude list</p>
</dd></dl>

<dl class="method">
<dt id="tools.build_template.PrepiAtom.next_bond">
<code class="descname">next_bond</code><span class="sig-paren">(</span><em>defined</em>, <em>update=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.next_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an atom, bonded to this atom that 
has not been defined and where the bond has not been traversed</p>
</dd></dl>

<dl class="method">
<dt id="tools.build_template.PrepiAtom.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>record</em>, <em>atomlist</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a line from an Amber prepi-file</p>
</dd></dl>

<dl class="method">
<dt id="tools.build_template.PrepiAtom.sort_bonds">
<code class="descname">sort_bonds</code><span class="sig-paren">(</span><em>metric</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.sort_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort the bonds based on some metric</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.build_template.build_template">
<code class="descclassname">tools.build_template.</code><code class="descname">build_template</code><span class="sig-paren">(</span><em>temfile</em>, <em>prepifile</em>, <em>translate=0.1</em>, <em>rotate=1.0</em>, <em>zmatfile=None</em>, <em>frcmodfile=None</em>, <em>resname='UNK'</em>, <em>alldihs=False</em>, <em>gaffversion='gaff16'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.build_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a ProtoMS template file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>temfile</strong> : string</p>
<blockquote>
<div><p>the filename to save the template file to</p>
</div></blockquote>
<p><strong>prepifile</strong> : string</p>
<blockquote>
<div><p>the filename of the Amber prepi file (prep-file with z-matrix)</p>
</div></blockquote>
<p><strong>translate</strong> : float, optional</p>
<blockquote>
<div><p>the translational displacement</p>
</div></blockquote>
<p><strong>rotate</strong> : float, optional</p>
<blockquote>
<div><p>the rotational displacement</p>
</div></blockquote>
<p><strong>zmatfile</strong> : string, optional</p>
<blockquote>
<div><p>the filename of a zmat, if None it is created</p>
</div></blockquote>
<p><strong>frcmodfile</strong> : string, optional</p>
<blockquote>
<div><p>the filename of an Amber frcmod file with additional parameters</p>
</div></blockquote>
<p><strong>resname</strong> : string, optional</p>
<blockquote>
<div><p>the name of solute</p>
</div></blockquote>
<p><strong>alldihs</strong> : boolean, optional</p>
<blockquote>
<div><p>set True to sample improper dihedrals</p>
</div></blockquote>
<p><strong>gaffversion</strong> : string, optional</p>
<blockquote>
<div><p>the version of GAFF to use</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">TemplateFile</p>
<blockquote class="last">
<div><p>the created template file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.build_template.get_arg_parser">
<code class="descclassname">tools.build_template.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.build_template.make_zmat">
<code class="descclassname">tools.build_template.</code><code class="descname">make_zmat</code><span class="sig-paren">(</span><em>prepifile</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.make_zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a ProtoMS z-matrix for a solute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prepifile</strong> : string</p>
<blockquote>
<div><p>the filename of the Amber prepi file (prep-file with z-matrix)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>atoms</strong> : dictionary</p>
<blockquote>
<div><p>created PrepiAtom objects</p>
</div></blockquote>
<p><strong>all_zmat</strong> : list</p>
<blockquote class="last">
<div><p>a list of atoms with their z-matrix atoms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_clusters">
<span id="tools-calc-clusters-module"></span><h2>tools.calc_clusters module<a class="headerlink" href="#module-tools.calc_clusters" title="Permalink to this headline">¶</a></h2>
<p>Routines to cluster molecules from simulations.</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_clusters.cluster_coords">
<code class="descclassname">tools.calc_clusters.</code><code class="descname">cluster_coords</code><span class="sig-paren">(</span><em>confs</em>, <em>clustmethod='average'</em>, <em>cutoff=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_clusters.cluster_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Clusters the supplied conformations in a hierarchical fasion</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>conformations</strong> : Numpy array</p>
<blockquote>
<div><p>Array of the coordinates of the different conformations</p>
</div></blockquote>
<p><strong>method</strong> : String</p>
<blockquote>
<div><p>the hierarchical clustering method</p>
</div></blockquote>
<p><strong>cutoff</strong> : Float</p>
<blockquote>
<div><p>the RMSD cutoff that specifies whether conformations are in the same cluster.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumpyArray</p>
<blockquote>
<div><p>the coordinates of the cluster representatives</p>
</div></blockquote>
<p>NumpyArray</p>
<blockquote class="last">
<div><p>the coordinates of the cluster centroids</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_clusters.get_arg_parser">
<code class="descclassname">tools.calc_clusters.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_clusters.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.calc_clusters.get_coords">
<code class="descclassname">tools.calc_clusters.</code><code class="descname">get_coords</code><span class="sig-paren">(</span><em>pdbfiles</em>, <em>molname</em>, <em>atomname</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_clusters.get_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the coordinates of a specified molecule name or a named atom from supplied PDB files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbfiles</strong> : PDBSet</p>
<blockquote>
<div><p>the PDB files</p>
</div></blockquote>
<p><strong>residue</strong> : string</p>
<blockquote>
<div><p>the residue to extract</p>
</div></blockquote>
<p><strong>atom</strong> : string</p>
<blockquote>
<div><p>the name of the atom to extract (optional)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumpyArray of coordinates</p>
<blockquote>
<div><p>the x,y,z coordinates of the specified molecule or atom</p>
</div></blockquote>
<p>Integer</p>
<blockquote class="last">
<div><p>the number of molecules or atoms matching the names.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_density">
<span id="tools-calc-density-module"></span><h2>tools.calc_density module<a class="headerlink" href="#module-tools.calc_density" title="Permalink to this headline">¶</a></h2>
<p>Routine to calculate a density from a set of PDB files</p>
<p>This module defines a these public functions:
calc_density
writeDX</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_density.calc_density">
<code class="descclassname">tools.calc_density.</code><code class="descname">calc_density</code><span class="sig-paren">(</span><em>pdbfiles</em>, <em>molname</em>, <em>atomname</em>, <em>padding=2.0</em>, <em>extent=1.0</em>, <em>spacing=0.5</em>, <em>norm=None</em>, <em>smoothing='sphere'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_density.calc_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the density from a set of PDB files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbfiles</strong> : PDBSet</p>
<blockquote>
<div><p>the PDB files</p>
</div></blockquote>
<p><strong>residue</strong> : string</p>
<blockquote>
<div><p>the residue to extract</p>
</div></blockquote>
<p><strong>atom</strong> : string</p>
<blockquote>
<div><p>the name of the atom to make a density from</p>
</div></blockquote>
<p><strong>padding</strong> : float, optional</p>
<blockquote>
<div><p>extra space to add to the minimum extent</p>
</div></blockquote>
<p><strong>extent</strong> : float, optional</p>
<blockquote>
<div><p>the extent of the smoothing</p>
</div></blockquote>
<p><strong>spacing</strong> : float, optional</p>
<blockquote>
<div><p>the spacing of the grid</p>
</div></blockquote>
<p><strong>norm</strong> : int, optional</p>
<blockquote>
<div><p>number to normalize the density by</p>
</div></blockquote>
<p><strong>smoothing</strong> : string, optional</p>
<blockquote>
<div><p>kind of smoothing, can be either sphere or gauss</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumpyArray of integers</p>
<blockquote>
<div><p>the number of atom extracted from each PDB structure</p>
</div></blockquote>
<p>NumpyArray</p>
<blockquote>
<div><p>the 3D density</p>
</div></blockquote>
<p>dictionary</p>
<blockquote class="last">
<div><p>grid properties, keys = spacing, min, and max</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_density.get_arg_parser">
<code class="descclassname">tools.calc_density.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_density.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.calc_density.writeDX">
<code class="descclassname">tools.calc_density.</code><code class="descname">writeDX</code><span class="sig-paren">(</span><em>grid</em>, <em>origin</em>, <em>spacing</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_density.writeDX" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the grid to file in DX-format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>grid</strong> : Numpy array</p>
<blockquote>
<div><p>the 3D grid</p>
</div></blockquote>
<p><strong>origin</strong> : NumpyArray</p>
<blockquote>
<div><p>the bottom-left coordinate of the grid</p>
</div></blockquote>
<p><strong>spacing</strong> : float</p>
<blockquote>
<div><p>the grid spacing</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the DX file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_dg">
<span id="tools-calc-dg-module"></span><h2>tools.calc_dg module<a class="headerlink" href="#module-tools.calc_dg" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="tools.calc_dg.FreeEnergyCalculation">
<em class="property">class </em><code class="descclassname">tools.calc_dg.</code><code class="descname">FreeEnergyCalculation</code><span class="sig-paren">(</span><em>root_paths, temperature, estimators=[&lt;class 'tools.free_energy_base.TI'&gt;, &lt;class 'tools.free_energy_base.BAR'&gt;, &lt;class 'tools.free_energy_base.MBAR'&gt;], subdir='', extract_data=True, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg.FreeEnergyCalculation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.FreeEnergyCalculation" title="tools.free_energy_base.FreeEnergyCalculation"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.FreeEnergyCalculation</span></code></a></p>
<p>Perform a basic free energy calculation.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code>([subset])</td>
<td>For each estimator return the evaluated potential of mean force.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(args)</td>
<td>Public method for execution of calculation.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.calc_dg.FreeEnergyCalculation.test_convergence" title="tools.calc_dg.FreeEnergyCalculation.test_convergence"><code class="xref py py-obj docutils literal"><span class="pre">test_convergence</span></code></a>(discard_limit[,&nbsp;lower_limit])</td>
<td>Perform a series of calculations discarding increasing portions from the end of the loaded data series.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.calc_dg.FreeEnergyCalculation.test_equilibration" title="tools.calc_dg.FreeEnergyCalculation.test_equilibration"><code class="xref py py-obj docutils literal"><span class="pre">test_equilibration</span></code></a>(discard_limit)</td>
<td>Perform a series of calculations discarding increasing portions from the start of the loaded data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.calc_dg.FreeEnergyCalculation.test_convergence">
<code class="descname">test_convergence</code><span class="sig-paren">(</span><em>discard_limit</em>, <em>lower_limit=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg.FreeEnergyCalculation.test_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a series of calculations discarding increasing portions
from the end of the loaded data series. This assesses whether
sufficient data has been sampled to produce converged free energy
estimates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>discard_limit</strong> : float</p>
<blockquote>
<div><p>Value between 0 and 1 that indicates the minimum proportion of data
to use. E.g. a value of 0.8 would perform a series of calculations
that range between using the all of the available data and the first
80% of the data.</p>
</div></blockquote>
<p><strong>lower_limit</strong> : float, optional</p>
<blockquote class="last">
<div><p>Specifies an initial proportion of the data set to discard from all
calculations. Allows unequilibrated data to be removed.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.calc_dg.FreeEnergyCalculation.test_equilibration">
<code class="descname">test_equilibration</code><span class="sig-paren">(</span><em>discard_limit</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg.FreeEnergyCalculation.test_equilibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a series of calculations discarding increasing portions
from the start of the loaded data series. This assesses whether
unequilibrated data from the start of a simulation is biasing
the result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>discard_limit</strong> : float</p>
<blockquote class="last">
<div><p>Value between 0 and 1 that indicates the maximum amount of
data to discard. E.g. a value of 0.2 would perform a series
of calculations that range between using all of available
data and the last 80% of the data.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.calc_dg.get_arg_parser">
<code class="descclassname">tools.calc_dg.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the custom argument parser for this script</p>
</dd></dl>

<dl class="function">
<dt id="tools.calc_dg.make_result_tables">
<code class="descclassname">tools.calc_dg.</code><code class="descname">make_result_tables</code><span class="sig-paren">(</span><em>directories</em>, <em>results</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg.make_result_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Print calculated free energies. If multiple repeats are present
the mean and standard error are also printed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>directories</strong> : list of list (or other sequences) of strings</p>
<blockquote>
<div><p>the directory name associated with each result</p>
</div></blockquote>
<p class="last"><strong>results</strong> : dict of Estimator class-Result object pairs</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_dg.plot_fractional_dataset_results">
<code class="descclassname">tools.calc_dg.</code><code class="descname">plot_fractional_dataset_results</code><span class="sig-paren">(</span><em>results</em>, <em>estimators</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg.plot_fractional_dataset_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot results of calculations that use variable portions of available
data i.e. equilibration and convergence tests.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>results</strong> : dict of float-(dict of Estimator class-Result object pairs)</p>
<blockquote>
<div><p>results to plot, keys are used as the x-values</p>
</div></blockquote>
<p><strong>estimators</strong> : list (or other sequence) of Estimator classes</p>
<blockquote class="last">
<div><p>Estimator classes used to store</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_dg.plot_pmfs">
<code class="descclassname">tools.calc_dg.</code><code class="descname">plot_pmfs</code><span class="sig-paren">(</span><em>results</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg.plot_pmfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot average potentials of mean force for all (1d) estimators.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>results</strong> : dict of Estimator class-Result object pairs</p>
<blockquote class="last">
<div><p>the results to plot</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_dg.plot_pmfs_2d">
<code class="descclassname">tools.calc_dg.</code><code class="descname">plot_pmfs_2d</code><span class="sig-paren">(</span><em>results</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg.plot_pmfs_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot average potentials of mean force for all (2d) estimators</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>results</strong> : list (or other sequence) of results objects</p>
<blockquote class="last">
<div><p>the results to plot</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_dg.plot_results">
<code class="descclassname">tools.calc_dg.</code><code class="descname">plot_results</code><span class="sig-paren">(</span><em>x</em>, <em>results</em>, <em>axes</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg.plot_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the free energy differences from a collection of result objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : list (or other sequence) of numbers</p>
<blockquote>
<div><p>the x-axis values</p>
</div></blockquote>
<p><strong>results</strong> : list (or other sequence) of Result objects</p>
<blockquote>
<div><p>the free energy results to plot</p>
</div></blockquote>
<p><strong>axes</strong> : a matplotlib.Axes object</p>
<blockquote>
<div><p>the axes to plot on</p>
</div></blockquote>
<p><strong>**kwargs :</strong></p>
<blockquote class="last">
<div><p>all additional keyword arguments are passed to axes.plot()</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_dg.run_script">
<code class="descclassname">tools.calc_dg.</code><code class="descname">run_script</code><span class="sig-paren">(</span><em>cmdline</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg.run_script" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the script, allows for straight-forward testing.</p>
</dd></dl>

</div>
<div class="section" id="tools-calc-dg-cycle-module">
<h2>tools.calc_dg_cycle module<a class="headerlink" href="#tools-calc-dg-cycle-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-tools.calc_dg_cycle"></span><dl class="class">
<dt id="tools.calc_dg_cycle.CycleCalculation">
<em class="property">class </em><code class="descclassname">tools.calc_dg_cycle.</code><code class="descname">CycleCalculation</code><span class="sig-paren">(</span><em>estimators=[&lt;class 'tools.free_energy_base.TI'&gt;, &lt;class 'tools.free_energy_base.BAR'&gt;, &lt;class 'tools.free_energy_base.MBAR'&gt;], volume=None, results_name='results'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg_cycle.CycleCalculation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.FreeEnergyCalculation" title="tools.free_energy_base.FreeEnergyCalculation"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.FreeEnergyCalculation</span></code></a></p>
<p>Perform multiple free energy calculations and combine the
results to calculate a cycle.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code>([subset])</td>
<td>For each estimator return the evaluated potential of mean force.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(args)</td>
<td>Public method for execution of calculation.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_dg_cycle.get_arg_parser">
<code class="descclassname">tools.calc_dg_cycle.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg_cycle.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the custom argument parser for this script</p>
</dd></dl>

<dl class="function">
<dt id="tools.calc_dg_cycle.run_script">
<code class="descclassname">tools.calc_dg_cycle.</code><code class="descname">run_script</code><span class="sig-paren">(</span><em>cmdline</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg_cycle.run_script" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the script, allows for straight-forward testing.</p>
</dd></dl>

<dl class="function">
<dt id="tools.calc_dg_cycle.solv_bind_table">
<code class="descclassname">tools.calc_dg_cycle.</code><code class="descname">solv_bind_table</code><span class="sig-paren">(</span><em>dG_solvs</em>, <em>dG_binds</em>, <em>directories</em>, <em>signs</em>, <em>estimator</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg_cycle.solv_bind_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Table object containing free energies of solvation and
binding.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dG_solvs: dictionary[root][estimator] = Result object</strong></p>
<blockquote>
<div><p>Calculated solvation free energy results</p>
</div></blockquote>
<p><strong>dG_binds: dictionary[root][estimator] = Result object</strong></p>
<blockquote>
<div><p>Calculated binding free energy results</p>
</div></blockquote>
<p><strong>directories: list of strings</strong></p>
<blockquote>
<div><p>List of root directories containing calculation data</p>
</div></blockquote>
<p><strong>signs: list of ‘+’ or ‘-‘</strong></p>
<blockquote>
<div><p>The signs to use when calculating the free energy cycle</p>
</div></blockquote>
<p><strong>estimator: Estimator Class</strong></p>
<blockquote class="last">
<div><p>The estimator to tabulate results of</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_dg_cycle.state_data_table">
<code class="descclassname">tools.calc_dg_cycle.</code><code class="descname">state_data_table</code><span class="sig-paren">(</span><em>results</em>, <em>directories</em>, <em>signs</em>, <em>states</em>, <em>estimator</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_dg_cycle.state_data_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Table object containing the free energy differences for the
individual states i.e. bound, free and gas.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>results: dict such that results[root][state][estimator] = Result object</strong></p>
<blockquote>
<div><p>The free energy results to tabulate</p>
</div></blockquote>
<p><strong>directories: list of strings</strong></p>
<blockquote>
<div><p>List of root directories containing calculation data</p>
</div></blockquote>
<p><strong>signs: list of ‘+’ or ‘-‘</strong></p>
<blockquote>
<div><p>The signs to use when calculating the free energy cycle</p>
</div></blockquote>
<p><strong>states: list of strings</strong></p>
<blockquote>
<div><p>The thermodynamic states simulated</p>
</div></blockquote>
<p><strong>estimator: Estimator Class</strong></p>
<blockquote class="last">
<div><p>The estimator to tabulate results of</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_gci">
<span id="tools-calc-gci-module"></span><h2>tools.calc_gci module<a class="headerlink" href="#module-tools.calc_gci" title="Permalink to this headline">¶</a></h2>
<p>Routines to calculate free energies with GCMC as outlined in
J. Am. Chem. Soc., 2015, 137 (47), pp 14930-14943</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="class">
<dt id="tools.calc_gci.TitrationCalculation">
<em class="property">class </em><code class="descclassname">tools.calc_gci.</code><code class="descname">TitrationCalculation</code><span class="sig-paren">(</span><em>root_paths</em>, <em>temperature</em>, <em>volume</em>, <em>steps=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_gci.TitrationCalculation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.FreeEnergyCalculation" title="tools.free_energy_base.FreeEnergyCalculation"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.FreeEnergyCalculation</span></code></a></p>
<p>Calculate free energy differences using the Grand Canonical Integration
method. Collates water occupancy data from simulations carried out at
diferent chemical potentials and gives NVT binding free energies.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.calc_gci.TitrationCalculation.calculate" title="tools.calc_gci.TitrationCalculation.calculate"><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code></a>([subset])</td>
<td>For each estimator return the evaluated potential of mean force.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(args)</td>
<td>Public method for execution of calculation.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.calc_gci.TitrationCalculation.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>subset=(0.0</em>, <em>1.0</em>, <em>1)</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_gci.TitrationCalculation.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>For each estimator return the evaluated potential of mean force.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>subset: tuple of two floats and an int</strong></p>
<blockquote class="last">
<div><p>specify the subset of data to use in the calculation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.calc_gci.get_arg_parser">
<code class="descclassname">tools.calc_gci.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_gci.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Add custom argument parser for this script</p>
</dd></dl>

<dl class="function">
<dt id="tools.calc_gci.plot_insertion_pmf">
<code class="descclassname">tools.calc_gci.</code><code class="descname">plot_insertion_pmf</code><span class="sig-paren">(</span><em>results</em>, <em>title=''</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_gci.plot_insertion_pmf" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to plot the insertion pmf data from repeats</p>
</dd></dl>

<dl class="function">
<dt id="tools.calc_gci.plot_titration">
<code class="descclassname">tools.calc_gci.</code><code class="descname">plot_titration</code><span class="sig-paren">(</span><em>results</em>, <em>ax</em>, <em>dot_fmt='b'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_gci.plot_titration" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to plot the titration data from repeats.</p>
</dd></dl>

<dl class="function">
<dt id="tools.calc_gci.run_script">
<code class="descclassname">tools.calc_gci.</code><code class="descname">run_script</code><span class="sig-paren">(</span><em>cmdline</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_gci.run_script" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the script, allows for straight-forward testing.</p>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_replicapath">
<span id="tools-calc-replicapath-module"></span><h2>tools.calc_replicapath module<a class="headerlink" href="#module-tools.calc_replicapath" title="Permalink to this headline">¶</a></h2>
<p>Program to analyze and plot replica paths</p>
<p>This module defines the following public functions:
replica_path</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_replicapath.get_arg_parser">
<code class="descclassname">tools.calc_replicapath.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_replicapath.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.calc_replicapath.replica_path">
<code class="descclassname">tools.calc_replicapath.</code><code class="descname">replica_path</code><span class="sig-paren">(</span><em>filenames</em>, <em>replicakind='lambda'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_replicapath.replica_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract replica path from a set of results files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filenames</strong> : list of strings</p>
<blockquote>
<div><p>the files to read</p>
</div></blockquote>
<p><strong>replicakind</strong> : string</p>
<blockquote>
<div><p>the type of replica, at the moment only lambda is allowed</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote>
<div><p>the labeled replica path</p>
</div></blockquote>
<p>list</p>
<blockquote class="last">
<div><p>list of the labels for all input files</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_rmsd">
<span id="tools-calc-rmsd-module"></span><h2>tools.calc_rmsd module<a class="headerlink" href="#module-tools.calc_rmsd" title="Permalink to this headline">¶</a></h2>
<p>Routine to calculate the RMSD of the center of a ligand</p>
<p>This module defines a these public functions:
calc_rmsd</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_rmsd.calc_rmsd">
<code class="descclassname">tools.calc_rmsd.</code><code class="descname">calc_rmsd</code><span class="sig-paren">(</span><em>ref</em>, <em>structures</em>, <em>resname</em>, <em>atomname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_rmsd.calc_rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate RMSD of ligand centre or a specific atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ref</strong> : PDBFile object</p>
<blockquote>
<div><p>the reference structure</p>
</div></blockquote>
<p><strong>structures</strong> : PDBSet object</p>
<blockquote>
<div><p>the trajectory to analyze</p>
</div></blockquote>
<p><strong>resname</strong> : string</p>
<blockquote>
<div><p>the residue name of the ligand to analyze</p>
</div></blockquote>
<p><strong>atomname</strong> : string, optional</p>
<blockquote>
<div><p>the atom name to analyze, if not set will analyze geometric centre</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float :</p>
<blockquote class="last">
<div><p>the RMSD in Angstroms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_rmsd.get_arg_parser">
<code class="descclassname">tools.calc_rmsd.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_rmsd.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tools.calc_series">
<span id="tools-calc-series-module"></span><h2>tools.calc_series module<a class="headerlink" href="#module-tools.calc_series" title="Permalink to this headline">¶</a></h2>
<p>Program to analyze and plot data series</p>
<p>This module defines the following public functions:
find_equilibration
stats_inefficiency
maximize_samples
running
moving
parse_series
parse_files
plot_series
write_series</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_series.find_equilibration">
<code class="descclassname">tools.calc_series.</code><code class="descname">find_equilibration</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>atleast=10</em>, <em>threshold=0.05</em>, <em>nperm=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.find_equilibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the equilibration time of a data series</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : Numpy array</p>
<blockquote>
<div><p>the x data</p>
</div></blockquote>
<p><strong>y</strong> : Numpy array</p>
<blockquote>
<div><p>the y data</p>
</div></blockquote>
<p><strong>atleast</strong> : int, optional</p>
<blockquote>
<div><p>this is the smallest number of snapshots considered to be production</p>
</div></blockquote>
<p><strong>threshold</strong> : float, optional</p>
<blockquote>
<div><p>the confidence level</p>
</div></blockquote>
<p><strong>nperm</strong> : int, optional</p>
<blockquote>
<div><p>if greater than zero, a permutation test is peformed with nperm synthetic permuations</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>the length of the equilibration period</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.get_arg_parser">
<code class="descclassname">tools.calc_series.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.calc_series.maximize_samples">
<code class="descclassname">tools.calc_series.</code><code class="descname">maximize_samples</code><span class="sig-paren">(</span><em>y</em>, <em>atleast=10</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.maximize_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the minimum of the statistical inefficiency by varying
the equlibration period, i.e. maximizing the number of 
uncorrelated samples</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>y</strong> : Numpy array</p>
<blockquote>
<div><p>the data</p>
</div></blockquote>
<p><strong>atleast</strong> : int, optional</p>
<blockquote>
<div><p>this is the smallest number of snapshots considered to be production</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote>
<div><p>the snapshot at which g is maximum</p>
</div></blockquote>
<p>float</p>
<blockquote>
<div><p>maximum of g</p>
</div></blockquote>
<p>int</p>
<blockquote class="last">
<div><p>the number of uncorrelated samples</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.moving">
<code class="descclassname">tools.calc_series.</code><code class="descname">moving</code><span class="sig-paren">(</span><em>data</em>, <em>window</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.moving" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a moving/rolling average of the data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : NumpyArray</p>
<blockquote>
<div><p>the input data, should be 1D</p>
</div></blockquote>
<p><strong>window</strong> : int</p>
<blockquote>
<div><p>the window size</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumpyArray</p>
<blockquote class="last">
<div><p>the averaged data</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.parse_files">
<code class="descclassname">tools.calc_series.</code><code class="descname">parse_files</code><span class="sig-paren">(</span><em>filenames</em>, <em>series</em>, <em>all_results</em>, <em>ys</em>, <em>labels</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.parse_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse multiple results file</p>
<p>If a data serie in series can be calculated over multiple
input files, the data serie is replaced by some calculation 
over all input files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filenames</strong> : list of strings</p>
<blockquote>
<div><p>the files to parse</p>
</div></blockquote>
<p><strong>series</strong> : list of strings</p>
<blockquote>
<div><p>the series selected</p>
</div></blockquote>
<p><strong>all_results</strong> : list of SnapshotResults</p>
<blockquote>
<div><p>all the results loaded from all input files, needs to be initialized before calling this routine</p>
</div></blockquote>
<p><strong>ys</strong> : list of NumpyArrays</p>
<blockquote>
<div><p>all the series</p>
</div></blockquote>
<p><strong>labels</strong> : list of strings</p>
<blockquote>
<div><p>labels for all the data series</p>
</div></blockquote>
<p><strong>**kwargs</strong> : dictionary</p>
<blockquote>
<div><p>additional parameters, passed directly to the different parsers</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bool</p>
<blockquote class="last">
<div><p>whether the series has been modified, i.e. if any parser was found</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.parse_series">
<code class="descclassname">tools.calc_series.</code><code class="descname">parse_series</code><span class="sig-paren">(</span><em>series</em>, <em>results</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.parse_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract data series and label from a results file based on a label</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>series</strong> : list of string</p>
<blockquote>
<div><p>the series to extract</p>
</div></blockquote>
<p><strong>results</strong> : SnapshotResults object</p>
<blockquote>
<div><p>all the results</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of NumpyArrays</p>
<blockquote>
<div><p>the data series</p>
</div></blockquote>
<p>list of string</p>
<blockquote class="last">
<div><p>the labels for the series</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.plot_series">
<code class="descclassname">tools.calc_series.</code><code class="descname">plot_series</code><span class="sig-paren">(</span><em>ys</em>, <em>yprop</em>, <em>labels</em>, <em>offset</em>, <em>plotkind</em>, <em>outprefix</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.plot_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a series</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ys</strong> : list of Numpy arrays</p>
<blockquote>
<div><p>the data series</p>
</div></blockquote>
<p><strong>yprop</strong> : list of dictionary</p>
<blockquote>
<div><p>statistical properties of the data</p>
</div></blockquote>
<p><strong>labels</strong> : list of strings</p>
<blockquote>
<div><p>the labels for the data series</p>
</div></blockquote>
<p><strong>offset</strong> : int</p>
<blockquote>
<div><p>the offset of x from 1</p>
</div></blockquote>
<p><strong>plotkind</strong> : string</p>
<blockquote>
<div><p>the type of plot to create, can be either sep, sub, single, single_first0 or single_last0</p>
</div></blockquote>
<p><strong>outprefix</strong> : string</p>
<blockquote class="last">
<div><p>the prefix of the created png-files</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.running">
<code class="descclassname">tools.calc_series.</code><code class="descname">running</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.running" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a running average of the data</p>
<p>Value at position i of the returned data is the average of the input data from point zero to point i</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : NumpyArray</p>
<blockquote>
<div><p>the input data, should be 1D</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumpyArray</p>
<blockquote class="last">
<div><p>the averaged data</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.stat_inefficiency">
<code class="descclassname">tools.calc_series.</code><code class="descname">stat_inefficiency</code><span class="sig-paren">(</span><em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.stat_inefficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the statistical inefficiency, g.</p>
<p>g = 1 + 2*tau, where tau is the autocorrelation time</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>y</strong> : Numpy array</p>
<blockquote>
<div><p>the data</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>g, the inefficiency
or None if variance is too small</p>
</div></blockquote>
<p>float</p>
<blockquote class="last">
<div><p>neff, the number of samples 
or None if variance is too small</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.write_series">
<code class="descclassname">tools.calc_series.</code><code class="descname">write_series</code><span class="sig-paren">(</span><em>ys</em>, <em>yprop</em>, <em>labels</em>, <em>offset</em>, <em>filekind</em>, <em>outprefix</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.write_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a series to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ys</strong> : list of Numpy arrays</p>
<blockquote>
<div><p>the data series</p>
</div></blockquote>
<p><strong>yprop</strong> : list of dictionary</p>
<blockquote>
<div><p>statistical properties of the data</p>
</div></blockquote>
<p><strong>labels</strong> : list of strings</p>
<blockquote>
<div><p>the labels for the data series</p>
</div></blockquote>
<p><strong>offset</strong> : int</p>
<blockquote>
<div><p>the offset of x from 1</p>
</div></blockquote>
<p><strong>filekind</strong> : string</p>
<blockquote>
<div><p>the type of file to write, can be either sep or single</p>
</div></blockquote>
<p><strong>outprefix</strong> : string</p>
<blockquote class="last">
<div><p>the prefix of the created files</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="tools-calc-ti-decomposed-module">
<h2>tools.calc_ti_decomposed module<a class="headerlink" href="#tools-calc-ti-decomposed-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-tools.calc_ti_decomposed"></span><dl class="class">
<dt id="tools.calc_ti_decomposed.DecomposedCalculation">
<em class="property">class </em><code class="descclassname">tools.calc_ti_decomposed.</code><code class="descname">DecomposedCalculation</code><span class="sig-paren">(</span><em>root_paths</em>, <em>subdir=''</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti_decomposed.DecomposedCalculation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.FreeEnergyCalculation" title="tools.free_energy_base.FreeEnergyCalculation"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.FreeEnergyCalculation</span></code></a></p>
<p>Calculate an alchemical free energy difference using Thermodynamic
Integration individually with difference components of the system
energy. This decomposition is additive and, although not formally
meaningful, can be helpful to identify the dominant driving forces
or to debug problems in a free energy calculation.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.calc_ti_decomposed.DecomposedCalculation.calculate" title="tools.calc_ti_decomposed.DecomposedCalculation.calculate"><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code></a>([subset])</td>
<td>For each estimator return the evaluated potential of mean force.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(args)</td>
<td>Public method for execution of calculation.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.calc_ti_decomposed.DecomposedCalculation.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>subset=(0.0</em>, <em>1.0</em>, <em>1.0)</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti_decomposed.DecomposedCalculation.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>For each estimator return the evaluated potential of mean force.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>subset: tuple of two floats and an int</strong></p>
<blockquote class="last">
<div><p>specify the subset of data to use in the calculation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.calc_ti_decomposed.TI_decomposed">
<em class="property">class </em><code class="descclassname">tools.calc_ti_decomposed.</code><code class="descname">TI_decomposed</code><span class="sig-paren">(</span><em>lambdas</em>, <em>results_name='results'</em>, <em>subdir_glob='./'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti_decomposed.TI_decomposed" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.Estimator" title="tools.free_energy_base.Estimator"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.Estimator</span></code></a></p>
<p>Estimate free differences using ThermodynamicIntegration. The class
performs individual calculations for each component of the system
interaction and internal energies. Results from each component
will sum to give the same result as the total energy. The
decomposition of the total free energy is not well-defined however
can be indicative of the dominant terms in a free energy change.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.calc_ti_decomposed.TI_decomposed.add_data" title="tools.calc_ti_decomposed.TI_decomposed.add_data"><code class="xref py py-obj docutils literal"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.calc_ti_decomposed.TI_decomposed.calculate" title="tools.calc_ti_decomposed.TI_decomposed.calculate"><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code></a>([subset])</td>
<td>Calculate the free energy difference for each energy component and return a dictionary of PMF objects.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">result_class</span></code></td>
<td>alias of <code class="xref py py-class docutils literal"><span class="pre">Result</span></code></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.calc_ti_decomposed.TI_decomposed.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti_decomposed.TI_decomposed.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object
for later calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>series: SnapshotResults.series</strong></p>
<blockquote class="last">
<div><p>free energy simulation data for a particular lambda value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.calc_ti_decomposed.TI_decomposed.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>subset=(0.0</em>, <em>1.0</em>, <em>1)</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti_decomposed.TI_decomposed.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference for each energy component and
return a dictionary of PMF objects.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.calc_ti_decomposed.get_arg_parser">
<code class="descclassname">tools.calc_ti_decomposed.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti_decomposed.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the custom argument parser for this script</p>
</dd></dl>

<dl class="function">
<dt id="tools.calc_ti_decomposed.plot_pmfs">
<code class="descclassname">tools.calc_ti_decomposed.</code><code class="descname">plot_pmfs</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti_decomposed.plot_pmfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to plot the pmfs of the individual
terms that make up the calculated free energy difference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data: dictionary of string-Result object pairs</strong></p>
<blockquote class="last">
<div><p>the free energy data to plot</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_ti_decomposed.plot_terms">
<code class="descclassname">tools.calc_ti_decomposed.</code><code class="descname">plot_terms</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti_decomposed.plot_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to plot a bar chart for individual
terms that make up the calculated free energy difference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data: dictionary of string-Result object pairs</strong></p>
<blockquote class="last">
<div><p>the free energy data to plot</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_ti_decomposed.run_script">
<code class="descclassname">tools.calc_ti_decomposed.</code><code class="descname">run_script</code><span class="sig-paren">(</span><em>cmdline</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti_decomposed.run_script" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the script, allows for straight-forward testing.</p>
</dd></dl>

</div>
<div class="section" id="module-tools.clear_gcmcbox">
<span id="tools-clear-gcmcbox-module"></span><h2>tools.clear_gcmcbox module<a class="headerlink" href="#module-tools.clear_gcmcbox" title="Permalink to this headline">¶</a></h2>
<p>Routine to remove solvent molecules from a GCMC/JAWS-1 simulation box</p>
<p>This module defines a single public function:
clear_gcmcbox</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.clear_gcmcbox.clear_gcmcbox">
<code class="descclassname">tools.clear_gcmcbox.</code><code class="descname">clear_gcmcbox</code><span class="sig-paren">(</span><em>gcmcbox</em>, <em>waters</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.clear_gcmcbox.clear_gcmcbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes solvent molecules from the GCMC/JAWS-1 box as they will not be 
able to move during the simulation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>gcmcbox</strong> : string or PDBFile object</p>
<blockquote>
<div><p>the gcmcbox</p>
</div></blockquote>
<p><strong>waters</strong> : string or PDBFile object</p>
<blockquote>
<div><p>the water molecule to check</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote>
<div><p>the number of removed water molecules</p>
</div></blockquote>
<p>PDBFile</p>
<blockquote class="last">
<div><p>the cleared solvation box</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.clear_gcmcbox.get_arg_parser">
<code class="descclassname">tools.clear_gcmcbox.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.clear_gcmcbox.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tools.convertatomnames">
<span id="tools-convertatomnames-module"></span><h2>tools.convertatomnames module<a class="headerlink" href="#module-tools.convertatomnames" title="Permalink to this headline">¶</a></h2>
<p>Routines to convert atom names in a PDB-file</p>
<p>This module defines two public functions:
read_convfile
pdb2pms</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.convertatomnames.get_arg_parser">
<code class="descclassname">tools.convertatomnames.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertatomnames.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.convertatomnames.pdb2pms">
<code class="descclassname">tools.convertatomnames.</code><code class="descname">pdb2pms</code><span class="sig-paren">(</span><em>pdb_in</em>, <em>forcefield</em>, <em>conversion_file</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertatomnames.pdb2pms" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atom names to ProtoMS standard</p>
<p>The protein object is not modified by this routine, but the Residue and Atom objects are.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdb_in</strong> : PDBFile</p>
<blockquote>
<div><p>the pdb file to modify inline</p>
</div></blockquote>
<p><strong>forcefield</strong> : string</p>
<blockquote>
<div><p>the style of the input PDB-file</p>
</div></blockquote>
<p><strong>conversion_file :</strong></p>
<blockquote>
<div><p>a file with conversion rules</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a PDBFile instance with ProtoMS names</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertatomnames.read_convfile">
<code class="descclassname">tools.convertatomnames.</code><code class="descname">read_convfile</code><span class="sig-paren">(</span><em>file=None</em>, <em>inmode=None</em>, <em>outmode=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertatomnames.read_convfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a conversion file into a dictionary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>file</strong> : string</p>
<blockquote>
<div><p>the filename of the conversion file</p>
</div></blockquote>
<p><strong>inmode</strong> : string</p>
<blockquote>
<div><p>the style of the input PDB-file</p>
</div></blockquote>
<p><strong>outmode</strong> : string</p>
<blockquote>
<div><p>the style of the output PDB-file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a dictionary of the conversion</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>if any of the parameters are none</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.convertwater">
<span id="tools-convertwater-module"></span><h2>tools.convertwater module<a class="headerlink" href="#module-tools.convertwater" title="Permalink to this headline">¶</a></h2>
<p>Routines to convert water molecules to water models from a PDB file.</p>
<p>This module defines a single public function
convertwater</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.convertwater.alignhydrogens">
<code class="descclassname">tools.convertwater.</code><code class="descname">alignhydrogens</code><span class="sig-paren">(</span><em>watcoords</em>, <em>template</em>, <em>tol=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.alignhydrogens" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a template water molecule such that it has the same orientation as a reference water molecule. Useful for converting between different water models in cases when one wishes to retain the same orientations of hydrogens. It assumes that both the template and the reference water have maching oxygen locations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>watcoords</strong> : numpy array</p>
<blockquote>
<div><p>the coordinates of the water molecule that will be aligned to. The first row must be the x,y,z coordinates of the oxygen atom. Hydrogens must be present in the proceeding two rows</p>
</div></blockquote>
<p><strong>template</strong> : numpy array</p>
<blockquote>
<div><p>the template water molecule whose hydrogens will be aligned to match that of watcoords. Does not have to be same water model (e.g. tip4p versus spc) as watcoords.</p>
</div></blockquote>
<p><strong>tol</strong> : float</p>
<blockquote>
<div><p>the tolerance level for the BFGS solver. At a tolerance level of 0.1, orientating 1000 water molecules takes about 10s. With a lower tolerance, alignment is more accurate, but can take up to 17s per 1000 waters.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotated set of water coordinates.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.convertwater">
<code class="descclassname">tools.convertwater.</code><code class="descname">convertwater</code><span class="sig-paren">(</span><em>pdb_in</em>, <em>watermodel</em>, <em>ignorH=False</em>, <em>watresname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.convertwater" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts water in a pdb object to ideal water geometries of an input model</p>
<p>The protein object is not modified by this routine, but the Residue and Atom objects are.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdb_in</strong> : PDBFile</p>
<blockquote>
<div><p>the PDB object containing the water molecules that will be converted</p>
</div></blockquote>
<p><strong>watermodel</strong> : string</p>
<blockquote>
<div><p>the name of the water model that will be used in the transformtation, e.g. tip4p, t3p.</p>
</div></blockquote>
<p><strong>ignorH</strong> : bool</p>
<blockquote>
<div><p>whether to ignore hydrogens in the input water.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile</p>
<blockquote class="last">
<div><p>a pdb file whose solvent elements have the geometry of the desired solvent model</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.get_arg_parser">
<code class="descclassname">tools.convertwater.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.convertwater.rotatesolute">
<code class="descclassname">tools.convertwater.</code><code class="descname">rotatesolute</code><span class="sig-paren">(</span><em>solutecoords</em>, <em>alpha</em>, <em>beta</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.rotatesolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a molecule about the centre of geometry (the mean of x,y,z of each atom in the molecule).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>solutecoords</strong> : numpy array</p>
<blockquote>
<div><p>the coordinates of the molecule.</p>
</div></blockquote>
<p><strong>alpha</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the x-axis.</p>
</div></blockquote>
<p><strong>beta</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the y-axis.</p>
</div></blockquote>
<p><strong>gamma</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the z-axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotated set of molecule coordinates.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.rotatewat">
<code class="descclassname">tools.convertwater.</code><code class="descname">rotatewat</code><span class="sig-paren">(</span><em>watcoords</em>, <em>alpha</em>, <em>beta</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.rotatewat" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a water molecule about the oxygen atom, which is assumed to be the first element in the coordinate array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>watcoords</strong> : numpy array</p>
<blockquote>
<div><p>the coordinates of the water molecule. The first row must be the x,y,z coordinates of the oxygen atom. Hydrogens must be present in the proceeding two rows</p>
</div></blockquote>
<p><strong>alpha</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the x-axis.</p>
</div></blockquote>
<p><strong>beta</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the y-axis.</p>
</div></blockquote>
<p><strong>gamma</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the z-axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotated set of water coordinates.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.rotmat_x">
<code class="descclassname">tools.convertwater.</code><code class="descname">rotmat_x</code><span class="sig-paren">(</span><em>alpha</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.rotmat_x" title="Permalink to this definition">¶</a></dt>
<dd><p>3D rotation matrix for rotations about x-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>alpha</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the x-axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotation matrix for the desired angle.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.rotmat_y">
<code class="descclassname">tools.convertwater.</code><code class="descname">rotmat_y</code><span class="sig-paren">(</span><em>beta</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.rotmat_y" title="Permalink to this definition">¶</a></dt>
<dd><p>3D rotation matrix for rotations about x-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>beta</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the y-axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotation matrix for the desired angle.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.rotmat_z">
<code class="descclassname">tools.convertwater.</code><code class="descname">rotmat_z</code><span class="sig-paren">(</span><em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.rotmat_z" title="Permalink to this definition">¶</a></dt>
<dd><p>3D rotation matrix for rotations about x-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>gamma</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the z-axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotation matrix for the desired angle.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.distribute_waters">
<span id="tools-distribute-waters-module"></span><h2>tools.distribute_waters module<a class="headerlink" href="#module-tools.distribute_waters" title="Permalink to this headline">¶</a></h2>
<p>Program to generate a set of n molecules contained within given box dimenstions
or to redistribute molecules given in a pdb object or file within the given box dimensions</p>
<p>This program takes the box dimensions as a list of strings convertible to floats,
in the following order :</p>
<blockquote>
<div>origin in x | origin in y | origin in z | length in x | length in y | length in z</div></blockquote>
<p>And either the number of molecules as a string convertible to integer,
or the pdb, which can be provided as a string with the name of the file, or an object.</p>
<p>It produces a pdb file with the randomly distributed molecules with their oxygen atoms
within the box limits.</p>
<p>Initially thought to generate JAWS or GCMC molecules</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.distribute_waters.create_res">
<code class="descclassname">tools.distribute_waters.</code><code class="descname">create_res</code><span class="sig-paren">(</span><em>atnames=['O00'], resname='sol', positions=[array([0., 0., 0.])], resind=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.distribute_waters.create_res" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a residue object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atnames</strong> : list of strings</p>
<blockquote>
<div><p>a list containing the names of all
the atoms in the residue</p>
</div></blockquote>
<p><strong>resname</strong> : string</p>
<blockquote>
<div><p>the name of the residue</p>
</div></blockquote>
<p><strong>positions</strong> : list of numpy arrays</p>
<blockquote>
<div><p>a list with the positions of all
the atoms in the residue</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Residue object</p>
<blockquote class="last">
<div><p>the residue built with the given atoms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.distribute_waters.distribute_particles">
<code class="descclassname">tools.distribute_waters.</code><code class="descname">distribute_particles</code><span class="sig-paren">(</span><em>box</em>, <em>particles</em>, <em>watermodel='t4p'</em>, <em>resname='WA1'</em>, <em>partnumb=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.distribute_waters.distribute_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly distribute molecules in a box</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>box</strong> : a list or dictionary</p>
<blockquote>
<div><p>the origin and length of the box
where the molecules will be placed</p>
</div></blockquote>
<p><strong>particles</strong> : string or PDB object</p>
<blockquote>
<div><p>the number of waters to include in the box
or the pdb object or filename with the molecules
to include in the box</p>
</div></blockquote>
<p><strong>watermodel</strong> : string, optional</p>
<blockquote>
<div><p>(only used when particles is a number)
for instance, “t4p”, “tip4p”, “t3p” “tip3p”,
the water model for the generated waters</p>
</div></blockquote>
<p><strong>partnumb</strong> : string,optional</p>
<blockquote>
<div><p>(only used when particles is a file)
the number of particles. If not specified it is set
to be as many as there are in the file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">pdb object</p>
<blockquote class="last">
<div><p>the pdb object with the molecules
distributed randomly in the box</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.distribute_waters.get_arg_parser">
<code class="descclassname">tools.distribute_waters.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.distribute_waters.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tools.divide_pdb">
<span id="tools-divide-pdb-module"></span><h2>tools.divide_pdb module<a class="headerlink" href="#module-tools.divide_pdb" title="Permalink to this headline">¶</a></h2>
<p>Program to split a multi pdb file into individual files</p>
<p>This program divides a multi pdb file in individual files.
The individual pdbs must be separated by a line starting with END.</p>
<p>Initially thought to divide the multi-snapshot pdb file produced as ProtoMS output
into individual snapshot pdb files.
Required for an easy visualization of GCMC and JAWS stage 1 results.</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.divide_pdb.divide_print">
<code class="descclassname">tools.divide_pdb.</code><code class="descname">divide_print</code><span class="sig-paren">(</span><em>common</em>, <em>prefix</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.divide_pdb.divide_print" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide a pdb file in individual pdbfiles.
Division is controled by lines starting with END</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>common</strong> : string</p>
<blockquote>
<div><p>the name of the initial pdb file</p>
</div></blockquote>
<p><strong>prefix</strong> : string</p>
<blockquote class="last">
<div><p>the prefix for output pdb files</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.divide_pdb.get_arg_parser">
<code class="descclassname">tools.divide_pdb.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.divide_pdb.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tools.free_energy_base">
<span id="tools-free-energy-base-module"></span><h2>tools.free_energy_base module<a class="headerlink" href="#module-tools.free_energy_base" title="Permalink to this headline">¶</a></h2>
<p>Collection of classes to form the basis of a replacement for the current
free energy calculation framework.</p>
<dl class="class">
<dt id="tools.free_energy_base.BAR">
<em class="property">class </em><code class="descclassname">tools.free_energy_base.</code><code class="descname">BAR</code><span class="sig-paren">(</span><em>lambdas</em>, <em>results_name='results'</em>, <em>subdir_glob='./'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.BAR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.Estimator" title="tools.free_energy_base.Estimator"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.Estimator</span></code></a></p>
<p>Estimate free energy differences using Bennett’s Acceptance Ratio.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.BAR.add_data" title="tools.free_energy_base.BAR.add_data"><code class="xref py py-obj docutils literal"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.free_energy_base.BAR.calculate" title="tools.free_energy_base.BAR.calculate"><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code></a>([temp])</td>
<td>Calculate the free energy difference and return a PMF object.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">result_class</span></code></td>
<td>alias of <a class="reference internal" href="#tools.free_energy_base.Result" title="tools.free_energy_base.Result"><code class="xref py py-class docutils literal"><span class="pre">Result</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.free_energy_base.BAR.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.BAR.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>series: SnapshotResults.series</strong></p>
<blockquote class="last">
<div><p>free energy simulation data for a particular lambda value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.free_energy_base.BAR.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp=300.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.BAR.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a PMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>temp: float, optional</strong></p>
<blockquote class="last">
<div><p>temperature of calculation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.free_energy_base.BaseResult">
<em class="property">class </em><code class="descclassname">tools.free_energy_base.</code><code class="descname">BaseResult</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.BaseResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A base class for Result objects.</p>
<dl class="method">
<dt id="tools.free_energy_base.BaseResult.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.BaseResult.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>*args</strong> : an arbitrary number of lists of PMF objects</p>
<blockquote class="last">
<div><p>Each list should contain the PMF objects corresponding to
multiple repeats within a calculation leg. The free energy
estimates from multiple lists will be summed together.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.free_energy_base.Estimator">
<em class="property">class </em><code class="descclassname">tools.free_energy_base.</code><code class="descname">Estimator</code><span class="sig-paren">(</span><em>lambdas</em>, <em>results_name='results'</em>, <em>subdir_glob='./'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Base class for free energy estimators.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.Estimator.add_data" title="tools.free_energy_base.Estimator.add_data"><code class="xref py py-obj docutils literal"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.free_energy_base.Estimator.calculate" title="tools.free_energy_base.Estimator.calculate"><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code></a>([temp])</td>
<td>Calculate the free energy difference and return a PMF object.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.Estimator.result_class" title="tools.free_energy_base.Estimator.result_class"><code class="xref py py-obj docutils literal"><span class="pre">result_class</span></code></a></td>
<td>alias of <a class="reference internal" href="#tools.free_energy_base.Result" title="tools.free_energy_base.Result"><code class="xref py py-class docutils literal"><span class="pre">Result</span></code></a></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.free_energy_base.Estimator.subset" title="tools.free_energy_base.Estimator.subset"><code class="xref py py-obj docutils literal"><span class="pre">subset</span></code></a>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.free_energy_base.Estimator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>lambdas</em>, <em>results_name='results'</em>, <em>subdir_glob='./'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Estimator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lambdas: list of numbers</strong></p>
<blockquote>
<div><p>lambda values used in a calculation</p>
</div></blockquote>
<p><strong>results_name</strong> : string</p>
<blockquote>
<div><p>Filename of the ProtoMS results file to use</p>
</div></blockquote>
<p><strong>subdir_glob</strong> : string</p>
<blockquote>
<div><p>The glob string to use when seaching for result subdirectories</p>
</div></blockquote>
<p><strong>**kwargs :</strong></p>
<blockquote class="last">
<div><p>Additional keyword arguments are ignored</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.free_energy_base.Estimator.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Estimator.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>series: SnapshotResults.series</strong></p>
<blockquote class="last">
<div><p>free energy simulation data for a particular lambda value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.free_energy_base.Estimator.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp=300.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Estimator.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a PMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>temp: float, optional</strong></p>
<blockquote class="last">
<div><p>temperature of calculation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tools.free_energy_base.Estimator.result_class">
<code class="descname">result_class</code><a class="headerlink" href="#tools.free_energy_base.Estimator.result_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#tools.free_energy_base.Result" title="tools.free_energy_base.Result"><code class="xref py py-class docutils literal"><span class="pre">Result</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="tools.free_energy_base.Estimator.subset">
<code class="descname">subset</code><span class="sig-paren">(</span><em>low_bound=0.0</em>, <em>high_bound=1.0</em>, <em>step=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Estimator.subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new class instance containing truncated data series.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>low_bound: float, default=0.</strong></p>
<blockquote>
<div><p>Starting position of truncated data series.</p>
</div></blockquote>
<p><strong>high_bound: float, default=1.</strong></p>
<blockquote>
<div><p>Finishing position of truncated data series.</p>
</div></blockquote>
<p><strong>step: int, default=1</strong></p>
<blockquote class="last">
<div><p>Subsampling frequency of data. 1=all data points,
2=every other data point, etc.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.free_energy_base.FreeEnergyCalculation">
<em class="property">class </em><code class="descclassname">tools.free_energy_base.</code><code class="descname">FreeEnergyCalculation</code><span class="sig-paren">(</span><em>root_paths, temperature, estimators=[&lt;class 'tools.free_energy_base.TI'&gt;, &lt;class 'tools.free_energy_base.BAR'&gt;, &lt;class 'tools.free_energy_base.MBAR'&gt;], subdir='', extract_data=True, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.FreeEnergyCalculation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class for performing a free energy calculation from one or more
ProtoMS simulation outputs.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.FreeEnergyCalculation.calculate" title="tools.free_energy_base.FreeEnergyCalculation.calculate"><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code></a>([subset])</td>
<td>For each estimator return the evaluated potential of mean force.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.free_energy_base.FreeEnergyCalculation.run" title="tools.free_energy_base.FreeEnergyCalculation.run"><code class="xref py py-obj docutils literal"><span class="pre">run</span></code></a>(args)</td>
<td>Public method for execution of calculation.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.free_energy_base.FreeEnergyCalculation.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>root_paths, temperature, estimators=[&lt;class 'tools.free_energy_base.TI'&gt;, &lt;class 'tools.free_energy_base.BAR'&gt;, &lt;class 'tools.free_energy_base.MBAR'&gt;], subdir='', extract_data=True, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.FreeEnergyCalculation.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>root_paths: a list of lists of strings</strong></p>
<blockquote>
<div><p>Paths to ProtoMS output directories. Each list of strings specifies
the output directory(s) that make up multiple repeats of a single</p>
<blockquote>
<div><p>‘leg’ of the calculation. The result for each leg is a mean over</p>
</div></blockquote>
<p>constituent repeats. Results from each leg are then summed together
to give a total free energy difference for the calculation.</p>
</div></blockquote>
<p><strong>temperature: float</strong></p>
<blockquote>
<div><p>Simulation temperature in degrees Kelvin.</p>
</div></blockquote>
<p><strong>estimators: list of Estimator classes</strong></p>
<blockquote>
<div><p>Estimator classes to use in evaluating free energies.</p>
</div></blockquote>
<p><strong>subdir: string</strong></p>
<blockquote>
<div><p>subdirectory within each lambda folder to search for output</p>
</div></blockquote>
<p><strong>extract_data: bool</strong></p>
<blockquote>
<div><p>If True extract data from simulation results in prepartion for
calculation.</p>
</div></blockquote>
<p><strong>**kwargs:</strong></p>
<blockquote class="last">
<div><p>Additional keyword arguments are passed to Estimator classes
during initialisation.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.free_energy_base.FreeEnergyCalculation.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>subset=(0.0</em>, <em>1.0</em>, <em>1)</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.FreeEnergyCalculation.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>For each estimator return the evaluated potential of mean force.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>subset: tuple of two floats and an int</strong></p>
<blockquote class="last">
<div><p>specify the subset of data to use in the calculation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.free_energy_base.FreeEnergyCalculation.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.FreeEnergyCalculation.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Public method for execution of calculation. This is usually the
desired way to use execute calculations. Handles logic for
printing of output tables and saving of output pickles and
figures. Calls plt.show() to display figures.  Runs
self._body(args) and uses the return value as the calculation
result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.free_energy_base.MBAR">
<em class="property">class </em><code class="descclassname">tools.free_energy_base.</code><code class="descname">MBAR</code><span class="sig-paren">(</span><em>lambdas</em>, <em>results_name='results'</em>, <em>subdir_glob='./'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.MBAR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.TI" title="tools.free_energy_base.TI"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.TI</span></code></a></p>
<p>Estimate free energy differences using the Multistate Bennett’s
Acceptante Ratio.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.MBAR.add_data" title="tools.free_energy_base.MBAR.add_data"><code class="xref py py-obj docutils literal"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.free_energy_base.MBAR.calculate" title="tools.free_energy_base.MBAR.calculate"><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code></a>([temp])</td>
<td>Calculate the free energy difference and return a PMF object.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">result_class</span></code></td>
<td>alias of <a class="reference internal" href="#tools.free_energy_base.Result" title="tools.free_energy_base.Result"><code class="xref py py-class docutils literal"><span class="pre">Result</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.free_energy_base.MBAR.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.MBAR.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>series: SnapshotResults.series</strong></p>
<blockquote class="last">
<div><p>free energy simulation data for a particular lambda value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.free_energy_base.MBAR.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp=300.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.MBAR.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a PMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>temp: float, optional</strong></p>
<blockquote class="last">
<div><p>temperature of calculation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.free_energy_base.PMF">
<em class="property">class </em><code class="descclassname">tools.free_energy_base.</code><code class="descname">PMF</code><span class="sig-paren">(</span><em>coordinate</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.PMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.Series" title="tools.free_energy_base.Series"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.Series</span></code></a></p>
<p>A Potential of Mean Force, describing a free energy profile
as a function of some coordinate.</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.PMF.dG" title="tools.free_energy_base.PMF.dG"><code class="xref py py-obj docutils literal"><span class="pre">dG</span></code></a></td>
<td>The free energy difference at the PMF end points</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code>(axes[,&nbsp;show_error,&nbsp;fmt,&nbsp;xlabel,&nbsp;ylabel])</td>
<td>Plot this PMF onto the provided figure axes.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tools.free_energy_base.PMF.dG">
<code class="descname">dG</code><a class="headerlink" href="#tools.free_energy_base.PMF.dG" title="Permalink to this definition">¶</a></dt>
<dd><p>The free energy difference at the PMF end points</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.free_energy_base.Quantity">
<em class="property">class </em><code class="descclassname">tools.free_energy_base.</code><code class="descname">Quantity</code><span class="sig-paren">(</span><em>value</em>, <em>error</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Quantity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Stores both the value and error associated with a
free energy estimate.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.Quantity.fromData" title="tools.free_energy_base.Quantity.fromData"><code class="xref py py-obj docutils literal"><span class="pre">fromData</span></code></a>(data)</td>
<td>Alternative initialiser that uses of a set of data points rather than providing an explicit value and error.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.free_energy_base.Quantity.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value</em>, <em>error</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Quantity.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>value: float</strong></p>
<blockquote>
<div><p>the magnitude of the free energy difference</p>
</div></blockquote>
<p><strong>error: float</strong></p>
<blockquote class="last">
<div><p>one standard error associated with value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="tools.free_energy_base.Quantity.fromData">
<em class="property">static </em><code class="descname">fromData</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Quantity.fromData" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative initialiser that uses of a set of data
points rather than providing an explicit value and error.
Returns a Quantity object with a value and error determined
from the mean of and standard error of the provided data. If
Quantity objects are provided as data their individual
error attributes are ignored</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data: sequence of numbers or Quantity objects</strong></p>
<blockquote class="last">
<div><p>data from which to determine value and error</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.free_energy_base.Result">
<em class="property">class </em><code class="descclassname">tools.free_energy_base.</code><code class="descname">Result</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Result" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.BaseResult" title="tools.free_energy_base.BaseResult"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.BaseResult</span></code></a></p>
<p>The result of a free energy calculation. Contains multiple PMF
objects that are combined together to give a meaningful free energy
difference.</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.Result.dG" title="tools.free_energy_base.Result.dG"><code class="xref py py-obj docutils literal"><span class="pre">dG</span></code></a></td>
<td>The free energy difference at the PMF end points</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.free_energy_base.Result.lambdas" title="tools.free_energy_base.Result.lambdas"><code class="xref py py-obj docutils literal"><span class="pre">lambdas</span></code></a></td>
<td>Lambda values at which the calculation has been performed</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.Result.pmf" title="tools.free_energy_base.Result.pmf"><code class="xref py py-obj docutils literal"><span class="pre">pmf</span></code></a></td>
<td>The potential of mean force for this result</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tools.free_energy_base.Result.dG">
<code class="descname">dG</code><a class="headerlink" href="#tools.free_energy_base.Result.dG" title="Permalink to this definition">¶</a></dt>
<dd><p>The free energy difference at the PMF end points</p>
</dd></dl>

<dl class="attribute">
<dt id="tools.free_energy_base.Result.lambdas">
<code class="descname">lambdas</code><a class="headerlink" href="#tools.free_energy_base.Result.lambdas" title="Permalink to this definition">¶</a></dt>
<dd><p>Lambda values at which the calculation has been performed</p>
</dd></dl>

<dl class="attribute">
<dt id="tools.free_energy_base.Result.pmf">
<code class="descname">pmf</code><a class="headerlink" href="#tools.free_energy_base.Result.pmf" title="Permalink to this definition">¶</a></dt>
<dd><p>The potential of mean force for this result</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.free_energy_base.Series">
<em class="property">class </em><code class="descclassname">tools.free_energy_base.</code><code class="descname">Series</code><span class="sig-paren">(</span><em>coordinate</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Series" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Object for storing data series, i.e. some value that changes
as a function of some coordinate. Designed to act as a base class
for PMF classes.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.Series.plot" title="tools.free_energy_base.Series.plot"><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code></a>(axes[,&nbsp;show_error,&nbsp;fmt,&nbsp;xlabel,&nbsp;ylabel])</td>
<td>Plot this PMF onto the provided figure axes.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.free_energy_base.Series.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>coordinate</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Series.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>coordinate</strong> : sequence of numbers</p>
<blockquote>
<div><p>The values of the coordinate for the PMF</p>
</div></blockquote>
<p><strong>*args</strong> : An arbitrary number of iterables containing numbers</p>
<blockquote class="last">
<div><blockquote>
<div><p>or Quantity objects</p>
</div></blockquote>
<p>All arguments after coordinate are iterated simultaneously,
the first entry of each is used to construct the first Quantity
object in self.values and so on.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.free_energy_base.Series.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>axes</em>, <em>show_error=True</em>, <em>fmt='-'</em>, <em>xlabel='Lambda Value'</em>, <em>ylabel='Free Energy (kcal)'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.Series.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot this PMF onto the provided figure axes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>axes</strong> : matplotlib Axes object</p>
<blockquote>
<div><p>axes onto which the figure will be drawn</p>
</div></blockquote>
<p><strong>show_error</strong> : boolean</p>
<blockquote>
<div><p>if True, plot error bars</p>
</div></blockquote>
<p><strong>xlabel</strong> : string</p>
<blockquote>
<div><p>label for x-axis</p>
</div></blockquote>
<p><strong>ylabel</strong> : string</p>
<blockquote>
<div><p>label for y-axis</p>
</div></blockquote>
<p><strong>**kwargs :</strong></p>
<blockquote class="last">
<div><p>additional keyword arguments to be passed to axes.plot</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.free_energy_base.TI">
<em class="property">class </em><code class="descclassname">tools.free_energy_base.</code><code class="descname">TI</code><span class="sig-paren">(</span><em>lambdas</em>, <em>results_name='results'</em>, <em>subdir_glob='./'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.TI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.Estimator" title="tools.free_energy_base.Estimator"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.Estimator</span></code></a></p>
<p>Estimate free energy differences using Thermodynamic Integration.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.free_energy_base.TI.add_data" title="tools.free_energy_base.TI.add_data"><code class="xref py py-obj docutils literal"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.free_energy_base.TI.calculate" title="tools.free_energy_base.TI.calculate"><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code></a>([temp])</td>
<td>Calculate the free energy difference and return a PMF object.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">result_class</span></code></td>
<td>alias of <a class="reference internal" href="#tools.free_energy_base.Result" title="tools.free_energy_base.Result"><code class="xref py py-class docutils literal"><span class="pre">Result</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.free_energy_base.TI.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.TI.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>series: SnapshotResults.series</strong></p>
<blockquote class="last">
<div><p>free energy simulation data for a particular lambda value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.free_energy_base.TI.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp=300.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.TI.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a PMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>temp: float, optional</strong></p>
<blockquote class="last">
<div><p>temperature of calculation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.free_energy_base.get_alchemical_arg_parser">
<code class="descclassname">tools.free_energy_base.</code><code class="descname">get_alchemical_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.get_alchemical_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an argument parser suitable for use with alchemical
simulation methods e.g. free energy perturbation.</p>
</dd></dl>

<dl class="function">
<dt id="tools.free_energy_base.get_base_arg_parser">
<code class="descclassname">tools.free_energy_base.</code><code class="descname">get_base_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.free_energy_base.get_base_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a generic argparser for all free energy calculation scripts</p>
</dd></dl>

</div>
<div class="section" id="tools-gcmc-free-energy-base-module">
<h2>tools.gcmc_free_energy_base module<a class="headerlink" href="#tools-gcmc-free-energy-base-module" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-tools.gcmc_free_energy_base"></span><dl class="class">
<dt id="tools.gcmc_free_energy_base.GCI">
<em class="property">class </em><code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">GCI</code><span class="sig-paren">(</span><em>B_values</em>, <em>volume</em>, <em>results_name='results'</em>, <em>steps=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.Estimator" title="tools.free_energy_base.Estimator"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.Estimator</span></code></a></p>
<p>Estimate insertion free energies using Grand Canonical Integration.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCI.add_data" title="tools.gcmc_free_energy_base.GCI.add_data"><code class="xref py py-obj docutils literal"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCI.calculate" title="tools.gcmc_free_energy_base.GCI.calculate"><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code></a>(temp)</td>
<td>Calculate the free energy difference and return a GCMCPMF object.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">result_class</span></code></td>
<td>alias of <code class="xref py py-class docutils literal"><span class="pre">Result</span></code></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCI.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>B_values</em>, <em>volume</em>, <em>results_name='results'</em>, <em>steps=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCI.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>B_values: list of floats</strong></p>
<blockquote>
<div><p>The B values used in a calculation</p>
</div></blockquote>
<p><strong>volume:</strong></p>
<blockquote>
<div><p>The volume of the GCMC region used in a calculation</p>
</div></blockquote>
<p><strong>results_name: string, optional</strong></p>
<blockquote>
<div><p>Filename of the ProtoMS results file to use</p>
</div></blockquote>
<p><strong>steps: int, optional</strong></p>
<blockquote>
<div><p>The number of steps to fit in the titration curve.
By default the number of steps is automatically selected.</p>
</div></blockquote>
<p><strong>**kwargs:</strong></p>
<blockquote class="last">
<div><p>Additional keyword arguments are ignored</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCI.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCI.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>series: SnapshotResults.series</strong></p>
<blockquote class="last">
<div><p>free energy simulation data for a particular B value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCI.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCI.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a GCMCPMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>temp: float</strong></p>
<blockquote class="last">
<div><p>Temperature of calculation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.gcmc_free_energy_base.GCMCMBAR">
<em class="property">class </em><code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">GCMCMBAR</code><span class="sig-paren">(</span><em>lambdas</em>, <em>volume</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCMBAR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.MBAR" title="tools.free_energy_base.MBAR"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.MBAR</span></code></a></p>
<p>Estimate free energy differences using the Multistate Bennett Acceptance
ratio for alchemical simulations performed in the Grand Canonical ensemble
at multiple B values.</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCMBAR.Bs" title="tools.gcmc_free_energy_base.GCMCMBAR.Bs"><code class="xref py py-obj docutils literal"><span class="pre">Bs</span></code></a></td>
<td>Return the B value used for this calculation.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCMBAR.B_to_chemical_potential" title="tools.gcmc_free_energy_base.GCMCMBAR.B_to_chemical_potential"><code class="xref py py-obj docutils literal"><span class="pre">B_to_chemical_potential</span></code></a>(B,&nbsp;temperature)</td>
<td>Convert a B value to the equivalent chemical potential for this simulation setup.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCMBAR.add_data" title="tools.gcmc_free_energy_base.GCMCMBAR.add_data"><code class="xref py py-obj docutils literal"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCMBAR.calculate" title="tools.gcmc_free_energy_base.GCMCMBAR.calculate"><code class="xref py py-obj docutils literal"><span class="pre">calculate</span></code></a>([temp])</td>
<td>Calculate the free energy difference and return a PMF2D object.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCMBAR.result_class" title="tools.gcmc_free_energy_base.GCMCMBAR.result_class"><code class="xref py py-obj docutils literal"><span class="pre">result_class</span></code></a></td>
<td>alias of <a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCResult2D" title="tools.gcmc_free_energy_base.GCMCResult2D"><code class="xref py py-class docutils literal"><span class="pre">GCMCResult2D</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCMCMBAR.B_to_chemical_potential">
<code class="descname">B_to_chemical_potential</code><span class="sig-paren">(</span><em>B</em>, <em>temperature</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCMBAR.B_to_chemical_potential" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a B value to the equivalent chemical potential for this
simulation setup. Depends on GCMC volume of the simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>B: float</strong></p>
<blockquote>
<div><p>the input B value</p>
</div></blockquote>
<p><strong>temperature: float</strong></p>
<blockquote class="last">
<div><p>the simulated temperature</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tools.gcmc_free_energy_base.GCMCMBAR.Bs">
<code class="descname">Bs</code><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCMBAR.Bs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the B value used for this calculation.</p>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCMCMBAR.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>lambdas</em>, <em>volume</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCMBAR.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lambdas: list of floats</strong></p>
<blockquote>
<div><p>lambda values used in a calculation</p>
</div></blockquote>
<p><strong>volume: float</strong></p>
<blockquote class="last">
<div><p>the volume of the gcmc region in a calculation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCMCMBAR.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCMBAR.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>series: SnapshotResults.series</strong></p>
<blockquote class="last">
<div><p>free energy simulation data for a particular simulation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCMCMBAR.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp=300.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCMBAR.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a PMF2D object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>temp: float, optional</strong></p>
<blockquote class="last">
<div><p>temperature of calculation, default 300 K</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tools.gcmc_free_energy_base.GCMCMBAR.result_class">
<code class="descname">result_class</code><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCMBAR.result_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCResult2D" title="tools.gcmc_free_energy_base.GCMCResult2D"><code class="xref py py-class docutils literal"><span class="pre">GCMCResult2D</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.gcmc_free_energy_base.GCMCPMF">
<em class="property">class </em><code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">GCMCPMF</code><span class="sig-paren">(</span><em>coordinate</em>, <em>values</em>, <em>volume</em>, <em>temperature</em>, <em>model</em>, <em>pmf</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCPMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.Series" title="tools.free_energy_base.Series"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.Series</span></code></a></p>
<p>A potential of mean force object for Grand Canonical calculations.
Stores occupancy data and PMF for insertion free energies.</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCPMF.equilibrium_B" title="tools.gcmc_free_energy_base.GCMCPMF.equilibrium_B"><code class="xref py py-obj docutils literal"><span class="pre">equilibrium_B</span></code></a></td>
<td>Returns the value of B equating to equilibrium with bulk water.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code>(axes[,&nbsp;show_error,&nbsp;fmt,&nbsp;xlabel,&nbsp;ylabel])</td>
<td>Plot this PMF onto the provided figure axes.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCMCPMF.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>coordinate</em>, <em>values</em>, <em>volume</em>, <em>temperature</em>, <em>model</em>, <em>pmf</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCPMF.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>coordinate</strong> : sequence of numbers</p>
<blockquote>
<div><p>The values of the controlled coordinate for the PMF</p>
</div></blockquote>
<p><strong>values</strong> : sequence of numbers</p>
<blockquote>
<div><p>The values of the variable coordinate for the PMF</p>
</div></blockquote>
<p><strong>volume</strong> : number</p>
<blockquote>
<div><p>The volume of the GCMC region used in a calculation</p>
</div></blockquote>
<p><strong>temperature</strong> : float</p>
<blockquote>
<div><p>The temperature used in a calculation</p>
</div></blockquote>
<p><strong>model</strong> : Slp object</p>
<blockquote>
<div><p>A Slp object fitted to the simulation occupancy data</p>
</div></blockquote>
<p><strong>pmf</strong> : PMF object</p>
<blockquote class="last">
<div><p>A PMF containing insertion free energies</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tools.gcmc_free_energy_base.GCMCPMF.equilibrium_B">
<code class="descname">equilibrium_B</code><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCPMF.equilibrium_B" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of B equating to equilibrium with bulk water.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.gcmc_free_energy_base.GCMCPMF2D">
<em class="property">class </em><code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">GCMCPMF2D</code><span class="sig-paren">(</span><em>lambdas</em>, <em>Bs</em>, <em>volume</em>, <em>temperature</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCPMF2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCPMF" title="tools.gcmc_free_energy_base.GCMCPMF"><code class="xref py py-class docutils literal"><span class="pre">tools.gcmc_free_energy_base.GCMCPMF</span></code></a></p>
<p>A potential of mean force object alchemical simulations performed
in the Grand Canonical ensemble at multiple B values.</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCPMF2D.dG" title="tools.gcmc_free_energy_base.GCMCPMF2D.dG"><code class="xref py py-obj docutils literal"><span class="pre">dG</span></code></a></td>
<td>The free energy difference at the PMF end points for the equilibrium B value.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">equilibrium_B</span></code></td>
<td>Returns the value of B equating to equilibrium with bulk water.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCPMF2D.plot" title="tools.gcmc_free_energy_base.GCMCPMF2D.plot"><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code></a>(axes[,&nbsp;show_error])</td>
<td>Plot this PMF onto the provided figure axes.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCMCPMF2D.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>lambdas</em>, <em>Bs</em>, <em>volume</em>, <em>temperature</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCPMF2D.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lambdas</strong> : list of floats</p>
<blockquote>
<div><p>The lambda values used in a calculation</p>
</div></blockquote>
<p><strong>Bs</strong> : list of floats</p>
<blockquote>
<div><p>The B values used in a calculation</p>
</div></blockquote>
<p><strong>volume: float</strong></p>
<blockquote>
<div><p>the volume of the gcmc region in a calculation</p>
</div></blockquote>
<p><strong>temperature</strong> : float</p>
<blockquote>
<div><p>The temperature used in a calculation</p>
</div></blockquote>
<p><strong>*args</strong> : An arbitrary number of iterables containing numbers</p>
<blockquote class="last">
<div><blockquote>
<div><p>or Quantity objects</p>
</div></blockquote>
<p>All arguments after coordinate are iterated simultaneously,
the first entry of each is used to construct the first Quantity
object in self.values and so on.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tools.gcmc_free_energy_base.GCMCPMF2D.dG">
<code class="descname">dG</code><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCPMF2D.dG" title="Permalink to this definition">¶</a></dt>
<dd><p>The free energy difference at the PMF end points for the
equilibrium B value.</p>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCMCPMF2D.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>axes</em>, <em>show_error=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCPMF2D.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot this PMF onto the provided figure axes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>axes</strong> : matplotlib Axes3D object</p>
<blockquote>
<div><p>axes onto which the figure will be drawn</p>
</div></blockquote>
<p><strong>show_error</strong> : boolean</p>
<blockquote>
<div><p>if True, plot error bars</p>
</div></blockquote>
<p><strong>**kwargs :</strong></p>
<blockquote class="last">
<div><p>additional keyword arguments to be passed to axes.plot</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.gcmc_free_energy_base.GCMCResult">
<em class="property">class </em><code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">GCMCResult</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.BaseResult" title="tools.free_energy_base.BaseResult"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.BaseResult</span></code></a></p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCResult.B_values" title="tools.gcmc_free_energy_base.GCMCResult.B_values"><code class="xref py py-obj docutils literal"><span class="pre">B_values</span></code></a></td>
<td>Return the simulated B values</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCResult.equilibrium_B" title="tools.gcmc_free_energy_base.GCMCResult.equilibrium_B"><code class="xref py py-obj docutils literal"><span class="pre">equilibrium_B</span></code></a></td>
<td>Return the B value representing equilibrium with bulk water</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCResult.insertion_pmf" title="tools.gcmc_free_energy_base.GCMCResult.insertion_pmf"><code class="xref py py-obj docutils literal"><span class="pre">insertion_pmf</span></code></a></td>
<td>Return a PMF object containing insertion free energies</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCResult.model" title="tools.gcmc_free_energy_base.GCMCResult.model"><code class="xref py py-obj docutils literal"><span class="pre">model</span></code></a></td>
<td>Return a Series object containing an average fitted model</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCResult.occupancies" title="tools.gcmc_free_energy_base.GCMCResult.occupancies"><code class="xref py py-obj docutils literal"><span class="pre">occupancies</span></code></a></td>
<td>Return a Series object containing occupancy data</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tools.gcmc_free_energy_base.GCMCResult.B_values">
<code class="descname">B_values</code><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCResult.B_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the simulated B values</p>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.GCMCResult.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCResult.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tools.gcmc_free_energy_base.GCMCResult.equilibrium_B">
<code class="descname">equilibrium_B</code><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCResult.equilibrium_B" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the B value representing equilibrium with bulk water</p>
</dd></dl>

<dl class="attribute">
<dt id="tools.gcmc_free_energy_base.GCMCResult.insertion_pmf">
<code class="descname">insertion_pmf</code><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCResult.insertion_pmf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a PMF object containing insertion free energies</p>
</dd></dl>

<dl class="attribute">
<dt id="tools.gcmc_free_energy_base.GCMCResult.model">
<code class="descname">model</code><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCResult.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Series object containing an average fitted model</p>
</dd></dl>

<dl class="attribute">
<dt id="tools.gcmc_free_energy_base.GCMCResult.occupancies">
<code class="descname">occupancies</code><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCResult.occupancies" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Series object containing occupancy data</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.gcmc_free_energy_base.GCMCResult2D">
<em class="property">class </em><code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">GCMCResult2D</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCResult2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.free_energy_base.Result" title="tools.free_energy_base.Result"><code class="xref py py-class docutils literal"><span class="pre">tools.free_energy_base.Result</span></code></a></p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">dG</span></code></td>
<td>The free energy difference at the PMF end points</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">lambdas</span></code></td>
<td>Lambda values at which the calculation has been performed</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.GCMCResult2D.pmf" title="tools.gcmc_free_energy_base.GCMCResult2D.pmf"><code class="xref py py-obj docutils literal"><span class="pre">pmf</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tools.gcmc_free_energy_base.GCMCResult2D.pmf">
<code class="descname">pmf</code><a class="headerlink" href="#tools.gcmc_free_energy_base.GCMCResult2D.pmf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.gcmc_free_energy_base.Slp">
<em class="property">class </em><code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">Slp</code><span class="sig-paren">(</span><em>x=array(0)</em>, <em>y=array(0)</em>, <em>size=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class for fitting and storing a monotonically increasing single layer
perceptron with one input and one output.</p>
<p>Fitting is achieved by iteratively optimising one unit at a time,
rather than the more typical back-propigation algorithm, to make use of
SciPy’s monotonic optimisation routines.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>size</strong></td>
<td>(integer) the number logsistic terms, equilivalent to the number of ‘hidden units’ in an artificial neural network</td>
</tr>
<tr class="row-even"><td><strong>x</strong></td>
<td>(numpy array) the explanatory variable, which is the Adams value or chemical potential in GCMC</td>
</tr>
<tr class="row-odd"><td><strong>y</strong></td>
<td>(numpy array) the response variable, which is the average number of inserted grand canonical molecules</td>
</tr>
<tr class="row-even"><td><strong>weights</strong></td>
<td>(numpy array) the matrix of coefficients of the logistic terms</td>
</tr>
<tr class="row-odd"><td><strong>offset</strong></td>
<td>(numpy array) the intercept of the artificial neural network. Grouped together with the weights when fitting</td>
</tr>
<tr class="row-even"><td><strong>streams</strong></td>
<td>(list) contains the output of each logistic function or ‘unit’</td>
</tr>
<tr class="row-odd"><td><strong>predicted</strong></td>
<td>(numpy array) the predicted output of the artificial neural network</td>
</tr>
<tr class="row-even"><td><strong>error: float</strong></td>
<td>the error (either mean-squared, Huber, or absolute loss) of the artificial neural network with respect to the response variable.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.absolute" title="tools.gcmc_free_energy_base.Slp.absolute"><code class="xref py py-obj docutils literal"><span class="pre">absolute</span></code></a>()</td>
<td>Calculates the absolute loss of the model and updates the error</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.epoch" title="tools.gcmc_free_energy_base.Slp.epoch"><code class="xref py py-obj docutils literal"><span class="pre">epoch</span></code></a>([grad_tol,&nbsp;pin_min,&nbsp;pin_max,&nbsp;…])</td>
<td>Fits each unit and intercept of the artificial neural network once</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.fit_offset" title="tools.gcmc_free_energy_base.Slp.fit_offset"><code class="xref py py-obj docutils literal"><span class="pre">fit_offset</span></code></a>([grad_tol,&nbsp;cost,&nbsp;c])</td>
<td>Fits the intercept of the artificial neural network</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.fit_unit" title="tools.gcmc_free_energy_base.Slp.fit_unit"><code class="xref py py-obj docutils literal"><span class="pre">fit_unit</span></code></a>(unit[,&nbsp;grad_tol,&nbsp;pin_max,&nbsp;…])</td>
<td>Fits an individual unit of the artificial neural network</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.forward" title="tools.gcmc_free_energy_base.Slp.forward"><code class="xref py py-obj docutils literal"><span class="pre">forward</span></code></a>()</td>
<td>Evaluates the output from ALL units for a given set of weights</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.forward_unit" title="tools.gcmc_free_energy_base.Slp.forward_unit"><code class="xref py py-obj docutils literal"><span class="pre">forward_unit</span></code></a>(unit)</td>
<td>Evaluates the output from ONE unit for a given set of weights</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.huber" title="tools.gcmc_free_energy_base.Slp.huber"><code class="xref py py-obj docutils literal"><span class="pre">huber</span></code></a>([c])</td>
<td>Calculates the pseudo Huber loss function and</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.msd" title="tools.gcmc_free_energy_base.Slp.msd"><code class="xref py py-obj docutils literal"><span class="pre">msd</span></code></a>()</td>
<td>Calculates the mean-squared error of the model and updates the error</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.predict" title="tools.gcmc_free_energy_base.Slp.predict"><code class="xref py py-obj docutils literal"><span class="pre">predict</span></code></a>(x)</td>
<td>Returns the prediction for the artificial neural network</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.randomise" title="tools.gcmc_free_energy_base.Slp.randomise"><code class="xref py py-obj docutils literal"><span class="pre">randomise</span></code></a>([pin_max])</td>
<td>Produces initial values of weights by random sampling</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.randsearch" title="tools.gcmc_free_energy_base.Slp.randsearch"><code class="xref py py-obj docutils literal"><span class="pre">randsearch</span></code></a>(samples)</td>
<td>Performs a crude initial random search of the space of weights,</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.gcmc_free_energy_base.Slp.train" title="tools.gcmc_free_energy_base.Slp.train"><code class="xref py py-obj docutils literal"><span class="pre">train</span></code></a>([iterations,&nbsp;grad_tol_low,&nbsp;…])</td>
<td>Iterates over a specified amount of training epochs.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>x=array(0)</em>, <em>y=array(0)</em>, <em>size=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.absolute">
<code class="descname">absolute</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.absolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the absolute loss of the model and updates the error</p>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.epoch">
<code class="descname">epoch</code><span class="sig-paren">(</span><em>grad_tol=0.001</em>, <em>pin_min=None</em>, <em>pin_max=None</em>, <em>monotonic=True</em>, <em>cost='msd'</em>, <em>c=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits each unit and intercept of the artificial neural network once</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>grad_tol</strong> : float</p>
<blockquote>
<div><p>the tolorance of the gradient that determines when optimisation stops</p>
</div></blockquote>
<p><strong>pin_min</strong> : float</p>
<blockquote>
<div><p>the value of the fixed intercept. If None, it will be fitted.</p>
</div></blockquote>
<p><strong>pin_max</strong> : float</p>
<blockquote>
<div><p>the value of the maximum value to model can produce.
If None, it will be fitted</p>
</div></blockquote>
<p><strong>monotonic</strong> : boolean</p>
<blockquote>
<div><p>whether to insure the artificial neural
network is monotonically increasing</p>
</div></blockquote>
<p><strong>cost</strong> : string</p>
<blockquote>
<div><p>the type of cost/loss function that will be used
can be ‘msd’, ‘abs’ or ‘huber’</p>
</div></blockquote>
<p><strong>c</strong> : float</p>
<blockquote class="last">
<div><p>the paramater of the huber loss function</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.fit_offset">
<code class="descname">fit_offset</code><span class="sig-paren">(</span><em>grad_tol=0.001</em>, <em>cost='msd'</em>, <em>c=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.fit_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the intercept of the artificial neural network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>grad_tol</strong> : float</p>
<blockquote>
<div><p>the tolorance of the gradient that determines when optimisation stops</p>
</div></blockquote>
<p><strong>cost</strong> : string</p>
<blockquote>
<div><dl class="docutils">
<dt>the type of cost/loss function that will be used</dt>
<dd><p class="first last">can be ‘msd’, ‘abs’ or ‘huber’</p>
</dd>
</dl>
</div></blockquote>
<p><strong>c</strong> : float</p>
<blockquote class="last">
<div><p>the paramater of the Huber loss function</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.fit_unit">
<code class="descname">fit_unit</code><span class="sig-paren">(</span><em>unit</em>, <em>grad_tol=0.001</em>, <em>pin_max=None</em>, <em>monotonic=True</em>, <em>cost='msd'</em>, <em>c=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.fit_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits an individual unit of the artificial neural network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>unit</strong> : int</p>
<blockquote>
<div><p>the index of the logistic function whose weights
(parameters) will be optimised</p>
</div></blockquote>
<p><strong>grad_tol</strong> : float</p>
<blockquote>
<div><p>the tolorance of the gradient that determines when optimisation stops</p>
</div></blockquote>
<p><strong>pin_max</strong> : float</p>
<blockquote>
<div><p>the value of the maximum value to model can produce.
If None, it will be fitted</p>
</div></blockquote>
<p><strong>monotonic</strong> : boolean</p>
<blockquote>
<div><p>whether to insure the artificial neural network is
monotonically increasing</p>
</div></blockquote>
<p><strong>cost</strong> : string</p>
<blockquote>
<div><p>the type of cost/loss function that will be used
can be ‘msd’, ‘abs’ or ‘huber’</p>
</div></blockquote>
<p><strong>c</strong> : float</p>
<blockquote class="last">
<div><p>the paramater of the Huber loss function</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the output from ALL units for a given set of weights
and updates the prediction of the whole network</p>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.forward_unit">
<code class="descname">forward_unit</code><span class="sig-paren">(</span><em>unit</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.forward_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the output from ONE unit for a given set of weights
and updates the prediction of the whole network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>unit</strong> : the index of the logisitic function</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.huber">
<code class="descname">huber</code><span class="sig-paren">(</span><em>c=2</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.huber" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the pseudo Huber loss function and
updates the error of the model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>c</strong> : number</p>
<blockquote class="last">
<div><p>the pseudo Huber loss function parameter</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.msd">
<code class="descname">msd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.msd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean-squared error of the model and updates the error</p>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the prediction for the artificial neural network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> : the vector of Adams or chemical potentials</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.randomise">
<code class="descname">randomise</code><span class="sig-paren">(</span><em>pin_max=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.randomise" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces initial values of weights by random sampling</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pin_max</strong> : whether to constrain the random weights so that the sum</p>
<blockquote class="last">
<div><p>of the units cannot exceed the maximum value of the response variable</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.randsearch">
<code class="descname">randsearch</code><span class="sig-paren">(</span><em>samples</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.randsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a crude initial random search of the space of weights,
and saves the best set of weights</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>samples</strong> : how many initial guesses of the weights shall be attempted</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.gcmc_free_energy_base.Slp.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>iterations=100</em>, <em>grad_tol_low=-3</em>, <em>grad_tol_high=1</em>, <em>pin_min=None</em>, <em>pin_max=None</em>, <em>monotonic=True</em>, <em>cost='msd'</em>, <em>c=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.Slp.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterates over a specified amount of training epochs. After each epoch,
the fitting tolerance will decrease to gradually refine the fits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>iterations</strong> : int</p>
<blockquote>
<div><p>the maximum number of training epochs that will be tested.</p>
</div></blockquote>
<p><strong>grad_tol_low</strong> : int</p>
<blockquote>
<div><p>ten to the power of this value is the
initial tolerance of the gradient</p>
</div></blockquote>
<p><strong>grad_tol_high</strong> : int</p>
<blockquote>
<div><p>ten to the power of this value is the final tolerance of the gradient</p>
</div></blockquote>
<p><strong>pin_min</strong> : float</p>
<blockquote>
<div><p>the value of the fixed intercept. If left blank, it will be fitted.</p>
</div></blockquote>
<p><strong>pin_max</strong> : float</p>
<blockquote>
<div><p>the value of the maximum value to model can produce.
If None, it will be fitted</p>
</div></blockquote>
<p><strong>monotonic</strong> : boolean</p>
<blockquote>
<div><p>whether to insure the artificial neural network
is monotonically increasing</p>
</div></blockquote>
<p><strong>cost</strong> : string</p>
<blockquote>
<div><p>the type of cost/loss function that will be used
can be ‘msd’, ‘abs’ or ‘huber’</p>
</div></blockquote>
<p><strong>c</strong> : float</p>
<blockquote class="last">
<div><p>the paramater of the huber loss function</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.gcmc_free_energy_base.fit_ensemble">
<code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">fit_ensemble</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>size</em>, <em>repeats=20</em>, <em>randstarts=1000</em>, <em>iterations=100</em>, <em>grad_tol_low=-3</em>, <em>grad_tol_high=1</em>, <em>pin_min=False</em>, <em>pin_max=None</em>, <em>monotonic=True</em>, <em>cost='msd'</em>, <em>c=2.0</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.fit_ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a collection of ANN models to GCMC titration data. Each ANN
is fitted with different set of initial ANN weights.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : numpy array</p>
<blockquote>
<div><p>the B/Adams values or chemical potentials used in a titration</p>
</div></blockquote>
<p><strong>y</strong> : numpy array</p>
<blockquote>
<div><p>the average value of water at each chemical potential</p>
</div></blockquote>
<p><strong>repeats</strong> : int</p>
<blockquote>
<div><p>the number of repeats of the fitting. This gives the “ensemble” of models</p>
</div></blockquote>
<p><strong>others</strong></p>
<blockquote class="last">
<div><p>As specified in Slp.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.gcmc_free_energy_base.insertion_pmf">
<code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">insertion_pmf</code><span class="sig-paren">(</span><em>N</em>, <em>gcmc_model</em>, <em>volume</em>, <em>T=298.15</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.insertion_pmf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the free energy to insert water from ideal gas to
the GCMC volume.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>N</strong> : numpy array</p>
<blockquote>
<div><p>vector of bound water numbers between which relative
free energies will be calculated</p>
</div></blockquote>
<p><strong>gcmc_model</strong> : Slp object</p>
<blockquote>
<div><p>an ANN model (single layer perceptron) that will
be used to calculate the free energy</p>
</div></blockquote>
<p><strong>volume</strong> : float</p>
<blockquote>
<div><p>the volume of the GCMC region in Angstroms^3</p>
</div></blockquote>
<p><strong>T</strong> : float</p>
<blockquote class="last">
<div><p>the temperature of the simulation in Kelvin</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.gcmc_free_energy_base.integrated_logistic">
<code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">integrated_logistic</code><span class="sig-paren">(</span><em>params</em>, <em>Bi</em>, <em>Bf</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.integrated_logistic" title="Permalink to this definition">¶</a></dt>
<dd><p>The integral of the logistic function, for use in the function
“insertion_pmf”. The problem is that it is prone to numerical instabilities
when the exponents are large and positive. While one could fix the problem,
I’ve opted for numerical integration instead in “insertion_pmf”.
This function has been used to verify the numerical integration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>params</strong> : list or numpy array</p>
<blockquote>
<div><p>the parameters of the logistic function</p>
</div></blockquote>
<p><strong>Bi</strong> : float</p>
<blockquote>
<div><p>the lower value of the interval of integration</p>
</div></blockquote>
<p><strong>Bf</strong> : float</p>
<blockquote class="last">
<div><p>the higher value of the interval of integration</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.gcmc_free_energy_base.inverse_slp">
<code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">inverse_slp</code><span class="sig-paren">(</span><em>model</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.inverse_slp" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given ANN model, this function returns the value of x that
corresponds to the value of y. It’s basically the inverse function of an
ANN. Used to determine which B value produces a given average of waters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>model</strong> : Slp object</p>
<blockquote>
<div><p>the ANN (single layer perceptron) to return the inverse function of</p>
</div></blockquote>
<p><strong>y</strong> : float</p>
<blockquote class="last">
<div><p>the value which you want to find the corresponding value of x</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.gcmc_free_energy_base.logistic">
<code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">logistic</code><span class="sig-paren">(</span><em>params</em>, <em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.logistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Logistic function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>params</strong> : list or numpy array</p>
<blockquote>
<div><p>the three parameters of the logistic function</p>
</div></blockquote>
<p><strong>x</strong> : numpy array</p>
<blockquote class="last">
<div><p>the explanatory variable</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.gcmc_free_energy_base.plot_surface">
<code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">plot_surface</code><span class="sig-paren">(</span><em>lambdas</em>, <em>Bs</em>, <em>Z</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.plot_surface" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to plot a 2D free energy surface.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lambdas: list-like of numbers</strong></p>
<blockquote>
<div><p>the simulated lambda values</p>
</div></blockquote>
<p><strong>Bs: list-like of numbers</strong></p>
<blockquote>
<div><p>the simulated B values</p>
</div></blockquote>
<p><strong>Z: 2D list-like of numbers</strong></p>
<blockquote class="last">
<div><p>the heights of the free energy surface</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.gcmc_free_energy_base.pseudohuber">
<code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">pseudohuber</code><span class="sig-paren">(</span><em>r</em>, <em>c</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.pseudohuber" title="Permalink to this definition">¶</a></dt>
<dd><p>The pseudo Huber loss/cost function. Smooth version of Huber loss function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>r</strong> : float</p>
<blockquote>
<div><p>residual, i.e. difference between predicted value and its target</p>
</div></blockquote>
<p><strong>c</strong> : float</p>
<blockquote class="last">
<div><p>parameter that determines roughly where residuals will have less weight</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.gcmc_free_energy_base.simplex_sample">
<code class="descclassname">tools.gcmc_free_energy_base.</code><code class="descname">simplex_sample</code><span class="sig-paren">(</span><em>size</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.gcmc_free_energy_base.simplex_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples uniformly over a simplex, such that the output sums to 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>size</strong> : integer</p>
<blockquote class="last">
<div><p>the number of random numbers you want</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.generate_input">
<span id="tools-generate-input-module"></span><h2>tools.generate_input module<a class="headerlink" href="#module-tools.generate_input" title="Permalink to this headline">¶</a></h2>
<p>Classes and routines to make ProtoMS command files</p>
<p>This module defines a single public function
generate_input</p>
<p>and the following public classes:
ProtoMSSimulation
ProteinLigandSimulation
Equilibration
Sampling
DualTopology</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="class">
<dt id="tools.generate_input.DualTopology">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">DualTopology</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb', 'solute2.pdb'], solvent='water.pdb', templates=['solute1.tem', 'solute2.tem'], nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, ranseed=None, lambdaval=None, outfolder='out', restrained=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.DualTopology" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a dual-topology protein-ligand simulation
Generates input for proteins, solutes and solvent
write dual-toplogy parameters, lambda-replica exchange,
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.Equilibration">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">Equilibration</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute.pdb'], solvent='water.pdb', templates=['solute.tem'], outfolder='', ranseed=None, nsteps=100000.0, pdbfile='equilibrated.pdb'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.Equilibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for equilibration of a protein-ligand system
Generates input for proteins, solutes and solvent and write an equilibration and a pdb chunk</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.GCMC">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">GCMC</code><span class="sig-paren">(</span><em>protein='protein.pdb'</em>, <em>solutes=[]</em>, <em>solvent='water.pdb'</em>, <em>templates=[]</em>, <em>gcmcwater='gcmc_water.pdb'</em>, <em>gcmcbox=None</em>, <em>nequil=5000000.0</em>, <em>nprod=80000000.0</em>, <em>dumpfreq=200000.0</em>, <em>adamval=None</em>, <em>ranseed=None</em>, <em>watmodel='tip4p'</em>, <em>outfolder='out_gcmc'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.GCMC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a GCMC simulation
Generates input for proteins, solutes and solvent
write GCMC parameters
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.Jaws1">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">Jaws1</code><span class="sig-paren">(</span><em>protein='protein.pdb'</em>, <em>solutes=[]</em>, <em>solvent='water.pdb'</em>, <em>templates=[]</em>, <em>outfolder=''</em>, <em>ranseed=None</em>, <em>jawswater='jaws_water.pdb'</em>, <em>jawsbox=None</em>, <em>nequil=5000000.0</em>, <em>nprod=40000000.0</em>, <em>watmodel='tip4p'</em>, <em>dumpfreq=100000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.Jaws1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a JAWS-1 simulation
Generates input for proteins, solutes and solvent
write JAWS-1 parameters
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.Jaws2">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">Jaws2</code><span class="sig-paren">(</span><em>protein='protein.pdb'</em>, <em>solutes=[]</em>, <em>solvent='water.pdb'</em>, <em>templates=[]</em>, <em>outfolder=''</em>, <em>ranseed=None</em>, <em>jawswater='jaws_water.pdb'</em>, <em>jbias=6.5</em>, <em>nequil=5000000.0</em>, <em>nprod=40000000.0</em>, <em>watmodel='tip4p'</em>, <em>dumpfreq=100000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.Jaws2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a JAWS-2 simulation
Generates input for proteins, solutes and solvent
write JAWS-2 parameters
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.ProteinLigandSimulation">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">ProteinLigandSimulation</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute.pdb'], solvent='water.pdb', templates=['solute.tem'], outfolder=None, ranseed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProteinLigandSimulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProtoMSSimulation" title="tools.generate_input.ProtoMSSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProtoMSSimulation</span></code></a></p>
<p>This a generic command file for a protein-ligand simulation
Generates input for proteins, solutes and solvent but does not write any chunks</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.ProtoMSSimulation">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">ProtoMSSimulation</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a ProtoMS command file object.This object holds all of the information
about the simulation and can either run the simulation with this
information, or can write this information to a command file.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>lines :</strong></td>
<td>list of strings all the lines of the ProtoMS command file</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.clear" title="tools.generate_input.ProtoMSSimulation.clear"><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code></a>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.readCommandFile" title="tools.generate_input.ProtoMSSimulation.readCommandFile"><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code></a>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.run" title="tools.generate_input.ProtoMSSimulation.run"><code class="xref py py-obj docutils literal"><span class="pre">run</span></code></a>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setChunk" title="tools.generate_input.ProtoMSSimulation.setChunk"><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code></a>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setDump" title="tools.generate_input.ProtoMSSimulation.setDump"><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code></a>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setForceField" title="tools.generate_input.ProtoMSSimulation.setForceField"><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code></a>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setParameter" title="tools.generate_input.ProtoMSSimulation.setParameter"><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code></a>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setProtein" title="tools.generate_input.ProtoMSSimulation.setProtein"><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code></a>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setSolute" title="tools.generate_input.ProtoMSSimulation.setSolute"><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code></a>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setSolvent" title="tools.generate_input.ProtoMSSimulation.setSolvent"><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code></a>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setStream" title="tools.generate_input.ProtoMSSimulation.setStream"><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code></a>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.writeCommandFile" title="tools.generate_input.ProtoMSSimulation.writeCommandFile"><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code></a>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the simulation description</p>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.readCommandFile">
<code class="descname">readCommandFile</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.readCommandFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a simulation from a command file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the filename of the command file to read from disc</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>exe</em>, <em>cmdfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run this simulation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>exe</strong> : string</p>
<blockquote>
<div><p>the filename of the executable</p>
</div></blockquote>
<p><strong>cmdfile</strong> : string, optional</p>
<blockquote class="last">
<div><p>the filename of the command file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setChunk">
<code class="descname">setChunk</code><span class="sig-paren">(</span><em>chunk</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setChunk" title="Permalink to this definition">¶</a></dt>
<dd><p>This adds the simulation chunk to ‘chunk’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chunk</strong> : string</p>
<blockquote class="last">
<div><p>the chunk to be executed, including parameters</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setDump">
<code class="descname">setDump</code><span class="sig-paren">(</span><em>dump</em>, <em>freq</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setDump" title="Permalink to this definition">¶</a></dt>
<dd><p>This adds the simulation dump to ‘dump’ with frequnecy freq</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dump</strong> : string</p>
<blockquote>
<div><p>the dump to be executed, including parameters</p>
</div></blockquote>
<p><strong>freq</strong> : int</p>
<blockquote class="last">
<div><p>the dump frequency</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setForceField">
<code class="descname">setForceField</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setForceField" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for parfile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the filename of the force field file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setParameter">
<code class="descname">setParameter</code><span class="sig-paren">(</span><em>parameter</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameter to value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>parameter</strong> : string</p>
<blockquote>
<div><p>the name of the parameter</p>
</div></blockquote>
<p><strong>value</strong> : string</p>
<blockquote class="last">
<div><p>the value of the parameter</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setProtein">
<code class="descname">setProtein</code><span class="sig-paren">(</span><em>n</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setProtein" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for proteinN. It then returns n+1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n</strong> : int</p>
<blockquote>
<div><p>the protein serial number</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote>
<div><p>the filename of the protein pdb file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>n + 1</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setSolute">
<code class="descname">setSolute</code><span class="sig-paren">(</span><em>n</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setSolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for soluteN. It then returns n+1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n</strong> : int</p>
<blockquote>
<div><p>the solute serial number</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote>
<div><p>the filename of the solute pdb file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>n + 1</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setSolvent">
<code class="descname">setSolvent</code><span class="sig-paren">(</span><em>n</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setSolvent" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for solventN. It then returns n+1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n</strong> : int</p>
<blockquote>
<div><p>the solvent serial number</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote>
<div><p>the filename of the solvent pdb file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>n + 1</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setStream">
<code class="descname">setStream</code><span class="sig-paren">(</span><em>stream</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the direction of the output stream to a filename</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stream</strong> : string</p>
<blockquote>
<div><p>the name of the stream</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the filename to direct the stream to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.writeCommandFile">
<code class="descname">writeCommandFile</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.writeCommandFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the contents of this simulation object to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the filename to write the commands to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.generate_input.RestraintRelease">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">RestraintRelease</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb'], solvent='water.pdb', templates=['solute.tem'], nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, lambdaval=None, ranseed=None, outfolder='out', restrained=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.RestraintRelease" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>Command file to calculate the free energy of introducing a harmonic restraint
during the bound leg of a simulation.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.Sampling">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">Sampling</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute.pdb'], solvent='water.pdb', templates=['solute.tem'], outfolder='', ranseed=None, nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, outprefix='', tune=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.Sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for MC sampling of a protein-ligand system
Generates input for proteins, solutes and solvent and write 
chunks for equilibration and simulation, as well as dumps</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.SingleTopology">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">SingleTopology</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb'], solvent='water.pdb', templates=['solute.tem'], nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, lambdaval=None, ranseed=None, outfolder='out', restrained=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.SingleTopology" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a single-topology protein-ligand simulation
Generates input for proteins, solutes and solvent
write lambda-replica exchange,
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.generate_input.generate_input">
<code class="descclassname">tools.generate_input.</code><code class="descname">generate_input</code><span class="sig-paren">(</span><em>protein</em>, <em>ligands</em>, <em>templates</em>, <em>protein_water</em>, <em>ligand_water</em>, <em>ranseed</em>, <em>settings</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.generate_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates ProtoMS command files</p>
<p>If protein is a valid filename a protein(-ligand) simulation is setup, and if
ligands contains at least one valid filename a ligand simulation is setup.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>protein</strong> : string</p>
<blockquote>
<div><p>the filename of a protein pdb file</p>
</div></blockquote>
<p><strong>ligands</strong> : list of strings</p>
<blockquote>
<div><p>filenames of solute pdb files</p>
</div></blockquote>
<p><strong>templates</strong> : list of strings</p>
<blockquote>
<div><p>filenames of template files to be included</p>
</div></blockquote>
<p><strong>protein_water</strong> : string</p>
<blockquote>
<div><p>the filename of a solvent pdb file for the protein</p>
</div></blockquote>
<p><strong>ligand_water</strong> : string</p>
<blockquote>
<div><p>the filename of a solvent pdb file for the ligands</p>
</div></blockquote>
<p><strong>settings</strong> : Namespace object (from argparse)</p>
<blockquote>
<div><p>additional settings</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>free_cmd</strong> : ProtoMSSimulation</p>
<blockquote>
<div><p>the command file for the ligand simulation</p>
</div></blockquote>
<p><strong>bnd_cmd</strong> : ProtoMSSimulation</p>
<blockquote>
<div><p>the command file for the protein simulation</p>
</div></blockquote>
<p><strong>gas_cmd</strong> : ProtoMSSimulation</p>
<blockquote class="last">
<div><p>the command file for the gas simulation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.generate_input.get_arg_parser">
<code class="descclassname">tools.generate_input.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tools.make_dummy">
<span id="tools-make-dummy-module"></span><h2>tools.make_dummy module<a class="headerlink" href="#module-tools.make_dummy" title="Permalink to this headline">¶</a></h2>
<p>Routine to make a dummy PDB structure for a solute</p>
<p>This module defines a single public function:
make_dummy</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.make_dummy.get_arg_parser">
<code class="descclassname">tools.make_dummy.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_dummy.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.make_dummy.make_dummy">
<code class="descclassname">tools.make_dummy.</code><code class="descname">make_dummy</code><span class="sig-paren">(</span><em>pdbfile</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_dummy.make_dummy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a dummy PDB structure to match a molecule</p>
<p>It will place the dummy at the centre of the molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbfile</strong> : string or PDBFile</p>
<blockquote>
<div><p>the pdb structure of the molecule</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile instance</p>
<blockquote class="last">
<div><p>the dummy structure</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.make_gcmcbox">
<span id="tools-make-gcmcbox-module"></span><h2>tools.make_gcmcbox module<a class="headerlink" href="#module-tools.make_gcmcbox" title="Permalink to this headline">¶</a></h2>
<p>Routine to make a GCMC/JAWS-1 simulation box from a ligand</p>
<p>This module defines a single public function:
make_gcmcbox</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.make_gcmcbox.get_arg_parser">
<code class="descclassname">tools.make_gcmcbox.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_gcmcbox.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.make_gcmcbox.make_gcmcbox">
<code class="descclassname">tools.make_gcmcbox.</code><code class="descname">make_gcmcbox</code><span class="sig-paren">(</span><em>pdb</em>, <em>filename</em>, <em>padding=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_gcmcbox.make_gcmcbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a GCMC/JAWS-1 simulation box around a PDB-structure</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdb</strong> : PDBFile object</p>
<blockquote>
<div><p>the PDB structure</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote>
<div><p>the name of the output file</p>
</div></blockquote>
<p><strong>padding</strong> : float, optional</p>
<blockquote class="last">
<div><p>the amount of extra space around the ligand to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.make_gcmcbox.print_bequil">
<code class="descclassname">tools.make_gcmcbox.</code><code class="descname">print_bequil</code><span class="sig-paren">(</span><em>boxlen</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_gcmcbox.print_bequil" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tools.make_single">
<span id="tools-make-single-module"></span><h2>tools.make_single module<a class="headerlink" href="#module-tools.make_single" title="Permalink to this headline">¶</a></h2>
<p>Routines to make ProtoMS single topology template</p>
<p>This module defines these public function
make_single
write_map
summarize</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.make_single.get_arg_parser">
<code class="descclassname">tools.make_single.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_single.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.make_single.make_single">
<code class="descclassname">tools.make_single.</code><code class="descname">make_single</code><span class="sig-paren">(</span><em>tem1</em>, <em>tem2</em>, <em>pdb1</em>, <em>pdb2</em>, <em>mapfile=None</em>, <em>gaffversion='gaff16'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_single.make_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Make single topology templates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tem1</strong> : TemplateFile or string</p>
<blockquote>
<div><p>first template file or its filename</p>
</div></blockquote>
<p><strong>tem2</strong> : TemplateFile or string</p>
<blockquote>
<div><p>second template file or its filename</p>
</div></blockquote>
<p><strong>pdb1</strong> : PDBFile or string</p>
<blockquote>
<div><p>structure template for tem1 or its filename</p>
</div></blockquote>
<p><strong>pdb2</strong> : PDBFile or string</p>
<blockquote>
<div><p>structure template for tem2 or its filename</p>
</div></blockquote>
<p><strong>mapfile</strong> : string, optional</p>
<blockquote>
<div><p>filename of map of correspondance</p>
</div></blockquote>
<p><strong>gaffversion</strong> : str, optional</p>
<blockquote>
<div><p>version of gaff to use, defaults to gaff16</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">TemplateFile</p>
<blockquote>
<div><p>a template file for the electrostatic leg</p>
</div></blockquote>
<p>TemplateFile</p>
<blockquote>
<div><p>a template file for the van der Waals leg</p>
</div></blockquote>
<p>TemplateFile</p>
<blockquote>
<div><p>a template file for a combined transformation</p>
</div></blockquote>
<p>dictionary of strings</p>
<blockquote>
<div><p>the full map of correspondance</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>SetupError</strong></p>
<blockquote class="last">
<div><p>tem2 is larger than tem1</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.make_single.summarize">
<code class="descclassname">tools.make_single.</code><code class="descname">summarize</code><span class="sig-paren">(</span><em>eletem</em>, <em>vdwtem</em>, <em>loggfunc</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_single.summarize" title="Permalink to this definition">¶</a></dt>
<dd><p>Print single topology parameter summary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>eletem</strong> : TemplateFile</p>
<blockquote>
<div><p>template for electrostatic perturbation</p>
</div></blockquote>
<p><strong>vdwtem</strong> : TemplateFile</p>
<blockquote>
<div><p>template for van der Waals perturbation</p>
</div></blockquote>
<p><strong>loggfunc</strong> : logger function</p>
<blockquote class="last">
<div><p>the logger function to use to print the summary</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.make_single.write_map">
<code class="descclassname">tools.make_single.</code><code class="descname">write_map</code><span class="sig-paren">(</span><em>cmap</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_single.write_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a correspondance map to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cmap</strong> : a dictionary of strings</p>
<blockquote>
<div><p>the map of correspondance</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.merge_templates">
<span id="tools-merge-templates-module"></span><h2>tools.merge_templates module<a class="headerlink" href="#module-tools.merge_templates" title="Permalink to this headline">¶</a></h2>
<p>Routine to merge a series of ProtoMS template files</p>
<p>This module defines a single public function:
merge_templates</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.merge_templates.get_arg_parser">
<code class="descclassname">tools.merge_templates.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.merge_templates.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.merge_templates.merge_templates">
<code class="descclassname">tools.merge_templates.</code><code class="descname">merge_templates</code><span class="sig-paren">(</span><em>templates</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.merge_templates.merge_templates" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge a series of ProtoMS template files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>templates</strong> : list of string</p>
<blockquote>
<div><p>the names of the template file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">TemplateFile</p>
<blockquote>
<div><p>the merged template file</p>
</div></blockquote>
<p>or</p>
<p>string</p>
<blockquote class="last">
<div><p>the filename of the single unique template</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.pms2pymbar">
<span id="tools-pms2pymbar-module"></span><h2>tools.pms2pymbar module<a class="headerlink" href="#module-tools.pms2pymbar" title="Permalink to this headline">¶</a></h2>
<p>Program to prepare ProtoMS output for pymbar</p>
<p>This module defines two public functions:
extract_energies
mbar</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.pms2pymbar.bar">
<code class="descclassname">tools.pms2pymbar.</code><code class="descname">bar</code><span class="sig-paren">(</span><em>energies</em>, <em>RT</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.pms2pymbar.bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the BAR free energy using the PyMBAR package</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lambdas</strong> : numpy array</p>
<blockquote>
<div><p>the lambda values</p>
</div></blockquote>
<p><strong>energies</strong> : list of numpy array</p>
<blockquote>
<div><p>the energy values at each lambda and each snapshot</p>
</div></blockquote>
<p><strong>RT</strong> : float</p>
<blockquote>
<div><p>the gas constant multiplied by the absolute temperature</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>the free energy</p>
</div></blockquote>
<p>float</p>
<blockquote class="last">
<div><p>the uncertainty in the free energy</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.pms2pymbar.extract_energies">
<code class="descclassname">tools.pms2pymbar.</code><code class="descname">extract_energies</code><span class="sig-paren">(</span><em>path</em>, <em>res_tem</em>, <em>skip</em>, <em>maxread</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.pms2pymbar.extract_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract total energies from a number of folders</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong> : string</p>
<blockquote>
<div><p>the directory to find lambda folders</p>
</div></blockquote>
<p><strong>res_tem</strong> : string</p>
<blockquote>
<div><p>the prefix of the results files</p>
</div></blockquote>
<p><strong>skip</strong> : int</p>
<blockquote>
<div><p>number of snapshots to ignore</p>
</div></blockquote>
<p><strong>maxread</strong> : int</p>
<blockquote>
<div><p>maximum number of snapshots to read</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of float</p>
<blockquote>
<div><p>the lambda values</p>
</div></blockquote>
<p>list of numpy array</p>
<blockquote>
<div><p>all total energies</p>
</div></blockquote>
<p>list of strings</p>
<blockquote class="last">
<div><p>the path of the lambda folders</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.pms2pymbar.get_arg_parser">
<code class="descclassname">tools.pms2pymbar.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.pms2pymbar.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.pms2pymbar.mbar">
<code class="descclassname">tools.pms2pymbar.</code><code class="descname">mbar</code><span class="sig-paren">(</span><em>lambdas</em>, <em>energies</em>, <em>RT</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.pms2pymbar.mbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the MBAR free energy using the PyMBAR package</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lambdas</strong> : numpy array</p>
<blockquote>
<div><p>the lambda values</p>
</div></blockquote>
<p><strong>energies</strong> : list of numpy array</p>
<blockquote>
<div><p>the energy values at each lambda and each snapshot</p>
</div></blockquote>
<p><strong>RT</strong> : float</p>
<blockquote>
<div><p>the gas constant multiplied by the absolute temperature</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote>
<div><p>the free energy matrix</p>
</div></blockquote>
<p>numpy array</p>
<blockquote class="last">
<div><p>the uncertainty in the free energy matrix</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.scoop">
<span id="tools-scoop-module"></span><h2>tools.scoop module<a class="headerlink" href="#module-tools.scoop" title="Permalink to this headline">¶</a></h2>
<p>Routines to build a protein scoop</p>
<p>This module defines a single public function
scoop</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.scoop.get_arg_parser">
<code class="descclassname">tools.scoop.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.scoop.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.scoop.scoop">
<code class="descclassname">tools.scoop.</code><code class="descname">scoop</code><span class="sig-paren">(</span><em>protein</em>, <em>ligand</em>, <em>innercut=16</em>, <em>outercut=20</em>, <em>flexin='full'</em>, <em>flexout='sidechain'</em>, <em>terminal='neutralize'</em>, <em>excluded=[]</em>, <em>added=[]</em>, <em>scooplimit=10</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.scoop.scoop" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a scoop from protein structure</p>
<p>The protein object is not modified by this routine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>protein</strong> : PDBFile</p>
<blockquote>
<div><p>pdb instance for the protein to be scooped</p>
</div></blockquote>
<p><strong>ligand</strong> : PDBFile or string</p>
<blockquote>
<div><p>Either pdb instance for ligand to be scooped around, or string giving
the name of a file containing 3 floats to act as coords for scoop centre,
or a string with three floating point numbers</p>
</div></blockquote>
<p><strong>innercut</strong> : float, optional</p>
<blockquote>
<div><p>Maximum distance from ligand defining inner region of the scoop</p>
</div></blockquote>
<p><strong>outercut</strong> : float, optional</p>
<blockquote>
<div><p>Maximum distance from ligand defining outer region of the scoop</p>
</div></blockquote>
<p><strong>flexin</strong> : string, optional</p>
<blockquote>
<div><p>Gives the degree of flexibility for residues of the inner region
Can be ‘rigid’, ‘sidechain’ or ‘flexible’</p>
</div></blockquote>
<p><strong>flexout</strong> : string, optional</p>
<blockquote>
<div><p>As flexin but for residues of the outer scoop</p>
</div></blockquote>
<p><strong>terminal</strong> : string, optional</p>
<blockquote>
<div><p>Determines what to do with terminal residues
Can be ‘keep’, ‘doublekeep’,’neutralize’</p>
</div></blockquote>
<p><strong>excluded</strong> : list of int</p>
<blockquote>
<div><p>List of indices for residues to be excluded from scoop</p>
</div></blockquote>
<p><strong>added</strong> : list of int</p>
<blockquote>
<div><p>List of indices for residues to be included in outer scoop</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile</p>
<blockquote class="last">
<div><p>an object representing the scooped protein</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.simulationobjects">
<span id="tools-simulationobjects-module"></span><h2>tools.simulationobjects module<a class="headerlink" href="#module-tools.simulationobjects" title="Permalink to this headline">¶</a></h2>
<p>Useful classes for setup and analysis of ProtoMS simulations.
Contain classes to</p>
<blockquote>
<div><ol class="arabic simple">
<li>Read, modify and write structures in PDB format</li>
<li>Store parameter collections</li>
<li>Read and store ProtoMS results files</li>
<li>Read, modify and write ProtoMS template files</li>
</ol>
</div></blockquote>
<dl class="class">
<dt id="tools.simulationobjects.Atom">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">Atom</code><span class="sig-paren">(</span><em>index=0</em>, <em>name='?'</em>, <em>resname='???'</em>, <em>resindex=0</em>, <em>coords=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class for holding a PDB atom record</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>index</strong></td>
<td>(integer) the number of the atom in the pdb file</td>
</tr>
<tr class="row-even"><td><strong>resindex</strong></td>
<td>(integer) the number of the residue in the pdb file</td>
</tr>
<tr class="row-odd"><td><strong>name</strong></td>
<td>(string) the name of the atom</td>
</tr>
<tr class="row-even"><td><strong>resname</strong></td>
<td>(string) the name of the residue</td>
</tr>
<tr class="row-odd"><td><strong>coords</strong></td>
<td>(NumpyArray) Cartesian coordinates</td>
</tr>
<tr class="row-even"><td><strong>type</strong></td>
<td>(string) either atom or hetatm</td>
</tr>
<tr class="row-odd"><td><strong>element</strong></td>
<td>(string) the element of the atom</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.Atom.getElement" title="tools.simulationobjects.Atom.getElement"><code class="xref py py-obj docutils literal"><span class="pre">getElement</span></code></a>()</td>
<td>Set the element of this atom</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.Atom.getElement">
<code class="descname">getElement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Atom.getElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the element of this atom</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.AtomSet">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">AtomSet</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.AtomSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a set of atoms and their associated parameter</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>atoms</strong></td>
<td>(list of strings) the atoms in this set</td>
</tr>
<tr class="row-even"><td><strong>param</strong></td>
<td>(int or ForceFieldParameter) the parameter associated with the atoms</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.AtomSet.parse" title="tools.simulationobjects.AtomSet.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.AtomSet.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.AtomSet.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>record</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.DihParameter">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">DihParameter</code><span class="sig-paren">(</span><em>index</em>, <em>ats</em>, <em>terms</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.DihParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a dihedral parameter from a ProtoMS template file</p>
<p>A separate class is needed to handle dihedral parameters due to their
composition of multiple terms.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>index</strong></td>
<td>(integer) the serial number of the parameter</td>
</tr>
<tr class="row-even"><td><strong>ats</strong></td>
<td>(list of string) the name of the atoms associated with the parameter</td>
</tr>
<tr class="row-odd"><td><strong>b0</strong></td>
<td>(list of DihTerm) the terms that make up this dihedral parameter</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.DihTerm">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">DihTerm</code><span class="sig-paren">(</span><em>index</em>, <em>k1</em>, <em>k2</em>, <em>k3</em>, <em>k4</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.DihTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold individual terms making up a Dihedral</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>index</strong></td>
<td>(integer) the serial number of the parameter</td>
</tr>
<tr class="row-even"><td><strong>k1</strong></td>
<td>(float) The term barrier height</td>
</tr>
<tr class="row-odd"><td><strong>k2</strong></td>
<td>(float) OPLS inversion constant (should be either 0.0 or 1.0 for AMBER ffs)</td>
</tr>
<tr class="row-even"><td><strong>k3</strong></td>
<td>(float) The term periodicity</td>
</tr>
<tr class="row-odd"><td><strong>k4</strong></td>
<td>(float) The term phase</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.EnergyResults">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">EnergyResults</code><span class="sig-paren">(</span><em>line=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.EnergyResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold energy results</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>curr</strong></td>
<td>(float) the energy at the current lambda</td>
</tr>
<tr class="row-even"><td><strong>back</strong></td>
<td>(float) the energy at the previous lambda</td>
</tr>
<tr class="row-odd"><td><strong>forward</strong></td>
<td>(float) the energy at the next lambda</td>
</tr>
<tr class="row-even"><td><strong>type</strong></td>
<td>(string) a label</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.EnergyResults.parse_line" title="tools.simulationobjects.EnergyResults.parse_line"><code class="xref py py-obj docutils literal"><span class="pre">parse_line</span></code></a>(line)</td>
<td>Parse energies from the result file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.EnergyResults.parse_line">
<code class="descname">parse_line</code><span class="sig-paren">(</span><em>line</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.EnergyResults.parse_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse energies from the result file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>line</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.ForceFieldParameter">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">ForceFieldParameter</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ForceFieldParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a general parameter set</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>key</strong></td>
<td>(string) a label</td>
</tr>
<tr class="row-even"><td><strong>index</strong></td>
<td>(integer) a serial number</td>
</tr>
<tr class="row-odd"><td><strong>params</strong></td>
<td>(list) either a list of strings or a list of ForceFieldParameter, containing the actual parameters</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.ForceFieldParameter.parse" title="tools.simulationobjects.ForceFieldParameter.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.ForceFieldParameter.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ForceFieldParameter.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>record</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.MolTemplate">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">MolTemplate</code><a class="headerlink" href="#tools.simulationobjects.MolTemplate" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a ProtoMS template</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>name</strong></td>
<td>(string) the name of the template</td>
</tr>
<tr class="row-even"><td><strong>type</strong></td>
<td>(string) the kind of template, e.g. solute</td>
</tr>
<tr class="row-odd"><td><strong>translate</strong></td>
<td>(float) the translation displacement</td>
</tr>
<tr class="row-even"><td><strong>rot</strong></td>
<td>(float) the rotational displacement</td>
</tr>
<tr class="row-odd"><td><strong>atoms</strong></td>
<td>(list of TemplateAtom objects) the atoms in this template</td>
</tr>
<tr class="row-even"><td><strong>connectivity</strong></td>
<td>(list of TemplateConnectivity objects) the connectivity in this template</td>
</tr>
<tr class="row-odd"><td><strong>variables</strong></td>
<td>(list of string) the variable geometries</td>
</tr>
<tr class="row-even"><td><strong>atomclass</strong></td>
<td>(TemplateAtom class) the class to create objects of atoms</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.MolTemplate.parse_from" title="tools.simulationobjects.MolTemplate.parse_from"><code class="xref py py-obj docutils literal"><span class="pre">parse_from</span></code></a>(fileobj)</td>
<td>Parse a full template from a file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.MolTemplate.write_to" title="tools.simulationobjects.MolTemplate.write_to"><code class="xref py py-obj docutils literal"><span class="pre">write_to</span></code></a>(fileobj)</td>
<td>Write the template to disc</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.MolTemplate.write_zmat" title="tools.simulationobjects.MolTemplate.write_zmat"><code class="xref py py-obj docutils literal"><span class="pre">write_zmat</span></code></a>(filename)</td>
<td>Write the z-matrix of this template to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.MolTemplate.parse_from">
<code class="descname">parse_from</code><span class="sig-paren">(</span><em>fileobj</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MolTemplate.parse_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a full template from a file</p>
<p>Terminates when found another mode 
or end of file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fileobj</strong> : file object</p>
<blockquote class="last">
<div><p>the file to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.MolTemplate.write_to">
<code class="descname">write_to</code><span class="sig-paren">(</span><em>fileobj</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MolTemplate.write_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the template to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fileobj</strong> : file object</p>
<blockquote class="last">
<div><p>the file to write to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.MolTemplate.write_zmat">
<code class="descname">write_zmat</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MolTemplate.write_zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the z-matrix of this template to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the file to write to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.MyArgumentParser">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">MyArgumentParser</code><span class="sig-paren">(</span><em>prog=None</em>, <em>usage=None</em>, <em>description=None</em>, <em>epilog=None</em>, <em>version=None</em>, <em>parents=[]</em>, <em>formatter_class=&lt;class 'argparse.HelpFormatter'&gt;</em>, <em>prefix_chars='-'</em>, <em>fromfile_prefix_chars=None</em>, <em>argument_default=None</em>, <em>conflict_handler='error'</em>, <em>add_help=True</em>, <em>add_fullhelp=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MyArgumentParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></code></p>
<p>Extention to ArgumentParser to allow separation of of help in to 
help for most common options and full help that list all arguments</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">add_argument</span></code>(dest,&nbsp;…[,&nbsp;name,&nbsp;name])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">add_argument_group</span></code>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">add_mutually_exclusive_group</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">add_subparsers</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">convert_arg_line_to_args</span></code>(arg_line)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">error</span></code>(message:&nbsp;string)</td>
<td>Prints a usage message incorporating the message to stderr and exits.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">exit</span></code>([status,&nbsp;message])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.MyArgumentParser.format_help" title="tools.simulationobjects.MyArgumentParser.format_help"><code class="xref py py-obj docutils literal"><span class="pre">format_help</span></code></a>([fullhelp])</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">format_usage</span></code>()</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">format_version</span></code>()</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">get_default</span></code>(dest)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">parse_args</span></code>([args,&nbsp;namespace])</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">parse_known_args</span></code>([args,&nbsp;namespace])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.MyArgumentParser.print_fullhelp" title="tools.simulationobjects.MyArgumentParser.print_fullhelp"><code class="xref py py-obj docutils literal"><span class="pre">print_fullhelp</span></code></a>([file])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.MyArgumentParser.print_help" title="tools.simulationobjects.MyArgumentParser.print_help"><code class="xref py py-obj docutils literal"><span class="pre">print_help</span></code></a>([file])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">print_usage</span></code>([file])</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">print_version</span></code>([file])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">register</span></code>(registry_name,&nbsp;value,&nbsp;object)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">set_defaults</span></code>(**kwargs)</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.MyArgumentParser.format_help">
<code class="descname">format_help</code><span class="sig-paren">(</span><em>fullhelp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MyArgumentParser.format_help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.MyArgumentParser.print_fullhelp">
<code class="descname">print_fullhelp</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MyArgumentParser.print_fullhelp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.MyArgumentParser.print_help">
<code class="descname">print_help</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MyArgumentParser.print_help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.PDBFile">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">PDBFile</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for holding the atoms and residues of a PDB file</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>center</strong></td>
<td>(NumPy array) the center of coordinates of all atoms</td>
</tr>
<tr class="row-even"><td><strong>header</strong></td>
<td>(string) additional lines to print before ATOM records</td>
</tr>
<tr class="row-odd"><td><strong>name</strong></td>
<td>(string) the name of the file</td>
</tr>
<tr class="row-even"><td><strong>residues</strong></td>
<td>(dictionary of Residue objects) all non-solvent residues</td>
</tr>
<tr class="row-odd"><td><strong>solvents</strong></td>
<td>(dictionary of Residue objects) all solvent residues</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.copy" title="tools.simulationobjects.PDBFile.copy"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a>()</td>
<td>Make a copy of the residues and solvents dictionaries,</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.getBox" title="tools.simulationobjects.PDBFile.getBox"><code class="xref py py-obj docutils literal"><span class="pre">getBox</span></code></a>([atomlist,&nbsp;reslist])</td>
<td>Calculate the smallest box to encompass the atoms</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.getCenter" title="tools.simulationobjects.PDBFile.getCenter"><code class="xref py py-obj docutils literal"><span class="pre">getCenter</span></code></a>()</td>
<td>Calculate the center of geometry</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.read" title="tools.simulationobjects.PDBFile.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(filename)</td>
<td>Read a pdb-file from disc</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.read_from" title="tools.simulationobjects.PDBFile.read_from"><code class="xref py py-obj docutils literal"><span class="pre">read_from</span></code></a>(f[,&nbsp;resname])</td>
<td>Read a pdb structure from a fileobject</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.write" title="tools.simulationobjects.PDBFile.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a>(filename,&nbsp;**kwargs)</td>
<td>Write the PDB file to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.PDBFile.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a copy of the residues and solvents dictionaries, 
not the Residue and Atom objects themselves</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile</p>
<blockquote class="last">
<div><p>the newly created instance</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBFile.getBox">
<code class="descname">getBox</code><span class="sig-paren">(</span><em>atomlist='all'</em>, <em>reslist='all'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.getBox" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the smallest box to encompass the atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atomlist = list, optional</strong></p>
<blockquote>
<div><p>the atoms to be taken into acount to get the box</p>
</div></blockquote>
<p><strong>reslist = list, optional</strong></p>
<blockquote>
<div><p>the residues to be taken into acount to get the box</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dictionary of Numpy arrays</p>
<blockquote class="last">
<div><p>the center, length and origin of the box</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBFile.getCenter">
<code class="descname">getCenter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.getCenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the center of geometry</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumPy array</p>
<blockquote class="last">
<div><p>the center</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a pdb-file from disc</p>
<p>It will overwrite existing residues and renumber all residues from 1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the pdb file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBFile.read_from">
<code class="descname">read_from</code><span class="sig-paren">(</span><em>f</em>, <em>resname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.read_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a pdb structure from a fileobject</p>
<p>Terminates reading when found a record starting with END</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>f</strong> : file object</p>
<blockquote>
<div><p>the object to read from</p>
</div></blockquote>
<p><strong>resname</strong> : string, optional</p>
<blockquote class="last">
<div><p>the name of the residue to read, only read this</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBFile.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the PDB file to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote>
<div><p>the name of the file</p>
</div></blockquote>
<p><strong>renumber</strong> : boolean, optional</p>
<blockquote>
<div><p>indicate if residues should be renumbered</p>
</div></blockquote>
<p><strong>header</strong> : string, optional</p>
<blockquote>
<div><p>additional lines to print before the atom records</p>
</div></blockquote>
<p><strong>solvents</strong> : boolean, optional</p>
<blockquote class="last">
<div><p>if to write the solvents</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.PDBSet">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">PDBSet</code><a class="headerlink" href="#tools.simulationobjects.PDBSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Hold a collection of PDBFile objects</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>pdbs</strong></td>
<td>(list of PDBFile objects) the pdb files</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.PDBSet.from_residues" title="tools.simulationobjects.PDBSet.from_residues"><code class="xref py py-obj docutils literal"><span class="pre">from_residues</span></code></a>(pdbfile)</td>
<td>Split a PDB file into a set by residue</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.PDBSet.read" title="tools.simulationobjects.PDBSet.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(filename[,&nbsp;resname,&nbsp;skip,&nbsp;readmax])</td>
<td>Read a set of pdb structures from a file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.PDBSet.write" title="tools.simulationobjects.PDBSet.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a>(filenames[,&nbsp;solvents])</td>
<td>Write the set to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.PDBSet.from_residues">
<code class="descname">from_residues</code><span class="sig-paren">(</span><em>pdbfile</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBSet.from_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a PDB file into a set by residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbfile</strong> : PDBFile object</p>
<blockquote class="last">
<div><p>the pdb-file to split</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBSet.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em>, <em>resname=None</em>, <em>skip=0</em>, <em>readmax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBSet.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a set of pdb structures from a file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote>
<div><p>the name of the file to read</p>
</div></blockquote>
<p><strong>resname</strong> : string, optional</p>
<blockquote>
<div><p>the name of the residue to read, only read this</p>
</div></blockquote>
<p><strong>skip</strong> : int, optional</p>
<blockquote>
<div><p>number of snapshot at the beginning to skip</p>
</div></blockquote>
<p><strong>readmax</strong> : int, optional</p>
<blockquote class="last">
<div><p>maximum number of snapshots to read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBSet.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filenames</em>, <em>solvents=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBSet.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the set to disc</p>
<p>If one filename is given all PDB-files are written to one file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filenames</strong> : list of strings</p>
<blockquote>
<div><p>the name of the file(s) to write to</p>
</div></blockquote>
<p><strong>solvents</strong> : boolean</p>
<blockquote class="last">
<div><p>if to write the solvents</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.Parameter">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">Parameter</code><span class="sig-paren">(</span><em>index</em>, <em>ats</em>, <em>k</em>, <em>b0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a parameter from a ProtoMS template file</p>
<p>Not valid for dihedral parameters but contains sufficient
information to check that a parameter exists</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>index</strong></td>
<td>(integer) the serial number of the parameter</td>
</tr>
<tr class="row-even"><td><strong>ats</strong></td>
<td>(list of string) the name of the atoms associated with the parameter</td>
</tr>
<tr class="row-odd"><td><strong>k</strong></td>
<td>(float) the force constant</td>
</tr>
<tr class="row-even"><td><strong>b0</strong></td>
<td>(float) the equilibrium value</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.ParameterSet">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">ParameterSet</code><span class="sig-paren">(</span><em>ptype</em>, <em>param_file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ParameterSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a collection of parameters</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>file_name</strong></td>
<td>(string) the name of the file where the parameters originated</td>
</tr>
<tr class="row-even"><td><strong>params</strong></td>
<td>(list of Parameter objects) the parameters in this collection</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.ParameterSet.get_par_by_index" title="tools.simulationobjects.ParameterSet.get_par_by_index"><code class="xref py py-obj docutils literal"><span class="pre">get_par_by_index</span></code></a>(ind)</td>
<td>For an atm line index find matching the par line</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.ParameterSet.get_params" title="tools.simulationobjects.ParameterSet.get_params"><code class="xref py py-obj docutils literal"><span class="pre">get_params</span></code></a>(ats)</td>
<td>Find parameter sets for specific atoms.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.ParameterSet.read" title="tools.simulationobjects.ParameterSet.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(param_file)</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tools.simulationobjects.ParameterSet.formats">
<code class="descname">formats</code><em class="property"> = {'angle': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;), 'atm': (&lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;)}, 'bond': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;), 'atm': (&lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;)}, 'clj': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;)}, 'dihedral': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;), 'atm': (&lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;), 'term': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;)}}</em><a class="headerlink" href="#tools.simulationobjects.ParameterSet.formats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.ParameterSet.get_par_by_index">
<code class="descname">get_par_by_index</code><span class="sig-paren">(</span><em>ind</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ParameterSet.get_par_by_index" title="Permalink to this definition">¶</a></dt>
<dd><p>For an atm line index find matching the par line</p>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.ParameterSet.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>ats</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ParameterSet.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Find parameter sets for specific atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ats</strong> : sequence of strings</p>
<blockquote>
<div><p>the query atoms</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Parameter object</p>
<blockquote class="last">
<div><p>the found parameter</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.ParameterSet.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>param_file</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ParameterSet.read" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.Residue">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">Residue</code><span class="sig-paren">(</span><em>name='???'</em>, <em>index=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class for holding a set of PDB atoms</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>atoms</strong></td>
<td>(list of Atom objects) the atom of this residue</td>
</tr>
<tr class="row-even"><td><strong>index</strong></td>
<td>(integer) the number of the residue in the pdb file</td>
</tr>
<tr class="row-odd"><td><strong>name</strong></td>
<td>(string) the name of the residue</td>
</tr>
<tr class="row-even"><td><strong>center</strong></td>
<td>(NumPy array) the center of coordinates of all atoms</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.Residue.addAtom" title="tools.simulationobjects.Residue.addAtom"><code class="xref py py-obj docutils literal"><span class="pre">addAtom</span></code></a>(atom)</td>
<td>Adds an atom to this residue</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.Residue.getCenter" title="tools.simulationobjects.Residue.getCenter"><code class="xref py py-obj docutils literal"><span class="pre">getCenter</span></code></a>()</td>
<td>Sets the center of coordinates for this residue</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.Residue.isAminoacid" title="tools.simulationobjects.Residue.isAminoacid"><code class="xref py py-obj docutils literal"><span class="pre">isAminoacid</span></code></a>()</td>
<td>Checks is the residue name is an aminoacid name</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.Residue.addAtom">
<code class="descname">addAtom</code><span class="sig-paren">(</span><em>atom</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Residue.addAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an atom to this residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atom</strong> : Atom object</p>
<blockquote class="last">
<div><p>the atom to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.Residue.getCenter">
<code class="descname">getCenter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Residue.getCenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the center of coordinates for this residue</p>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.Residue.isAminoacid">
<code class="descname">isAminoacid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Residue.isAminoacid" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks is the residue name is an aminoacid name</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.RestartFile">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">RestartFile</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.RestartFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold the information on a
restart file</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>filename</strong></td>
<td>(string) the name of the restart file</td>
</tr>
<tr class="row-even"><td><strong>nsolutes</strong></td>
<td>(int) the number of solute molecules</td>
</tr>
<tr class="row-odd"><td><strong>ngcsolutes</strong></td>
<td>(int) the number of gcsolute molecules</td>
</tr>
<tr class="row-even"><td><strong>solutesdic</strong></td>
<td>(dict) the correlation of solute ids with residue names</td>
</tr>
<tr class="row-odd"><td><strong>gcsolutesdic</strong></td>
<td>(dict) the correlation of gcsolutes ids with residue names</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.RestartFile.read" title="tools.simulationobjects.RestartFile.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(filename)</td>
<td>Read the restart file from disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.RestartFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.RestartFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the restart file from disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the file to read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.ResultsFile">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">ResultsFile</code><a class="headerlink" href="#tools.simulationobjects.ResultsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to store a collection of results</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>filename</strong></td>
<td>(string) the name of the file</td>
</tr>
<tr class="row-even"><td><strong>snapshots</strong></td>
<td>(list of SnapshotResult) all the results</td>
</tr>
<tr class="row-odd"><td><strong>series</strong></td>
<td>(SnapshotResult) all the results in a single object</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.ResultsFile.make_series" title="tools.simulationobjects.ResultsFile.make_series"><code class="xref py py-obj docutils literal"><span class="pre">make_series</span></code></a>()</td>
<td>Make a snapshot with all the results</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.ResultsFile.read" title="tools.simulationobjects.ResultsFile.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(filename[,&nbsp;skip,&nbsp;readmax])</td>
<td>Read results from disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.ResultsFile.make_series">
<code class="descname">make_series</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ResultsFile.make_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a snapshot with all the results</p>
<p>This routine creates a special SnapshotResults object, which has
the same attributes as the objects in the snapshots list,
but rather than storing single floats and integers, this
object stores NumpyArrays of all the results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">SnapshotResults</p>
<blockquote class="last">
<div><p>the created object, also stored in self.series</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.ResultsFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em>, <em>skip=0</em>, <em>readmax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ResultsFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read results from disc</p>
<p>The filename parameter can be either a single filename, in
case it is assumed that it is a ProtoMS3.0 results file, i.e.
it contains several snapshots
if it is a list of strings, two behaviors are supported:</p>
<blockquote>
<div><ol class="arabic simple">
<li>if the length of the list is 2, and the first filename</li>
</ol>
</div></blockquote>
<p>is a dictionary, a glob is used to list all filenames in that
directory that starts with the second filename in the list</p>
<blockquote>
<div><ol class="arabic simple" start="2">
<li>if the length is not two or you give two filenames,</li>
</ol>
</div></blockquote>
<p>each of them are processed individually and treated as individual
snapshots</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string or list of strings</p>
<blockquote>
<div><p>the name of the file to read</p>
</div></blockquote>
<p><strong>skip</strong> : int, optional</p>
<blockquote>
<div><p>number of snapshot at the beginning to skip</p>
</div></blockquote>
<p><strong>readmax</strong> : int, optional</p>
<blockquote class="last">
<div><p>maximum number of snapshots to read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="tools.simulationobjects.SetupError">
<em class="property">exception </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">SetupError</code><a class="headerlink" href="#tools.simulationobjects.SetupError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>A general exception class to be raised by setup code</p>
</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.SnapshotResults">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">SnapshotResults</code><a class="headerlink" href="#tools.simulationobjects.SnapshotResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to store a single snapshot of results</p>
<p>Not all attributes might not be set as they might not
exists in the result file</p>
<p>internal_energies and interaction_energies are dictionary
where the key is is the molecules involved in the energy, e.g.
protein1, or protein1-solute1. The value is a list of EnergyResults
objects, for the various energy components.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>lam</strong></td>
<td>(float) the current lambda value</td>
</tr>
<tr class="row-even"><td><strong>lamb</strong></td>
<td>(float) the previous lambda value</td>
</tr>
<tr class="row-odd"><td><strong>lamf</strong></td>
<td>(float) the next lambda value</td>
</tr>
<tr class="row-even"><td><strong>datastep</strong></td>
<td>(int) the number of steps the averages are calculate over</td>
</tr>
<tr class="row-odd"><td><strong>lambdareplica</strong></td>
<td>(int) the index of the lambda replica</td>
</tr>
<tr class="row-even"><td><strong>temperaturereplica</strong></td>
<td>(int) the index of the temperature replica</td>
</tr>
<tr class="row-odd"><td><strong>global replica</strong></td>
<td>(int) the index of the global replica</td>
</tr>
<tr class="row-even"><td><strong>temperature</strong></td>
<td>(float) the temperature of the simulation</td>
</tr>
<tr class="row-odd"><td><strong>efftemperature</strong></td>
<td>(float) the effective temperature in case of REST</td>
</tr>
<tr class="row-even"><td><strong>ngcsolutes</strong></td>
<td>(int) the number of GC solutes</td>
</tr>
<tr class="row-odd"><td><strong>nthetasolutes</strong></td>
<td>(int) the number of theta solutes</td>
</tr>
<tr class="row-even"><td><strong>bvalue</strong></td>
<td>(float) the Adams value</td>
</tr>
<tr class="row-odd"><td><strong>solventson</strong></td>
<td>(int) the number of GC solutes that are turned on</td>
</tr>
<tr class="row-even"><td><strong>pressure</strong></td>
<td>(float) the pressure</td>
</tr>
<tr class="row-odd"><td><strong>volume</strong></td>
<td>(float) the volume</td>
</tr>
<tr class="row-even"><td><strong>seed</strong></td>
<td>(int) the random seed</td>
</tr>
<tr class="row-odd"><td><strong>backfe</strong></td>
<td>(float) the free energy to the previous lambda</td>
</tr>
<tr class="row-even"><td><strong>forwfe</strong></td>
<td>(float) the free energy to the next lambda</td>
</tr>
<tr class="row-odd"><td><strong>total</strong></td>
<td>(EnergyResults object) the total energy</td>
</tr>
<tr class="row-even"><td><strong>internal_energies</strong></td>
<td>(dictionary of lists of EnergyResults object) the internal energies</td>
</tr>
<tr class="row-odd"><td><strong>interaction_energies</strong></td>
<td>(dictionary of lists of EnergyResults objects) the interaction energies</td>
</tr>
<tr class="row-even"><td><strong>capenergy</strong></td>
<td>(EnergyResults object) the energy of the cap</td>
</tr>
<tr class="row-odd"><td><strong>extraenergy</strong></td>
<td>(EnergyResults object) all extra energies</td>
</tr>
<tr class="row-even"><td><strong>feenergies</strong></td>
<td>(dictionary of float) the total energy at various lambda values</td>
</tr>
<tr class="row-odd"><td><strong>gradient</strong></td>
<td>(float) the numerical gradient of lambda</td>
</tr>
<tr class="row-even"><td><strong>agradient</strong></td>
<td>(float) the analytical gradient of lambda</td>
</tr>
<tr class="row-odd"><td><strong>thetavals</strong></td>
<td>(list of float) the theta values of all GC solutes</td>
</tr>
<tr class="row-even"><td><strong>thetasolvals</strong></td>
<td>(list of float) the theta values of all theta solutes</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.SnapshotResults.parse" title="tools.simulationobjects.SnapshotResults.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(fileobj)</td>
<td>Parse a file for results</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.SnapshotResults.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>fileobj</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.SnapshotResults.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a file for results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fileobj</strong> : file object</p>
<blockquote>
<div><p>the file to read from</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">string :</p>
<blockquote class="last">
<div><p>the line last read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.TemplateAtom">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">TemplateAtom</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a template atom</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>name</strong></td>
<td>(string) the name of the atom</td>
</tr>
<tr class="row-even"><td><strong>residue</strong></td>
<td>(string) the residue of the atom</td>
</tr>
<tr class="row-odd"><td><strong>param0</strong></td>
<td>(int or ForceFieldParameter) the parameter associated with this atom at v0</td>
</tr>
<tr class="row-even"><td><strong>param1</strong></td>
<td>(int or ForceFieldParameter) the parameter associated with this atom at v1</td>
</tr>
<tr class="row-odd"><td><strong>bondedto</strong></td>
<td>(string or TemplateAtom) the atom this atom is bonded to</td>
</tr>
<tr class="row-even"><td><strong>angleto</strong></td>
<td>(string or TemplateAtom) the atom this atom forms an angle with</td>
</tr>
<tr class="row-odd"><td><strong>dihedto</strong></td>
<td>(string or TemplateAtom) the atom this atom forms a dihedral with</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.TemplateAtom.parse" title="tools.simulationobjects.TemplateAtom.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.TemplateAtom.zmat" title="tools.simulationobjects.TemplateAtom.zmat"><code class="xref py py-obj docutils literal"><span class="pre">zmat</span></code></a>()</td>
<td>Produces a simple z-matrix representation of this atom</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.TemplateAtom.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateAtom.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>record</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.TemplateAtom.zmat">
<code class="descname">zmat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateAtom.zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a simple z-matrix representation of this atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">returns</p>
<blockquote class="last">
<div><p>the z-matrix representation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.TemplateConnectivity">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">TemplateConnectivity</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateConnectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a solute bond, angle or dihedral</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>type</strong></td>
<td>(string) the kind of connectivity, i.e. bond, angle or dihedral</td>
</tr>
<tr class="row-even"><td><strong>atoms</strong></td>
<td>(list of strings or TemplateAtom objects) the atoms involved in this connectivity</td>
</tr>
<tr class="row-odd"><td><strong>flex</strong></td>
<td>(float) the flexibility</td>
</tr>
<tr class="row-even"><td><strong>param0</strong></td>
<td>(int or ForceFieldParameter) the parameter associated with this connectivity at v0</td>
</tr>
<tr class="row-odd"><td><strong>param1</strong></td>
<td>(int or ForceFieldParameter) the parameter associated with this connectivity at v1</td>
</tr>
<tr class="row-even"><td><strong>dummy</strong></td>
<td>(bool) flag to indicate if this should be treated as a dummy</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.TemplateConnectivity.parse" title="tools.simulationobjects.TemplateConnectivity.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.TemplateConnectivity.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateConnectivity.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>record</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.TemplateFile">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">TemplateFile</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a ProtoMS template file</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>bondparams</strong></td>
<td>(list of ForceFieldParameter objects) all bond parameters</td>
</tr>
<tr class="row-even"><td><strong>bondatoms</strong></td>
<td>(list of AtomSet objects) all atoms associated with bond parameters</td>
</tr>
<tr class="row-odd"><td><strong>angleparams</strong></td>
<td>(list of ForceFieldParameter objects) all angle parameters</td>
</tr>
<tr class="row-even"><td><strong>angleatoms</strong></td>
<td>(list of AtomSet objects) all atoms associated with angle parameters</td>
</tr>
<tr class="row-odd"><td><strong>dihedralterms</strong></td>
<td>(list of ForceFieldParameter objects) all dihedral term parameters</td>
</tr>
<tr class="row-even"><td><strong>dihedralparams</strong></td>
<td>(list of ForceFieldParameter objects) all dihedral parameters</td>
</tr>
<tr class="row-odd"><td><strong>dihedralatoms</strong></td>
<td>(list of AtomSet objects) all atoms associated with dihedral parameters</td>
</tr>
<tr class="row-even"><td><strong>cljparams</strong></td>
<td>(list of ForceFieldParameter objects) all clj parameters</td>
</tr>
<tr class="row-odd"><td><strong>templates</strong></td>
<td>(list of MolTemplate objects) all templates in this file</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.TemplateFile.append" title="tools.simulationobjects.TemplateFile.append"><code class="xref py py-obj docutils literal"><span class="pre">append</span></code></a>(other)</td>
<td>Adds another template file to this one</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.TemplateFile.assign_paramobj" title="tools.simulationobjects.TemplateFile.assign_paramobj"><code class="xref py py-obj docutils literal"><span class="pre">assign_paramobj</span></code></a>()</td>
<td>Replaces integers and strings with objects</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.TemplateFile.read" title="tools.simulationobjects.TemplateFile.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(filename)</td>
<td>Read a template file from disc</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.TemplateFile.write" title="tools.simulationobjects.TemplateFile.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a>(filename)</td>
<td>Write a template file to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.TemplateFile.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateFile.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds another template file to this one</p>
<p>Will renumber the parameters of the other
file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>other</strong> : TemplateFile</p>
<blockquote class="last">
<div><p>the file to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.TemplateFile.assign_paramobj">
<code class="descname">assign_paramobj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateFile.assign_paramobj" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces integers and strings with objects</p>
<p>It replaces all indices to force field parameters
with references to ForceFieldParameter objects</p>
<p>It replaces all atom in templates with references
to TemplateAtom objects</p>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.TemplateFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a template file from disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the file to read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.TemplateFile.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a template file to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the file to write to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.TemplateSoluteAtom">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">TemplateSoluteAtom</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateSoluteAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.simulationobjects.TemplateAtom" title="tools.simulationobjects.TemplateAtom"><code class="xref py py-class docutils literal"><span class="pre">tools.simulationobjects.TemplateAtom</span></code></a></p>
<p>Class to hold a solute atom</p>
<p>This is a sub-class that implements functions
that are specific for solute templates</p>
<p>Has the same attributes as TemplateAtom</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.TemplateSoluteAtom.parse" title="tools.simulationobjects.TemplateSoluteAtom.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.TemplateSoluteAtom.zmat" title="tools.simulationobjects.TemplateSoluteAtom.zmat"><code class="xref py py-obj docutils literal"><span class="pre">zmat</span></code></a>()</td>
<td>Produces a simple z-matrix representation of this atom</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.TemplateSoluteAtom.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateSoluteAtom.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>record</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.TemplateSoluteAtom.zmat">
<code class="descname">zmat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateSoluteAtom.zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a simple z-matrix representation of this atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">returns</p>
<blockquote class="last">
<div><p>the z-matrix representation, viz. ATOM BONDEDTO ANGLETO DIHEDRALTO</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.angle">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">angle</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the angle between two vectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>v1</strong> : Numpy array</p>
<blockquote>
<div><p>the first vecor</p>
</div></blockquote>
<p><strong>v2</strong> : Numpy array</p>
<blockquote>
<div><p>the second vecor</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>the angle in radians</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.angle_atms">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">angle_atms</code><span class="sig-paren">(</span><em>a1</em>, <em>a2</em>, <em>a3</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.angle_atms" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the angle between three atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a1</strong> : Numpy array</p>
<blockquote>
<div><p>the first atom</p>
</div></blockquote>
<p><strong>a2</strong> : Numpy array</p>
<blockquote>
<div><p>the second atom</p>
</div></blockquote>
<p><strong>a3</strong> : Numpy array</p>
<blockquote>
<div><p>the third atom</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>the angle in radians</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.color">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">color</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.color" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a color of index</p>
<p>For instances when the index is larger than the number of defined colors,
this routine takes care of this by periodicity, i.e.
color at idx=0 is the same color as idx=n</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>idx</strong> : int</p>
<blockquote>
<div><p>the index of the color</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of floats</p>
<blockquote class="last">
<div><p>the color</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.find_box">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">find_box</code><span class="sig-paren">(</span><em>pdbobj</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.find_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse box information from a pdb file</p>
<p>Looks for CENTER, DIMENSIONS and box keywords
in the header of the pdb file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbobj</strong> : PDBFile object</p>
<blockquote>
<div><p>the structure to parse</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dictionary of Numpy arrays</p>
<blockquote class="last">
<div><p>the center, length and origin of the box</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.is_solvent">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">is_solvent</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.is_solvent" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether a given residue name
is a solvent residue name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : string</p>
<blockquote class="last">
<div><p>the residue name</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.merge_pdbs">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">merge_pdbs</code><span class="sig-paren">(</span><em>pdbobjs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.merge_pdbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge pdb files</p>
<p>Create a new PDBFile instance and add all residues and solvents from
all pdb files given, renumbering residues</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbobjs</strong> : list of PDBFile objects</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile object</p>
<blockquote class="last">
<div><p>the newly created and merged pdb structure</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.setup_logger">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">setup_logger</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.setup_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup ProtoMS logging system</p>
<p>Uses the standard logging module with two handlers,
one that prints everything above DEBUG to standard output
and one that prints everything, even DEBUG to a file</p>
<p>If filename is None no file handler is created</p>
<p>This should be called by protoms.py and all other stand-alone
programs that uses the tools</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string, optional</p>
<blockquote>
<div><p>the filename of the string</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a reference to the created logger</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.standard_filename">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">standard_filename</code><span class="sig-paren">(</span><em>filename</em>, <em>folder</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.standard_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the filename of file in the standard ProtoMS file hierarchy</p>
<p>If $PROTOMSHOME is set, it uses it as the base-path, otherwise,
it uses the location of this module as to create the base-path</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote>
<div><p>the name of the file</p>
</div></blockquote>
<p><strong>folder</strong> : string</p>
<blockquote>
<div><p>a folder in the standard ProtoMS file hierarchy</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the full path to the file</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.write_box">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">write_box</code><span class="sig-paren">(</span><em>filename</em>, <em>box</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.write_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a box in PDB file format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote>
<div><p>the name of the file to write</p>
</div></blockquote>
<p><strong>box</strong> : dictionary of Numpy array</p>
<blockquote class="last">
<div><p>the box specification</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.solvate">
<span id="tools-solvate-module"></span><h2>tools.solvate module<a class="headerlink" href="#module-tools.solvate" title="Permalink to this headline">¶</a></h2>
<p>Routines to solvate a structure</p>
<p>This module defines a single public function:
solvate</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.solvate.get_arg_parser">
<code class="descclassname">tools.solvate.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.solvate.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.solvate.solvate">
<code class="descclassname">tools.solvate.</code><code class="descname">solvate</code><span class="sig-paren">(</span><em>box</em>, <em>ligand=None</em>, <em>protein=None</em>, <em>geometry='box'</em>, <em>padding=10.0</em>, <em>radius=30.0</em>, <em>center='cent'</em>, <em>namescheme='ProtoMS'</em>, <em>offset=0.89</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.solvate.solvate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to solvate ligand and/or protein structures using a pre-equilibrated box of waters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>box</strong> : String</p>
<blockquote>
<div><p>String giving the name of a pdb file containing a box of pre-
equilibrated water molecules for solvation</p>
</div></blockquote>
<p><strong>ligand</strong> : PDBFile or string, optional</p>
<blockquote>
<div><p>Either pdb instance for ligand to be solvated, or string giving
the name of a pdb file of the ligand. NOTE - either ligand or protein
or both must be supplied</p>
</div></blockquote>
<p><strong>protein</strong> : PDBFile or string, optional</p>
<blockquote>
<div><p>Either pdb instance for protein to be solvated, or string giving
the name of a pdb file of the protein. NOTE - either ligand or protein
or both must be supplied</p>
</div></blockquote>
<p><strong>geometry</strong> : string, optional</p>
<blockquote>
<div><p>Shape of solvent box, options “box”, “droplet”, “flood”. Default box.
Droplet defines a sphere of radius ‘radius’ around center ‘center’.
Box defines a box that extends at least distance ‘padding’ from solute
Flood defines the equivalent, but waters overlapping with the solute
are not removed</p>
</div></blockquote>
<p><strong>padding</strong> : float, optional</p>
<blockquote>
<div><p>Minimum distance between the solute and the box edge. Default 10.0A</p>
</div></blockquote>
<p><strong>radius</strong> : float, optional</p>
<blockquote>
<div><p>The radius of the added droplet sphere. Default 30.0A</p>
</div></blockquote>
<p><strong>center</strong> : string, optional</p>
<blockquote>
<div><p>Defines the center of the added droplet sphere. Options “cent”,
one, two or three numbers. Default “cent”.
Cent defines the center based on all solute atom coordinates
One number defines coordinates for the center as identical x,y,z
Two numbers defines coordinates for the center over an atom range
Three numbers defines coordinates for the center as separate x,y,z</p>
</div></blockquote>
<p><strong>namescheme</strong> : string, optional</p>
<blockquote>
<div><p>Naming scheme for printout, options “ProtoMS”, “Amber”. Default ProtoMS</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile</p>
<blockquote>
<div><p>the created box of waters, including crystallographic water</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>SetupError</strong></p>
<blockquote class="last">
<div><p>neither protein nor ligand was given, or x-ray waters is not same format as pre-equilibrated box</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.split_jawswater">
<span id="tools-split-jawswater-module"></span><h2>tools.split_jawswater module<a class="headerlink" href="#module-tools.split_jawswater" title="Permalink to this headline">¶</a></h2>
<p>Routine to split JAWS-1 water into PDBs for JAWS-2</p>
<p>This module defines a single public function:
split_water</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.split_jawswater.get_arg_parser">
<code class="descclassname">tools.split_jawswater.</code><code class="descname">get_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.split_jawswater.get_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.split_jawswater.set_jaws2_box">
<code class="descclassname">tools.split_jawswater.</code><code class="descname">set_jaws2_box</code><span class="sig-paren">(</span><em>water_files</em>, <em>length=3</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.split_jawswater.set_jaws2_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the header of the pdbs containing one single
molecule to define a box around the first atom</p>
<dl class="docutils">
<dt>water_files <span class="classifier-delimiter">:</span> <span class="classifier">PDBSet</span></dt>
<dd>a pdb set containing the pdb files with one molecule</dd>
<dt>length <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>the dimensions of the box around the molecule</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tools.split_jawswater.split_waters">
<code class="descclassname">tools.split_jawswater.</code><code class="descname">split_waters</code><span class="sig-paren">(</span><em>waters</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.split_jawswater.split_waters" title="Permalink to this definition">¶</a></dt>
<dd><p>Split waters in a PDB file to many PDB-files for JAWS-2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>waters</strong> : string or PDBFile object</p>
<blockquote>
<div><p>the PDB structure</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBSet</p>
<blockquote>
<div><p>single waters</p>
</div></blockquote>
<p>PDBSet</p>
<blockquote class="last">
<div><p>excluding single waters</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-tools" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Richard Bradshaw, Ana Cabedo Martinez, Chris Cave-Ayland, Samuel Genheden, Gregory Ross.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>