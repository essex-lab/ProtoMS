<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>tools package &mdash; ProtoMS 3.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ProtoMS 3.0 documentation" href="index.html" /> 
  </head>
  <body role="document">

<!--<div style="background-color: white; text-align: center; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci" style="width: 10em"/></a>
</div>-->

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/dolphin.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">tools package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-tools.ambertools">tools.ambertools module</a></li>
<li><a class="reference internal" href="#module-tools.build_template">tools.build_template module</a></li>
<li><a class="reference internal" href="#module-tools.calc_bar">tools.calc_bar module</a></li>
<li><a class="reference internal" href="#module-tools.calc_clusters">tools.calc_clusters module</a></li>
<li><a class="reference internal" href="#module-tools.calc_density">tools.calc_density module</a></li>
<li><a class="reference internal" href="#module-tools.calc_dg">tools.calc_dg module</a></li>
<li><a class="reference internal" href="#module-tools.calc_gcsingle">tools.calc_gcsingle module</a></li>
<li><a class="reference internal" href="#module-tools.calc_replicapath">tools.calc_replicapath module</a></li>
<li><a class="reference internal" href="#module-tools.calc_rmsd">tools.calc_rmsd module</a></li>
<li><a class="reference internal" href="#module-tools.calc_series">tools.calc_series module</a></li>
<li><a class="reference internal" href="#module-tools.calc_ti">tools.calc_ti module</a></li>
<li><a class="reference internal" href="#module-tools.clear_gcmcbox">tools.clear_gcmcbox module</a></li>
<li><a class="reference internal" href="#module-tools.convertatomnames">tools.convertatomnames module</a></li>
<li><a class="reference internal" href="#module-tools.convertwater">tools.convertwater module</a></li>
<li><a class="reference internal" href="#module-tools.distribute_waters">tools.distribute_waters module</a></li>
<li><a class="reference internal" href="#module-tools.divide_pdb">tools.divide_pdb module</a></li>
<li><a class="reference internal" href="#module-tools.generate_input">tools.generate_input module</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#module-tools.make_dummy">tools.make_dummy module</a></li>
<li><a class="reference internal" href="#module-tools.make_gcmcbox">tools.make_gcmcbox module</a></li>
<li><a class="reference internal" href="#module-tools.make_single">tools.make_single module</a></li>
<li><a class="reference internal" href="#module-tools.merge_templates">tools.merge_templates module</a></li>
<li><a class="reference internal" href="#module-tools.pms2pymbar">tools.pms2pymbar module</a></li>
<li><a class="reference internal" href="#module-tools.scoop">tools.scoop module</a></li>
<li><a class="reference internal" href="#module-tools.simulationobjects">tools.simulationobjects module</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#module-tools.solvate">tools.solvate module</a></li>
<li><a class="reference internal" href="#module-tools.split_jawswater">tools.split_jawswater module</a></li>
<li><a class="reference internal" href="#module-tools">Module contents</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tools.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tools-package">
<h1>tools package<a class="headerlink" href="#tools-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-tools.ambertools">
<span id="tools-ambertools-module"></span><h2>tools.ambertools module<a class="headerlink" href="#module-tools.ambertools" title="Permalink to this headline">¶</a></h2>
<p>Routines that wrap AmberTools programs</p>
<p>This module defines two public functions:
run_antechamber
run_parmchk</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.ambertools.get_cmd_args">
<code class="descclassname">tools.ambertools.</code><code class="descname">get_cmd_args</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.ambertools.get_cmd_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.ambertools.run_antechamber">
<code class="descclassname">tools.ambertools.</code><code class="descname">run_antechamber</code><span class="sig-paren">(</span><em>lig</em>, <em>charge</em>, <em>resnam=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.ambertools.run_antechamber" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for antechamber with default parameters and AM1-BCC charges</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lig</strong> : PDBFile or string</p>
<blockquote>
<div><p>the ligand to run Antechamber on</p>
</div></blockquote>
<p><strong>charge</strong> : int</p>
<blockquote>
<div><p>the net charge of the ligand</p>
</div></blockquote>
<p><strong>resnam</strong> : string, optional</p>
<blockquote>
<div><p>the residue name of the ligand</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">string</p>
<blockquote class="last">
<div><p>the filename of the created prepi file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.ambertools.run_parmchk">
<code class="descclassname">tools.ambertools.</code><code class="descname">run_parmchk</code><span class="sig-paren">(</span><em>lig</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.ambertools.run_parmchk" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for parmcheck with default parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lig</strong> : PDBFile or string</p>
<blockquote>
<div><p>the ligand to run Parmcheck on</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">string</p>
<blockquote class="last">
<div><p>the filename of the created frcmod file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.build_template">
<span id="tools-build-template-module"></span><h2>tools.build_template module<a class="headerlink" href="#module-tools.build_template" title="Permalink to this headline">¶</a></h2>
<p>Routines to build a ProtoMS template file</p>
<p>The module defines a two public function
build_template
make_zmat</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="class">
<dt id="tools.build_template.PrepiAtom">
<em class="property">class </em><code class="descclassname">tools.build_template.</code><code class="descname">PrepiAtom</code><a class="headerlink" href="#tools.build_template.PrepiAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to encapsulate an atom in an Amber prepi file
and its connectivity</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>atype</td>
<td>(string) the atom type</td>
</tr>
<tr class="row-even"><td>bondidx</td>
<td>(int) the index of the atom this atom is bonded to in the prepi z-matrix</td>
</tr>
<tr class="row-odd"><td>bonds</td>
<td>(list) names of all atoms this atom is bonded to</td>
</tr>
<tr class="row-even"><td>charge</td>
<td>(float) the charge</td>
</tr>
<tr class="row-odd"><td>index</td>
<td>(int) the serial number in the prepi file</td>
</tr>
<tr class="row-even"><td>is_on_loop</td>
<td>(dictionary) a flag for each atom in bonds indicating if the bond is part of a loop</td>
</tr>
<tr class="row-odd"><td>loop_closure</td>
<td>(dictionary) a flag for each atom in bonds indicating if the bond was part of a loop statement in the prepi file</td>
</tr>
<tr class="row-even"><td>name</td>
<td>(string) the atom name</td>
</tr>
<tr class="row-odd"><td>traversed</td>
<td>(dictionary) a flag for each atom in bonds indicating if the bond has been traversed</td>
</tr>
<tr class="row-even"><td>zmat</td>
<td>(list) atom names of the atoms defined to this atom in the z-matrix</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.add_bond" title="tools.build_template.PrepiAtom.add_bond"><code class="xref py py-obj docutils literal"><span class="pre">add_bond</span></code></a>(atomname[,&nbsp;loop_closure])</td>
<td>Add a bond to this atom</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.backward_bond" title="tools.build_template.PrepiAtom.backward_bond"><code class="xref py py-obj docutils literal"><span class="pre">backward_bond</span></code></a>(exclude,&nbsp;defined)</td>
<td>Find an atom, bonded to this atom that has</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.improper_dihedral" title="tools.build_template.PrepiAtom.improper_dihedral"><code class="xref py py-obj docutils literal"><span class="pre">improper_dihedral</span></code></a>(exclude,&nbsp;defined)</td>
<td>Look for the definition of an improper dihedral:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.next_bond" title="tools.build_template.PrepiAtom.next_bond"><code class="xref py py-obj docutils literal"><span class="pre">next_bond</span></code></a>(defined[,&nbsp;update])</td>
<td>Find an atom, bonded to this atom that</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.read" title="tools.build_template.PrepiAtom.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(record,&nbsp;atomlist)</td>
<td>Read a line from an Amber prepi-file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.build_template.PrepiAtom.sort_bonds" title="tools.build_template.PrepiAtom.sort_bonds"><code class="xref py py-obj docutils literal"><span class="pre">sort_bonds</span></code></a>(metric)</td>
<td>Sort the bonds based on some metric</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.build_template.PrepiAtom.add_bond">
<code class="descname">add_bond</code><span class="sig-paren">(</span><em>atomname</em>, <em>loop_closure=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.add_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a bond to this atom</p>
</dd></dl>

<dl class="method">
<dt id="tools.build_template.PrepiAtom.backward_bond">
<code class="descname">backward_bond</code><span class="sig-paren">(</span><em>exclude</em>, <em>defined</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.backward_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an atom, bonded to this atom that has
already been defined but is not in the list of excluded atoms</p>
</dd></dl>

<dl class="method">
<dt id="tools.build_template.PrepiAtom.improper_dihedral">
<code class="descname">improper_dihedral</code><span class="sig-paren">(</span><em>exclude</em>, <em>defined</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.improper_dihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>Look for the definition of an improper dihedral:
see if at least two bonds to this atom has been defined, 
excluding the bond in the exclude list</p>
</dd></dl>

<dl class="method">
<dt id="tools.build_template.PrepiAtom.next_bond">
<code class="descname">next_bond</code><span class="sig-paren">(</span><em>defined</em>, <em>update=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.next_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an atom, bonded to this atom that 
has not been defined and where the bond has not been traversed</p>
</dd></dl>

<dl class="method">
<dt id="tools.build_template.PrepiAtom.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>record</em>, <em>atomlist</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a line from an Amber prepi-file</p>
</dd></dl>

<dl class="method">
<dt id="tools.build_template.PrepiAtom.sort_bonds">
<code class="descname">sort_bonds</code><span class="sig-paren">(</span><em>metric</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.PrepiAtom.sort_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort the bonds based on some metric</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.build_template.build_template">
<code class="descclassname">tools.build_template.</code><code class="descname">build_template</code><span class="sig-paren">(</span><em>temfile</em>, <em>prepifile</em>, <em>translate=0.25</em>, <em>rotate=5</em>, <em>zmatfile=None</em>, <em>frcmodfile=None</em>, <em>resname='UNK'</em>, <em>alldihs=False</em>, <em>gaffversion='gaff16'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.build_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a ProtoMS template file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>temfile</strong> : string</p>
<blockquote>
<div><p>the filename to save the template file to</p>
</div></blockquote>
<p><strong>prepifile</strong> : string</p>
<blockquote>
<div><p>the filename of the Amber prepi file (prep-file with z-matrix)</p>
</div></blockquote>
<p><strong>translate</strong> : float, optional</p>
<blockquote>
<div><p>the translational displacement</p>
</div></blockquote>
<p><strong>rotate</strong> : float, optional</p>
<blockquote>
<div><p>the rotational displacement</p>
</div></blockquote>
<p><strong>zmatfile</strong> : string, optional</p>
<blockquote>
<div><p>the filename of a zmat, if None it is created</p>
</div></blockquote>
<p><strong>frcmodfile</strong> : string, optional</p>
<blockquote>
<div><p>the filename of an Amber frcmod file with additional parameters</p>
</div></blockquote>
<p><strong>resname</strong> : string, optional</p>
<blockquote>
<div><p>the name of solute</p>
</div></blockquote>
<p><strong>alldihs</strong> : boolean, optional</p>
<blockquote>
<div><p>set True to sample improper dihedrals</p>
</div></blockquote>
<p><strong>gaffversion</strong> : string, optional</p>
<blockquote>
<div><p>the version of GAFF to use</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">TemplateFile</p>
<blockquote class="last">
<div><p>the created template file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.build_template.make_zmat">
<code class="descclassname">tools.build_template.</code><code class="descname">make_zmat</code><span class="sig-paren">(</span><em>prepifile</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.build_template.make_zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a ProtoMS z-matrix for a solute</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>prepifile</strong> : string</p>
<blockquote>
<div><p>the filename of the Amber prepi file (prep-file with z-matrix)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>atoms</strong> : dictionary</p>
<blockquote>
<div><p>created PrepiAtom objects</p>
</div></blockquote>
<p><strong>all_zmat</strong> : list</p>
<blockquote class="last">
<div><p>a list of atoms with their z-matrix atoms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_bar">
<span id="tools-calc-bar-module"></span><h2>tools.calc_bar module<a class="headerlink" href="#module-tools.calc_bar" title="Permalink to this headline">¶</a></h2>
<p>Program to do BAR</p>
<p>This module defines a single public function:
bar</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_bar.bar">
<code class="descclassname">tools.calc_bar.</code><code class="descname">bar</code><span class="sig-paren">(</span><em>path</em>, <em>res_tem</em>, <em>skip</em>, <em>maxread</em>, <em>RT</em>, <em>verbose</em>, <em>nboots=10</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_bar.bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Do Bennet Acceptance Ratio for a set of ProtoMS output files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong> : string</p>
<blockquote>
<div><p>directory where all lambda folders are</p>
</div></blockquote>
<p><strong>res_tem</strong> : string</p>
<blockquote>
<div><p>prefix of result files</p>
</div></blockquote>
<p><strong>skip</strong> : int</p>
<blockquote>
<div><p>number of snapshots to skip</p>
</div></blockquote>
<p><strong>maxread</strong> : int</p>
<blockquote>
<div><p>maximum number of snapshots to read</p>
</div></blockquote>
<p><strong>RT</strong> : float</p>
<blockquote>
<div><p>the thermal temperature</p>
</div></blockquote>
<p><strong>verbose</strong> : dictionary of booleans</p>
<blockquote>
<div><p>tune the output to standard output</p>
</div></blockquote>
<p><strong>nboots</strong> : int, optional</p>
<blockquote>
<div><p>the number of bootstrap samples</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote>
<div><p>the lambda values</p>
</div></blockquote>
<p>numpy array</p>
<blockquote>
<div><p>the free energy for each lambda</p>
</div></blockquote>
<p>numpy array</p>
<blockquote class="last">
<div><p>the standard error of the free energy for each lambda</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_clusters">
<span id="tools-calc-clusters-module"></span><h2>tools.calc_clusters module<a class="headerlink" href="#module-tools.calc_clusters" title="Permalink to this headline">¶</a></h2>
<p>Routines to cluster molecules from simulations.</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_clusters.cluster_coords">
<code class="descclassname">tools.calc_clusters.</code><code class="descname">cluster_coords</code><span class="sig-paren">(</span><em>confs</em>, <em>clustmethod='average'</em>, <em>cutoff=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_clusters.cluster_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Clusters the supplied conformations in a hierarchical fasion</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>conformations</strong> : Numpy array</p>
<blockquote>
<div><p>Array of the coordinates of the different conformations</p>
</div></blockquote>
<p><strong>method</strong> : String</p>
<blockquote>
<div><p>the hierarchical clustering method</p>
</div></blockquote>
<p><strong>cutoff</strong> : Float</p>
<blockquote>
<div><p>the RMSD cutoff that specifies whether conformations are in the same cluster.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumpyArray</p>
<blockquote>
<div><p>the coordinates of the cluster representatives</p>
</div></blockquote>
<p>NumpyArray</p>
<blockquote class="last">
<div><p>the coordinates of the cluster centroids</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_clusters.get_coords">
<code class="descclassname">tools.calc_clusters.</code><code class="descname">get_coords</code><span class="sig-paren">(</span><em>pdbfiles</em>, <em>molname</em>, <em>atomname</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_clusters.get_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the coordinates of a specified molecule name or a named atom from supplied PDB files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbfiles</strong> : PDBSet</p>
<blockquote>
<div><p>the PDB files</p>
</div></blockquote>
<p><strong>residue</strong> : string</p>
<blockquote>
<div><p>the residue to extract</p>
</div></blockquote>
<p><strong>atom</strong> : string</p>
<blockquote>
<div><p>the name of the atom to extract (optional)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumpyArray of coordinates</p>
<blockquote>
<div><p>the x,y,z coordinates of the specified molecule or atom</p>
</div></blockquote>
<p>Integer</p>
<blockquote class="last">
<div><p>the number of molecules or atoms matching the names.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_density">
<span id="tools-calc-density-module"></span><h2>tools.calc_density module<a class="headerlink" href="#module-tools.calc_density" title="Permalink to this headline">¶</a></h2>
<p>Routine to calculate a density from a set of PDB files</p>
<p>This module defines a these public functions:
calc_density
writeDX</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_density.calc_density">
<code class="descclassname">tools.calc_density.</code><code class="descname">calc_density</code><span class="sig-paren">(</span><em>pdbfiles</em>, <em>molname</em>, <em>atomname</em>, <em>padding=2.0</em>, <em>extent=1.0</em>, <em>spacing=0.5</em>, <em>norm=None</em>, <em>smoothing='sphere'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_density.calc_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the density from a set of PDB files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbfiles</strong> : PDBSet</p>
<blockquote>
<div><p>the PDB files</p>
</div></blockquote>
<p><strong>residue</strong> : string</p>
<blockquote>
<div><p>the residue to extract</p>
</div></blockquote>
<p><strong>atom</strong> : string</p>
<blockquote>
<div><p>the name of the atom to make a density from</p>
</div></blockquote>
<p><strong>padding</strong> : float, optional</p>
<blockquote>
<div><p>extra space to add to the minimum extent</p>
</div></blockquote>
<p><strong>extent</strong> : float, optional</p>
<blockquote>
<div><p>the extent of the smoothing</p>
</div></blockquote>
<p><strong>spacing</strong> : float, optional</p>
<blockquote>
<div><p>the spacing of the grid</p>
</div></blockquote>
<p><strong>norm</strong> : int, optional</p>
<blockquote>
<div><p>number to normalize the density by</p>
</div></blockquote>
<p><strong>smoothing</strong> : string, optional</p>
<blockquote>
<div><p>kind of smoothing, can be either sphere or gauss</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumpyArray of integers</p>
<blockquote>
<div><p>the number of atom extracted from each PDB structure</p>
</div></blockquote>
<p>NumpyArray</p>
<blockquote>
<div><p>the 3D density</p>
</div></blockquote>
<p>dictionary</p>
<blockquote class="last">
<div><p>grid properties, keys = spacing, min, and max</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_density.writeDX">
<code class="descclassname">tools.calc_density.</code><code class="descname">writeDX</code><span class="sig-paren">(</span><em>grid</em>, <em>origin</em>, <em>spacing</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_density.writeDX" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the grid to file in DX-format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>grid</strong> : Numpy array</p>
<blockquote>
<div><p>the 3D grid</p>
</div></blockquote>
<p><strong>origin</strong> : NumpyArray</p>
<blockquote>
<div><p>the bottom-left coordinate of the grid</p>
</div></blockquote>
<p><strong>spacing</strong> : float</p>
<blockquote>
<div><p>the grid spacing</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the DX file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_dg">
<span id="tools-calc-dg-module"></span><h2>tools.calc_dg module<a class="headerlink" href="#module-tools.calc_dg" title="Permalink to this headline">¶</a></h2>
<p>Program to calculate free energies using TI, BAR and MBAR</p>
</div>
<div class="section" id="module-tools.calc_gcsingle">
<span id="tools-calc-gcsingle-module"></span><h2>tools.calc_gcsingle module<a class="headerlink" href="#module-tools.calc_gcsingle" title="Permalink to this headline">¶</a></h2>
<p>Program to analyze GCMC simulations</p>
<dl class="function">
<dt id="tools.calc_gcsingle.fit_single">
<code class="descclassname">tools.calc_gcsingle.</code><code class="descname">fit_single</code><span class="sig-paren">(</span><em>B</em>, <em>N</em>, <em>initial</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_gcsingle.fit_single" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.calc_gcsingle.gaussian_smooth">
<code class="descclassname">tools.calc_gcsingle.</code><code class="descname">gaussian_smooth</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>sigma=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_gcsingle.gaussian_smooth" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.calc_gcsingle.logistic_single">
<code class="descclassname">tools.calc_gcsingle.</code><code class="descname">logistic_single</code><span class="sig-paren">(</span><em>B</em>, <em>dF</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_gcsingle.logistic_single" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tools.calc_gcsingle.plot_FitPercentiles">
<code class="descclassname">tools.calc_gcsingle.</code><code class="descname">plot_FitPercentiles</code><span class="sig-paren">(</span><em>B</em>, <em>N</em>, <em>dF_samples</em>, <em>resolution=None</em>, <em>level1=None</em>, <em>level1_colour=None</em>, <em>level2=None</em>, <em>level2_colour=None</em>, <em>median_colour=None</em>, <em>smoothness=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_gcsingle.plot_FitPercentiles" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tools.calc_replicapath">
<span id="tools-calc-replicapath-module"></span><h2>tools.calc_replicapath module<a class="headerlink" href="#module-tools.calc_replicapath" title="Permalink to this headline">¶</a></h2>
<p>Program to analyze and plot replica paths</p>
<p>This module defines the following public functions:
replica_path</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_replicapath.replica_path">
<code class="descclassname">tools.calc_replicapath.</code><code class="descname">replica_path</code><span class="sig-paren">(</span><em>filenames</em>, <em>replicakind='lambda'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_replicapath.replica_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract replica path from a set of results files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filenames</strong> : list of strings</p>
<blockquote>
<div><p>the files to read</p>
</div></blockquote>
<p><strong>replicakind</strong> : string</p>
<blockquote>
<div><p>the type of replica, at the moment only lambda is allowed</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote>
<div><p>the labeled replica path</p>
</div></blockquote>
<p>list</p>
<blockquote class="last">
<div><p>list of the labels for all input files</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_rmsd">
<span id="tools-calc-rmsd-module"></span><h2>tools.calc_rmsd module<a class="headerlink" href="#module-tools.calc_rmsd" title="Permalink to this headline">¶</a></h2>
<p>Routine to calculate the RMSD of the center of a ligand</p>
<p>This module defines a these public functions:
calc_rmsd</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_rmsd.calc_rmsd">
<code class="descclassname">tools.calc_rmsd.</code><code class="descname">calc_rmsd</code><span class="sig-paren">(</span><em>ref</em>, <em>structures</em>, <em>resname</em>, <em>atomname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_rmsd.calc_rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate RMSD of ligand centre or a specific atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ref</strong> : PDBFile object</p>
<blockquote>
<div><p>the reference structure</p>
</div></blockquote>
<p><strong>structures</strong> : PDBSet object</p>
<blockquote>
<div><p>the trajectory to analyze</p>
</div></blockquote>
<p><strong>resname</strong> : string</p>
<blockquote>
<div><p>the residue name of the ligand to analyze</p>
</div></blockquote>
<p><strong>atomname</strong> : string, optional</p>
<blockquote>
<div><p>the atom name to analyze, if not set will analyze geometric centre</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float :</p>
<blockquote class="last">
<div><p>the RMSD in Angstroms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_series">
<span id="tools-calc-series-module"></span><h2>tools.calc_series module<a class="headerlink" href="#module-tools.calc_series" title="Permalink to this headline">¶</a></h2>
<p>Program to analyze and plot data series</p>
<p>This module defines the following public functions:
find_equilibration
stats_inefficiency
maximize_samples
running
moving
parse_series
parse_files
plot_series
write_series</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_series.find_equilibration">
<code class="descclassname">tools.calc_series.</code><code class="descname">find_equilibration</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>atleast=10</em>, <em>threshold=0.05</em>, <em>nperm=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.find_equilibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the equilibration time of a data series</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : Numpy array</p>
<blockquote>
<div><p>the x data</p>
</div></blockquote>
<p><strong>y</strong> : Numpy array</p>
<blockquote>
<div><p>the y data</p>
</div></blockquote>
<p><strong>atleast</strong> : int, optional</p>
<blockquote>
<div><p>this is the smallest number of snapshots considered to be production</p>
</div></blockquote>
<p><strong>threshold</strong> : float, optional</p>
<blockquote>
<div><p>the confidence level</p>
</div></blockquote>
<p><strong>nperm</strong> : int, optional</p>
<blockquote>
<div><p>if greater than zero, a permutation test is peformed with nperm synthetic permuations</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>the length of the equilibration period</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.maximize_samples">
<code class="descclassname">tools.calc_series.</code><code class="descname">maximize_samples</code><span class="sig-paren">(</span><em>y</em>, <em>atleast=10</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.maximize_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the minimum of the statistical inefficiency by varying
the equlibration period, i.e. maximizing the number of 
uncorrelated samples</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>y</strong> : Numpy array</p>
<blockquote>
<div><p>the data</p>
</div></blockquote>
<p><strong>atleast</strong> : int, optional</p>
<blockquote>
<div><p>this is the smallest number of snapshots considered to be production</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote>
<div><p>the snapshot at which g is maximum</p>
</div></blockquote>
<p>float</p>
<blockquote>
<div><p>maximum of g</p>
</div></blockquote>
<p>int</p>
<blockquote class="last">
<div><p>the number of uncorrelated samples</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.moving">
<code class="descclassname">tools.calc_series.</code><code class="descname">moving</code><span class="sig-paren">(</span><em>data</em>, <em>window</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.moving" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a moving/rolling average of the data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : NumpyArray</p>
<blockquote>
<div><p>the input data, should be 1D</p>
</div></blockquote>
<p><strong>window</strong> : int</p>
<blockquote>
<div><p>the window size</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumpyArray</p>
<blockquote class="last">
<div><p>the averaged data</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.parse_files">
<code class="descclassname">tools.calc_series.</code><code class="descname">parse_files</code><span class="sig-paren">(</span><em>filenames</em>, <em>series</em>, <em>all_results</em>, <em>ys</em>, <em>labels</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.parse_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse multiple results file</p>
<p>If a data serie in series can be calculated over multiple
input files, the data serie is replaced by some calculation 
over all input files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filenames</strong> : list of strings</p>
<blockquote>
<div><p>the files to parse</p>
</div></blockquote>
<p><strong>series</strong> : list of strings</p>
<blockquote>
<div><p>the series selected</p>
</div></blockquote>
<p><strong>all_results</strong> : list of SnapshotResults</p>
<blockquote>
<div><p>all the results loaded from all input files, needs to be initialized before calling this routine</p>
</div></blockquote>
<p><strong>ys</strong> : list of NumpyArrays</p>
<blockquote>
<div><p>all the series</p>
</div></blockquote>
<p><strong>labels</strong> : list of strings</p>
<blockquote>
<div><p>labels for all the data series</p>
</div></blockquote>
<p><strong>**kwargs</strong> : dictionary</p>
<blockquote>
<div><p>additional parameters, passed directly to the different parsers</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">bool</p>
<blockquote class="last">
<div><p>whether the series has been modified, i.e. if any parser was found</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.parse_series">
<code class="descclassname">tools.calc_series.</code><code class="descname">parse_series</code><span class="sig-paren">(</span><em>series</em>, <em>results</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.parse_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract data series and label from a results file based on a label</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>series</strong> : list of string</p>
<blockquote>
<div><p>the series to extract</p>
</div></blockquote>
<p><strong>results</strong> : SnapshotResults object</p>
<blockquote>
<div><p>all the results</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of NumpyArrays</p>
<blockquote>
<div><p>the data series</p>
</div></blockquote>
<p>list of string</p>
<blockquote class="last">
<div><p>the labels for the series</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.plot_series">
<code class="descclassname">tools.calc_series.</code><code class="descname">plot_series</code><span class="sig-paren">(</span><em>ys</em>, <em>yprop</em>, <em>labels</em>, <em>offset</em>, <em>plotkind</em>, <em>outprefix</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.plot_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a series</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ys</strong> : list of Numpy arrays</p>
<blockquote>
<div><p>the data series</p>
</div></blockquote>
<p><strong>yprop</strong> : list of dictionary</p>
<blockquote>
<div><p>statistical properties of the data</p>
</div></blockquote>
<p><strong>labels</strong> : list of strings</p>
<blockquote>
<div><p>the labels for the data series</p>
</div></blockquote>
<p><strong>offset</strong> : int</p>
<blockquote>
<div><p>the offset of x from 1</p>
</div></blockquote>
<p><strong>plotkind</strong> : string</p>
<blockquote>
<div><p>the type of plot to create, can be either sep, sub, single, single_first0 or single_last0</p>
</div></blockquote>
<p><strong>outprefix</strong> : string</p>
<blockquote class="last">
<div><p>the prefix of the created png-files</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.running">
<code class="descclassname">tools.calc_series.</code><code class="descname">running</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.running" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a running average of the data</p>
<p>Value at position i of the returned data is the average of the input data from point zero to point i</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : NumpyArray</p>
<blockquote>
<div><p>the input data, should be 1D</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumpyArray</p>
<blockquote class="last">
<div><p>the averaged data</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.stat_inefficiency">
<code class="descclassname">tools.calc_series.</code><code class="descname">stat_inefficiency</code><span class="sig-paren">(</span><em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.stat_inefficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the statistical inefficiency, g.</p>
<p>g = 1 + 2*tau, where tau is the autocorrelation time</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>y</strong> : Numpy array</p>
<blockquote>
<div><p>the data</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>g, the inefficiency
or None if variance is too small</p>
</div></blockquote>
<p>float</p>
<blockquote class="last">
<div><p>neff, the number of samples 
or None if variance is too small</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_series.write_series">
<code class="descclassname">tools.calc_series.</code><code class="descname">write_series</code><span class="sig-paren">(</span><em>ys</em>, <em>yprop</em>, <em>labels</em>, <em>offset</em>, <em>filekind</em>, <em>outprefix</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_series.write_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a series to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ys</strong> : list of Numpy arrays</p>
<blockquote>
<div><p>the data series</p>
</div></blockquote>
<p><strong>yprop</strong> : list of dictionary</p>
<blockquote>
<div><p>statistical properties of the data</p>
</div></blockquote>
<p><strong>labels</strong> : list of strings</p>
<blockquote>
<div><p>the labels for the data series</p>
</div></blockquote>
<p><strong>offset</strong> : int</p>
<blockquote>
<div><p>the offset of x from 1</p>
</div></blockquote>
<p><strong>filekind</strong> : string</p>
<blockquote>
<div><p>the type of file to write, can be either sep or single</p>
</div></blockquote>
<p><strong>outprefix</strong> : string</p>
<blockquote class="last">
<div><p>the prefix of the created files</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.calc_ti">
<span id="tools-calc-ti-module"></span><h2>tools.calc_ti module<a class="headerlink" href="#module-tools.calc_ti" title="Permalink to this headline">¶</a></h2>
<p>Program to do thermodynamic integration</p>
<p>This module defines a single public function:
ti</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.calc_ti.fit_pmf">
<code class="descclassname">tools.calc_ti.</code><code class="descname">fit_pmf</code><span class="sig-paren">(</span><em>lambdas</em>, <em>pmf</em>, <em>orderfit=4</em>, <em>upperfit=5</em>, <em>plotfile='fit.png'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti.fit_pmf" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the PMF to a polynomial function
Parameters
&#8212;&#8212;&#8212;-
lambdas : list</p>
<blockquote>
<div>list of lambda values</div></blockquote>
<dl class="docutils">
<dt>pmf <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>list of pmf values for each lambda</dd>
<dt>orderfit <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>the order of the polynomial to fit your pmf to</dd>
<dt>upperfit <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>the maximum order of the polynomial to fit to</dd>
<dt>plotfile <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd>the name of the file where to plot of the fit</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the coefictients of the fit</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_ti.print_ene">
<code class="descclassname">tools.calc_ti.</code><code class="descname">print_ene</code><span class="sig-paren">(</span><em>lam</em>, <em>ene</em>, <em>std</em>, <em>print_uncert</em>, <em>print_lam</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti.print_ene" title="Permalink to this definition">¶</a></dt>
<dd><p>Print energy row to standard output</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lam</strong> : float</p>
<blockquote>
<div><p>the lambda value</p>
</div></blockquote>
<p><strong>ene</strong> : float</p>
<blockquote>
<div><p>the energy value</p>
</div></blockquote>
<p><strong>std</strong> : float</p>
<blockquote>
<div><p>the uncertainty</p>
</div></blockquote>
<p><strong>print_uncert</strong> : boolean</p>
<blockquote>
<div><p>if to print the uncertainty</p>
</div></blockquote>
<p><strong>print_lam</strong> : boolean</p>
<blockquote class="last">
<div><p>if to print the lambda value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_ti.print_head">
<code class="descclassname">tools.calc_ti.</code><code class="descname">print_head</code><span class="sig-paren">(</span><em>lam</em>, <em>ene</em>, <em>std</em>, <em>print_uncert</em>, <em>print_lam</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti.print_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Print energy header to standard output</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lam</strong> : string</p>
<blockquote>
<div><p>the header of the lambda value</p>
</div></blockquote>
<p><strong>ene</strong> : string</p>
<blockquote>
<div><p>the header of the energy value</p>
</div></blockquote>
<p><strong>std</strong> : string</p>
<blockquote>
<div><p>the header of the uncertainty</p>
</div></blockquote>
<p><strong>print_uncert</strong> : boolean</p>
<blockquote>
<div><p>if to print the uncertainty</p>
</div></blockquote>
<p><strong>print_lam</strong> : boolean</p>
<blockquote class="last">
<div><p>if to print the lambda value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.calc_ti.ti">
<code class="descclassname">tools.calc_ti.</code><code class="descname">ti</code><span class="sig-paren">(</span><em>path</em>, <em>res_tem</em>, <em>skip</em>, <em>maxread</em>, <em>verbose</em>, <em>numkind</em>, <em>useanalytical</em>, <em>subd=''</em>, <em>auto=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.calc_ti.ti" title="Permalink to this definition">¶</a></dt>
<dd><p>Do thermodynamic integration</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong> : string</p>
<blockquote>
<div><p>directory where all lambda folders are</p>
</div></blockquote>
<p><strong>res_tem</strong> : string</p>
<blockquote>
<div><p>result files</p>
</div></blockquote>
<p><strong>skip</strong> :  int</p>
<blockquote>
<div><p>number of snapshots to skip</p>
</div></blockquote>
<p><strong>maxread</strong> : int</p>
<blockquote>
<div><p>maximum number of snapshots to read</p>
</div></blockquote>
<p><strong>verbose</strong> : dictionary of booleans</p>
<blockquote>
<div><p>tune the printing to standard output</p>
</div></blockquote>
<p><strong>numkind</strong> : string</p>
<blockquote>
<div><p>the kind of numerical gradient, should be either both, forw, or back</p>
</div></blockquote>
<p><strong>useanalytical</strong> : boolean</p>
<blockquote>
<div><p>if to use analytical gradients</p>
</div></blockquote>
<p><strong>subd</strong> : string</p>
<blockquote>
<div><p>optional subdirectory to check for each lambda value</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote>
<div><p>all lambda values</p>
</div></blockquote>
<p>numpy array</p>
<blockquote>
<div><p>gradient for each lambda value</p>
</div></blockquote>
<p>numpy array</p>
<blockquote>
<div><p>standard deviation of the gradient for each lambda value</p>
</div></blockquote>
<p>numpy array</p>
<blockquote>
<div><p>pmf at each lambda value</p>
</div></blockquote>
<p>numpy array</p>
<blockquote class="last">
<div><p>standard deviation of the pmf at each lambda value</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.clear_gcmcbox">
<span id="tools-clear-gcmcbox-module"></span><h2>tools.clear_gcmcbox module<a class="headerlink" href="#module-tools.clear_gcmcbox" title="Permalink to this headline">¶</a></h2>
<p>Routine to remove solvent molecules from a GCMC/JAWS-1 simulation box</p>
<p>This module defines a single public function:
clear_gcmcbox</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.clear_gcmcbox.clear_gcmcbox">
<code class="descclassname">tools.clear_gcmcbox.</code><code class="descname">clear_gcmcbox</code><span class="sig-paren">(</span><em>gcmcbox</em>, <em>waters</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.clear_gcmcbox.clear_gcmcbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes solvent molecules from the GCMC/JAWS-1 box as they will not be 
able to move during the simulation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>gcmcbox</strong> : string or PDBFile object</p>
<blockquote>
<div><p>the gcmcbox</p>
</div></blockquote>
<p><strong>waters</strong> : string or PDBFile object</p>
<blockquote>
<div><p>the water molecule to check</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote>
<div><p>the number of removed water molecules</p>
</div></blockquote>
<p>PDBFile</p>
<blockquote class="last">
<div><p>the cleared solvation box</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.convertatomnames">
<span id="tools-convertatomnames-module"></span><h2>tools.convertatomnames module<a class="headerlink" href="#module-tools.convertatomnames" title="Permalink to this headline">¶</a></h2>
<p>Routines to convert atom names in a PDB-file</p>
<p>This module defines two public functions:
read_convfile
pdb2pms</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.convertatomnames.pdb2pms">
<code class="descclassname">tools.convertatomnames.</code><code class="descname">pdb2pms</code><span class="sig-paren">(</span><em>pdb_in</em>, <em>forcefield</em>, <em>conversion_file</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertatomnames.pdb2pms" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atom names to ProtoMS standard</p>
<p>The protein object is not modified by this routine, but the Residue and Atom objects are.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdb_in</strong> : PDBFile</p>
<blockquote>
<div><p>the pdb file to modify inline</p>
</div></blockquote>
<p><strong>forcefield</strong> : string</p>
<blockquote>
<div><p>the style of the input PDB-file</p>
</div></blockquote>
<p><strong>conversion_file :</strong></p>
<blockquote>
<div><p>a file with conversion rules</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a PDBFile instance with ProtoMS names</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertatomnames.read_convfile">
<code class="descclassname">tools.convertatomnames.</code><code class="descname">read_convfile</code><span class="sig-paren">(</span><em>file=None</em>, <em>inmode=None</em>, <em>outmode=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertatomnames.read_convfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a conversion file into a dictionary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>file</strong> : string</p>
<blockquote>
<div><p>the filename of the conversion file</p>
</div></blockquote>
<p><strong>inmode</strong> : string</p>
<blockquote>
<div><p>the style of the input PDB-file</p>
</div></blockquote>
<p><strong>outmode</strong> : string</p>
<blockquote>
<div><p>the style of the output PDB-file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a dictionary of the conversion</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>if any of the parameters are none</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.convertwater">
<span id="tools-convertwater-module"></span><h2>tools.convertwater module<a class="headerlink" href="#module-tools.convertwater" title="Permalink to this headline">¶</a></h2>
<p>Routines to convert water molecules to water models from a PDB file.</p>
<p>This module defines a single public function
convertwater</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.convertwater.alignhydrogens">
<code class="descclassname">tools.convertwater.</code><code class="descname">alignhydrogens</code><span class="sig-paren">(</span><em>watcoords</em>, <em>template</em>, <em>tol=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.alignhydrogens" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a template water molecule such that it has the same orientation as a reference water molecule. Useful for converting between different water models in cases when one wishes to retain the same orientations of hydrogens. It assumes that both the template and the reference water have maching oxygen locations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>watcoords</strong> : numpy array</p>
<blockquote>
<div><p>the coordinates of the water molecule that will be aligned to. The first row must be the x,y,z coordinates of the oxygen atom. Hydrogens must be present in the proceeding two rows</p>
</div></blockquote>
<p><strong>template</strong> : numpy array</p>
<blockquote>
<div><p>the template water molecule whose hydrogens will be aligned to match that of watcoords. Does not have to be same water model (e.g. tip4p versus spc) as watcoords.</p>
</div></blockquote>
<p><strong>tol</strong> : float</p>
<blockquote>
<div><p>the tolerance level for the BFGS solver. At a tolerance level of 0.1, orientating 1000 water molecules takes about 10s. With a lower tolerance, alignment is more accurate, but can take up to 17s per 1000 waters.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotated set of water coordinates.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.convertwater">
<code class="descclassname">tools.convertwater.</code><code class="descname">convertwater</code><span class="sig-paren">(</span><em>pdb_in</em>, <em>watermodel</em>, <em>ignorH=False</em>, <em>watresname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.convertwater" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts water in a pdb object to ideal water geometries of an input model</p>
<p>The protein object is not modified by this routine, but the Residue and Atom objects are.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdb_in</strong> : PDBFile</p>
<blockquote>
<div><p>the PDB object containing the water molecules that will be converted</p>
</div></blockquote>
<p><strong>watermodel</strong> : string</p>
<blockquote>
<div><p>the name of the water model that will be used in the transformtation, e.g. tip4p, t3p.</p>
</div></blockquote>
<p><strong>ignorH</strong> : bool</p>
<blockquote>
<div><p>whether to ignore hydrogens in the input water.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile</p>
<blockquote class="last">
<div><p>a pdb file whose solvent elements have the geometry of the desired solvent model</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.rotatesolute">
<code class="descclassname">tools.convertwater.</code><code class="descname">rotatesolute</code><span class="sig-paren">(</span><em>solutecoords</em>, <em>alpha</em>, <em>beta</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.rotatesolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a molecule about the centre of geometry (the mean of x,y,z of each atom in the molecule).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>solutecoords</strong> : numpy array</p>
<blockquote>
<div><p>the coordinates of the molecule.</p>
</div></blockquote>
<p><strong>alpha</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the x-axis.</p>
</div></blockquote>
<p><strong>beta</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the y-axis.</p>
</div></blockquote>
<p><strong>gamma</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the z-axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotated set of molecule coordinates.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.rotatewat">
<code class="descclassname">tools.convertwater.</code><code class="descname">rotatewat</code><span class="sig-paren">(</span><em>watcoords</em>, <em>alpha</em>, <em>beta</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.rotatewat" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a water molecule about the oxygen atom, which is assumed to be the first element in the coordinate array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>watcoords</strong> : numpy array</p>
<blockquote>
<div><p>the coordinates of the water molecule. The first row must be the x,y,z coordinates of the oxygen atom. Hydrogens must be present in the proceeding two rows</p>
</div></blockquote>
<p><strong>alpha</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the x-axis.</p>
</div></blockquote>
<p><strong>beta</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the y-axis.</p>
</div></blockquote>
<p><strong>gamma</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the z-axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotated set of water coordinates.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.rotmat_x">
<code class="descclassname">tools.convertwater.</code><code class="descname">rotmat_x</code><span class="sig-paren">(</span><em>alpha</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.rotmat_x" title="Permalink to this definition">¶</a></dt>
<dd><p>3D rotation matrix for rotations about x-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>alpha</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the x-axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotation matrix for the desired angle.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.rotmat_y">
<code class="descclassname">tools.convertwater.</code><code class="descname">rotmat_y</code><span class="sig-paren">(</span><em>beta</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.rotmat_y" title="Permalink to this definition">¶</a></dt>
<dd><p>3D rotation matrix for rotations about x-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>beta</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the y-axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotation matrix for the desired angle.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.convertwater.rotmat_z">
<code class="descclassname">tools.convertwater.</code><code class="descname">rotmat_z</code><span class="sig-paren">(</span><em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.convertwater.rotmat_z" title="Permalink to this definition">¶</a></dt>
<dd><p>3D rotation matrix for rotations about x-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>gamma</strong> : float or integer</p>
<blockquote>
<div><p>the angle (in radians) by which rotation is performed about the z-axis.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote class="last">
<div><p>the rotation matrix for the desired angle.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.distribute_waters">
<span id="tools-distribute-waters-module"></span><h2>tools.distribute_waters module<a class="headerlink" href="#module-tools.distribute_waters" title="Permalink to this headline">¶</a></h2>
<p>Program to generate a set of n molecules contained within given box dimenstions
or to redistribute molecules given in a pdb object or file within the given box dimensions</p>
<p>This program takes the box dimensions as a list of strings convertible to floats,
in the following order :</p>
<blockquote>
<div>origin in x | origin in y | origin in z | length in x | length in y | length in z</div></blockquote>
<p>And either the number of molecules as a string convertible to integer,
or the pdb, which can be provided as a string with the name of the file, or an object.</p>
<p>It produces a pdb file with the randomly distributed molecules with their oxygen atoms
within the box limits.</p>
<p>Initially thought to generate JAWS or GCMC molecules</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.distribute_waters.create_res">
<code class="descclassname">tools.distribute_waters.</code><code class="descname">create_res</code><span class="sig-paren">(</span><em>atnames=['O00'], resname='sol', positions=[array([ 0.,  0.,  0.])], resind=1</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.distribute_waters.create_res" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a residue object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atnames</strong> : list of strings</p>
<blockquote>
<div><p>a list containing the names of all
the atoms in the residue</p>
</div></blockquote>
<p><strong>resname</strong> : string</p>
<blockquote>
<div><p>the name of the residue</p>
</div></blockquote>
<p><strong>positions</strong> : list of numpy arrays</p>
<blockquote>
<div><p>a list with the positions of all
the atoms in the residue</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Residue object</p>
<blockquote class="last">
<div><p>the residue built with the given atoms</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.distribute_waters.distribute_particles">
<code class="descclassname">tools.distribute_waters.</code><code class="descname">distribute_particles</code><span class="sig-paren">(</span><em>box</em>, <em>particles</em>, <em>watermodel='t4p'</em>, <em>resname='WA1'</em>, <em>partnumb=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.distribute_waters.distribute_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly distribute molecules in a box</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>box</strong> : a list or dictionary</p>
<blockquote>
<div><p>the origin and length of the box
where the molecules will be placed</p>
</div></blockquote>
<p><strong>particles</strong> : string or PDB object</p>
<blockquote>
<div><p>the number of waters to include in the box
or the pdb object or filename with the molecules
to include in the box</p>
</div></blockquote>
<p><strong>watermodel</strong> : string, optional</p>
<blockquote>
<div><p>(only used when particles is a number)
for instance, &#8220;t4p&#8221;, &#8220;tip4p&#8221;, &#8220;t3p&#8221; &#8220;tip3p&#8221;,
the water model for the generated waters</p>
</div></blockquote>
<p><strong>partnumb</strong> : string,optional</p>
<blockquote>
<div><p>(only used when particles is a file)
the number of particles. If not specified it is set
to be as many as there are in the file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">pdb object</p>
<blockquote class="last">
<div><p>the pdb object with the molecules
distributed randomly in the box</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.divide_pdb">
<span id="tools-divide-pdb-module"></span><h2>tools.divide_pdb module<a class="headerlink" href="#module-tools.divide_pdb" title="Permalink to this headline">¶</a></h2>
<p>Program to split a multi pdb file into individual files</p>
<p>This program divides a multi pdb file in individual files.
The individual pdbs must be separated by a line starting with END.</p>
<p>Initially thought to divide the multi-snapshot pdb file produced as ProtoMS output
into individual snapshot pdb files.
Required for an easy visualization of GCMC and JAWS stage 1 results.</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.divide_pdb.divide_print">
<code class="descclassname">tools.divide_pdb.</code><code class="descname">divide_print</code><span class="sig-paren">(</span><em>common</em>, <em>prefix</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.divide_pdb.divide_print" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide a pdb file in individual pdbfiles.
Division is controled by lines starting with END</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>common</strong> : string</p>
<blockquote>
<div><p>the name of the initial pdb file</p>
</div></blockquote>
<p><strong>prefix</strong> : string</p>
<blockquote class="last">
<div><p>the prefix for output pdb files</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.generate_input">
<span id="tools-generate-input-module"></span><h2>tools.generate_input module<a class="headerlink" href="#module-tools.generate_input" title="Permalink to this headline">¶</a></h2>
<p>Classes and routines to make ProtoMS command files</p>
<p>This module defines a single public function
generate_input</p>
<p>and the following public classes:
ProtoMSSimulation
ProteinLigandSimulation
Equilibration
Sampling
DualTopology</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="class">
<dt id="tools.generate_input.DualTopology">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">DualTopology</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb', 'solute2.pdb'], solvent='water.pdb', templates=['solute1.tem', 'solute2.tem'], nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, ranseed=None, lambdaval=None, outfolder='out', restrained=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.DualTopology" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a dual-topology protein-ligand simulation
Generates input for proteins, solutes and solvent
write dual-toplogy parameters, lambda-replica exchange,
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to &#8216;chunk&#8217;.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.Equilibration">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">Equilibration</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute.pdb'], solvent='water.pdb', templates=['solute.tem'], outfolder='', ranseed=None, nsteps=100000.0, pdbfile='equilibrated.pdb'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.Equilibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for equilibration of a protein-ligand system
Generates input for proteins, solutes and solvent and write an equilibration and a pdb chunk</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to &#8216;chunk&#8217;.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.GCMC">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">GCMC</code><span class="sig-paren">(</span><em>protein='protein.pdb'</em>, <em>solutes=[]</em>, <em>solvent='water.pdb'</em>, <em>templates=[]</em>, <em>gcmcwater='gcmc_water.pdb'</em>, <em>gcmcbox=None</em>, <em>nequil=5000000.0</em>, <em>nprod=40000000.0</em>, <em>dumpfreq=100000.0</em>, <em>adamval=None</em>, <em>ranseed=None</em>, <em>watmodel='tip4p'</em>, <em>outfolder='out_gcmc'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.GCMC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a GCMC simulation
Generates input for proteins, solutes and solvent
write GCMC parameters
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to &#8216;chunk&#8217;.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.Jaws1">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">Jaws1</code><span class="sig-paren">(</span><em>protein='protein.pdb'</em>, <em>solutes=[]</em>, <em>solvent='water.pdb'</em>, <em>templates=[]</em>, <em>outfolder=''</em>, <em>ranseed=None</em>, <em>jawswater='jaws_water.pdb'</em>, <em>jawsbox=None</em>, <em>nequil=5000000.0</em>, <em>nprod=40000000.0</em>, <em>watmodel='tip4p'</em>, <em>dumpfreq=100000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.Jaws1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a JAWS-1 simulation
Generates input for proteins, solutes and solvent
write JAWS-1 parameters
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to &#8216;chunk&#8217;.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.Jaws2">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">Jaws2</code><span class="sig-paren">(</span><em>protein='protein.pdb'</em>, <em>solutes=[]</em>, <em>solvent='water.pdb'</em>, <em>templates=[]</em>, <em>outfolder=''</em>, <em>ranseed=None</em>, <em>jawswater='jaws_water.pdb'</em>, <em>jbias=6.5</em>, <em>nequil=5000000.0</em>, <em>nprod=40000000.0</em>, <em>watmodel='tip4p'</em>, <em>dumpfreq=100000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.Jaws2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a JAWS-2 simulation
Generates input for proteins, solutes and solvent
write JAWS-2 parameters
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to &#8216;chunk&#8217;.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.ProteinLigandSimulation">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">ProteinLigandSimulation</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute.pdb'], solvent='water.pdb', templates=['solute.tem'], outfolder=None, ranseed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProteinLigandSimulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProtoMSSimulation" title="tools.generate_input.ProtoMSSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProtoMSSimulation</span></code></a></p>
<p>This a generic command file for a protein-ligand simulation
Generates input for proteins, solutes and solvent but does not write any chunks</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to &#8216;chunk&#8217;.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.ProtoMSSimulation">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">ProtoMSSimulation</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a ProtoMS command file object.This object holds all of the information
about the simulation and can either run the simulation with this
information, or can write this information to a command file.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>lines :</td>
<td>list of strings all the lines of the ProtoMS command file</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.clear" title="tools.generate_input.ProtoMSSimulation.clear"><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code></a>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.readCommandFile" title="tools.generate_input.ProtoMSSimulation.readCommandFile"><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code></a>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.run" title="tools.generate_input.ProtoMSSimulation.run"><code class="xref py py-obj docutils literal"><span class="pre">run</span></code></a>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setChunk" title="tools.generate_input.ProtoMSSimulation.setChunk"><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code></a>(chunk)</td>
<td>This adds the simulation chunk to &#8216;chunk&#8217;.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setDump" title="tools.generate_input.ProtoMSSimulation.setDump"><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code></a>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setForceField" title="tools.generate_input.ProtoMSSimulation.setForceField"><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code></a>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setParameter" title="tools.generate_input.ProtoMSSimulation.setParameter"><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code></a>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setProtein" title="tools.generate_input.ProtoMSSimulation.setProtein"><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code></a>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setSolute" title="tools.generate_input.ProtoMSSimulation.setSolute"><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code></a>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setSolvent" title="tools.generate_input.ProtoMSSimulation.setSolvent"><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code></a>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.setStream" title="tools.generate_input.ProtoMSSimulation.setStream"><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code></a>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.generate_input.ProtoMSSimulation.writeCommandFile" title="tools.generate_input.ProtoMSSimulation.writeCommandFile"><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code></a>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the simulation description</p>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.readCommandFile">
<code class="descname">readCommandFile</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.readCommandFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a simulation from a command file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the filename of the command file to read from disc</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>exe</em>, <em>cmdfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run this simulation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>exe</strong> : string</p>
<blockquote>
<div><p>the filename of the executable</p>
</div></blockquote>
<p><strong>cmdfile</strong> : string, optional</p>
<blockquote class="last">
<div><p>the filename of the command file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setChunk">
<code class="descname">setChunk</code><span class="sig-paren">(</span><em>chunk</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setChunk" title="Permalink to this definition">¶</a></dt>
<dd><p>This adds the simulation chunk to &#8216;chunk&#8217;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chunk</strong> : string</p>
<blockquote class="last">
<div><p>the chunk to be executed, including parameters</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setDump">
<code class="descname">setDump</code><span class="sig-paren">(</span><em>dump</em>, <em>freq</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setDump" title="Permalink to this definition">¶</a></dt>
<dd><p>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dump</strong> : string</p>
<blockquote>
<div><p>the dump to be executed, including parameters</p>
</div></blockquote>
<p><strong>freq</strong> : int</p>
<blockquote class="last">
<div><p>the dump frequency</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setForceField">
<code class="descname">setForceField</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setForceField" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for parfile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the filename of the force field file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setParameter">
<code class="descname">setParameter</code><span class="sig-paren">(</span><em>parameter</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameter to value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>parameter</strong> : string</p>
<blockquote>
<div><p>the name of the parameter</p>
</div></blockquote>
<p><strong>value</strong> : string</p>
<blockquote class="last">
<div><p>the value of the parameter</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setProtein">
<code class="descname">setProtein</code><span class="sig-paren">(</span><em>n</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setProtein" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for proteinN. It then returns n+1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n</strong> : int</p>
<blockquote>
<div><p>the protein serial number</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote>
<div><p>the filename of the protein pdb file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>n + 1</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setSolute">
<code class="descname">setSolute</code><span class="sig-paren">(</span><em>n</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setSolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for soluteN. It then returns n+1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n</strong> : int</p>
<blockquote>
<div><p>the solute serial number</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote>
<div><p>the filename of the solute pdb file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>n + 1</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setSolvent">
<code class="descname">setSolvent</code><span class="sig-paren">(</span><em>n</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setSolvent" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for solventN. It then returns n+1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n</strong> : int</p>
<blockquote>
<div><p>the solvent serial number</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote>
<div><p>the filename of the solvent pdb file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int</p>
<blockquote class="last">
<div><p>n + 1</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.setStream">
<code class="descname">setStream</code><span class="sig-paren">(</span><em>stream</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.setStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the direction of the output stream to a filename</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stream</strong> : string</p>
<blockquote>
<div><p>the name of the stream</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the filename to direct the stream to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.generate_input.ProtoMSSimulation.writeCommandFile">
<code class="descname">writeCommandFile</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.ProtoMSSimulation.writeCommandFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the contents of this simulation object to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the filename to write the commands to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.generate_input.RestraintRelease">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">RestraintRelease</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb'], solvent='water.pdb', templates=['solute.tem'], nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, lambdaval=None, ranseed=None, outfolder='out', restrained=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.RestraintRelease" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>Command file to calculate the free energy of introducing a harmonic restraint
during the bound leg of a simulation.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to &#8216;chunk&#8217;.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.Sampling">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">Sampling</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute.pdb'], solvent='water.pdb', templates=['solute.tem'], outfolder='', ranseed=None, nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, outprefix='', tune=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.Sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for MC sampling of a protein-ligand system
Generates input for proteins, solutes and solvent and write 
chunks for equilibration and simulation, as well as dumps</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to &#8216;chunk&#8217;.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.generate_input.SingleTopology">
<em class="property">class </em><code class="descclassname">tools.generate_input.</code><code class="descname">SingleTopology</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb'], solvent='water.pdb', templates=['solute.tem'], nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, lambdaval=None, ranseed=None, outfolder='out', restrained=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.SingleTopology" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.generate_input.ProteinLigandSimulation" title="tools.generate_input.ProteinLigandSimulation"><code class="xref py py-class docutils literal"><span class="pre">tools.generate_input.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a single-topology protein-ligand simulation
Generates input for proteins, solutes and solvent
write lambda-replica exchange,
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to &#8216;chunk&#8217;.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to &#8216;dump&#8217; with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.generate_input.generate_input">
<code class="descclassname">tools.generate_input.</code><code class="descname">generate_input</code><span class="sig-paren">(</span><em>protein</em>, <em>ligands</em>, <em>templates</em>, <em>protein_water</em>, <em>ligand_water</em>, <em>ranseed</em>, <em>settings</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.generate_input.generate_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates ProtoMS command files</p>
<p>If protein is a valid filename a protein(-ligand) simulation is setup, and if
ligands contains at least one valid filename a ligand simulation is setup.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>protein</strong> : string</p>
<blockquote>
<div><p>the filename of a protein pdb file</p>
</div></blockquote>
<p><strong>ligands</strong> : list of strings</p>
<blockquote>
<div><p>filenames of solute pdb files</p>
</div></blockquote>
<p><strong>templates</strong> : list of strings</p>
<blockquote>
<div><p>filenames of template files to be included</p>
</div></blockquote>
<p><strong>protein_water</strong> : string</p>
<blockquote>
<div><p>the filename of a solvent pdb file for the protein</p>
</div></blockquote>
<p><strong>ligand_water</strong> : string</p>
<blockquote>
<div><p>the filename of a solvent pdb file for the ligands</p>
</div></blockquote>
<p><strong>settings</strong> : Namespace object (from argparse)</p>
<blockquote>
<div><p>additional settings</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>free_cmd</strong> : ProtoMSSimulation</p>
<blockquote>
<div><p>the command file for the ligand simulation</p>
</div></blockquote>
<p><strong>bnd_cmd</strong> : ProtoMSSimulation</p>
<blockquote>
<div><p>the command file for the protein simulation</p>
</div></blockquote>
<p><strong>gas_cmd</strong> : ProtoMSSimulation</p>
<blockquote class="last">
<div><p>the command file for the gas simulation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.make_dummy">
<span id="tools-make-dummy-module"></span><h2>tools.make_dummy module<a class="headerlink" href="#module-tools.make_dummy" title="Permalink to this headline">¶</a></h2>
<p>Routine to make a dummy PDB structure for a solute</p>
<p>This module defines a single public function:
make_dummy</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.make_dummy.make_dummy">
<code class="descclassname">tools.make_dummy.</code><code class="descname">make_dummy</code><span class="sig-paren">(</span><em>pdbfile</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_dummy.make_dummy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a dummy PDB structure to match a molecule</p>
<p>It will place the dummy at the centre of the molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbfile</strong> : string or PDBFile</p>
<blockquote>
<div><p>the pdb structure of the molecule</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile instance</p>
<blockquote class="last">
<div><p>the dummy structure</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.make_gcmcbox">
<span id="tools-make-gcmcbox-module"></span><h2>tools.make_gcmcbox module<a class="headerlink" href="#module-tools.make_gcmcbox" title="Permalink to this headline">¶</a></h2>
<p>Routine to make a GCMC/JAWS-1 simulation box from a ligand</p>
<p>This module defines a single public function:
make_gcmcbox</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.make_gcmcbox.make_gcmcbox">
<code class="descclassname">tools.make_gcmcbox.</code><code class="descname">make_gcmcbox</code><span class="sig-paren">(</span><em>pdb</em>, <em>filename</em>, <em>padding=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_gcmcbox.make_gcmcbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a GCMC/JAWS-1 simulation box around a PDB-structure</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdb</strong> : PDBFile object</p>
<blockquote>
<div><p>the PDB structure</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote>
<div><p>the name of the output file</p>
</div></blockquote>
<p><strong>padding</strong> : float, optional</p>
<blockquote class="last">
<div><p>the amount of extra space around the ligand to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.make_gcmcbox.print_bequil">
<code class="descclassname">tools.make_gcmcbox.</code><code class="descname">print_bequil</code><span class="sig-paren">(</span><em>boxlen</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_gcmcbox.print_bequil" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-tools.make_single">
<span id="tools-make-single-module"></span><h2>tools.make_single module<a class="headerlink" href="#module-tools.make_single" title="Permalink to this headline">¶</a></h2>
<p>Routines to make ProtoMS single topology template</p>
<p>This module defines these public function
make_single
write_map
summarize</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.make_single.make_single">
<code class="descclassname">tools.make_single.</code><code class="descname">make_single</code><span class="sig-paren">(</span><em>tem1</em>, <em>tem2</em>, <em>pdb1</em>, <em>pdb2</em>, <em>mapfile=None</em>, <em>gaffversion='gaff16'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_single.make_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Make single topology templates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tem1</strong> : TemplateFile or string</p>
<blockquote>
<div><p>first template file or its filename</p>
</div></blockquote>
<p><strong>tem2</strong> : TemplateFile or string</p>
<blockquote>
<div><p>second template file or its filename</p>
</div></blockquote>
<p><strong>pdb1</strong> : PDBFile or string</p>
<blockquote>
<div><p>structure template for tem1 or its filename</p>
</div></blockquote>
<p><strong>pdb2</strong> : PDBFile or string</p>
<blockquote>
<div><p>structure template for tem2 or its filename</p>
</div></blockquote>
<p><strong>mapfile</strong> : string, optional</p>
<blockquote>
<div><p>filename of map of correspondance</p>
</div></blockquote>
<p><strong>gaffversion</strong> : str, optional</p>
<blockquote>
<div><p>version of gaff to use, defaults to gaff16</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">TemplateFile</p>
<blockquote>
<div><p>a template file for the electrostatic leg</p>
</div></blockquote>
<p>TemplateFile</p>
<blockquote>
<div><p>a template file for the van der Waals leg</p>
</div></blockquote>
<p>TemplateFile</p>
<blockquote>
<div><p>a template file for a combined transformation</p>
</div></blockquote>
<p>dictionary of strings</p>
<blockquote>
<div><p>the full map of correspondance</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>SetupError</strong></p>
<blockquote class="last">
<div><p>tem2 is larger than tem1</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.make_single.summarize">
<code class="descclassname">tools.make_single.</code><code class="descname">summarize</code><span class="sig-paren">(</span><em>eletem</em>, <em>vdwtem</em>, <em>loggfunc</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_single.summarize" title="Permalink to this definition">¶</a></dt>
<dd><p>Print single topology parameter summary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>eletem</strong> : TemplateFile</p>
<blockquote>
<div><p>template for electrostatic perturbation</p>
</div></blockquote>
<p><strong>vdwtem</strong> : TemplateFile</p>
<blockquote>
<div><p>template for van der Waals perturbation</p>
</div></blockquote>
<p><strong>loggfunc</strong> : logger function</p>
<blockquote class="last">
<div><p>the logger function to use to print the summary</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.make_single.write_map">
<code class="descclassname">tools.make_single.</code><code class="descname">write_map</code><span class="sig-paren">(</span><em>cmap</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.make_single.write_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a correspondance map to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cmap</strong> : a dictionary of strings</p>
<blockquote>
<div><p>the map of correspondance</p>
</div></blockquote>
<p><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.merge_templates">
<span id="tools-merge-templates-module"></span><h2>tools.merge_templates module<a class="headerlink" href="#module-tools.merge_templates" title="Permalink to this headline">¶</a></h2>
<p>Routine to merge a series of ProtoMS template files</p>
<p>This module defines a single public function:
merge_templates</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.merge_templates.merge_templates">
<code class="descclassname">tools.merge_templates.</code><code class="descname">merge_templates</code><span class="sig-paren">(</span><em>templates</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.merge_templates.merge_templates" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge a series of ProtoMS template files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>templates</strong> : list of string</p>
<blockquote>
<div><p>the names of the template file</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">TemplateFile</p>
<blockquote>
<div><p>the merged template file</p>
</div></blockquote>
<p>or</p>
<p>string</p>
<blockquote class="last">
<div><p>the filename of the single unique template</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.pms2pymbar">
<span id="tools-pms2pymbar-module"></span><h2>tools.pms2pymbar module<a class="headerlink" href="#module-tools.pms2pymbar" title="Permalink to this headline">¶</a></h2>
<p>Program to prepare ProtoMS output for pymbar</p>
<p>This module defines two public functions:
extract_energies
mbar</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.pms2pymbar.bar">
<code class="descclassname">tools.pms2pymbar.</code><code class="descname">bar</code><span class="sig-paren">(</span><em>energies</em>, <em>RT</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.pms2pymbar.bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the BAR free energy using the PyMBAR package</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lambdas</strong> : numpy array</p>
<blockquote>
<div><p>the lambda values</p>
</div></blockquote>
<p><strong>energies</strong> : list of numpy array</p>
<blockquote>
<div><p>the energy values at each lambda and each snapshot</p>
</div></blockquote>
<p><strong>RT</strong> : float</p>
<blockquote>
<div><p>the gas constant multiplied by the absolute temperature</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote>
<div><p>the free energy</p>
</div></blockquote>
<p>float</p>
<blockquote class="last">
<div><p>the uncertainty in the free energy</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.pms2pymbar.extract_energies">
<code class="descclassname">tools.pms2pymbar.</code><code class="descname">extract_energies</code><span class="sig-paren">(</span><em>path</em>, <em>res_tem</em>, <em>skip</em>, <em>maxread</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.pms2pymbar.extract_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract total energies from a number of folders</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong> : string</p>
<blockquote>
<div><p>the directory to find lambda folders</p>
</div></blockquote>
<p><strong>res_tem</strong> : string</p>
<blockquote>
<div><p>the prefix of the results files</p>
</div></blockquote>
<p><strong>skip</strong> : int</p>
<blockquote>
<div><p>number of snapshots to ignore</p>
</div></blockquote>
<p><strong>maxread</strong> : int</p>
<blockquote>
<div><p>maximum number of snapshots to read</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of float</p>
<blockquote>
<div><p>the lambda values</p>
</div></blockquote>
<p>list of numpy array</p>
<blockquote>
<div><p>all total energies</p>
</div></blockquote>
<p>list of strings</p>
<blockquote class="last">
<div><p>the path of the lambda folders</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.pms2pymbar.mbar">
<code class="descclassname">tools.pms2pymbar.</code><code class="descname">mbar</code><span class="sig-paren">(</span><em>lambdas</em>, <em>energies</em>, <em>RT</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.pms2pymbar.mbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the MBAR free energy using the PyMBAR package</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lambdas</strong> : numpy array</p>
<blockquote>
<div><p>the lambda values</p>
</div></blockquote>
<p><strong>energies</strong> : list of numpy array</p>
<blockquote>
<div><p>the energy values at each lambda and each snapshot</p>
</div></blockquote>
<p><strong>RT</strong> : float</p>
<blockquote>
<div><p>the gas constant multiplied by the absolute temperature</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array</p>
<blockquote>
<div><p>the free energy matrix</p>
</div></blockquote>
<p>numpy array</p>
<blockquote class="last">
<div><p>the uncertainty in the free energy matrix</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.scoop">
<span id="tools-scoop-module"></span><h2>tools.scoop module<a class="headerlink" href="#module-tools.scoop" title="Permalink to this headline">¶</a></h2>
<p>Routines to build a protein scoop</p>
<p>This module defines a single public function
scoop</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.scoop.scoop">
<code class="descclassname">tools.scoop.</code><code class="descname">scoop</code><span class="sig-paren">(</span><em>protein</em>, <em>ligand</em>, <em>innercut=16</em>, <em>outercut=20</em>, <em>flexin='full'</em>, <em>flexout='sidechain'</em>, <em>terminal='neutralize'</em>, <em>excluded=[]</em>, <em>added=[]</em>, <em>scooplimit=10</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.scoop.scoop" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a scoop from protein structure</p>
<p>The protein object is not modified by this routine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>protein</strong> : PDBFile</p>
<blockquote>
<div><p>pdb instance for the protein to be scooped</p>
</div></blockquote>
<p><strong>ligand</strong> : PDBFile or string</p>
<blockquote>
<div><p>Either pdb instance for ligand to be scooped around, or string giving
the name of a file containing 3 floats to act as coords for scoop centre,
or a string with three floating point numbers</p>
</div></blockquote>
<p><strong>innercut</strong> : float, optional</p>
<blockquote>
<div><p>Maximum distance from ligand defining inner region of the scoop</p>
</div></blockquote>
<p><strong>outercut</strong> : float, optional</p>
<blockquote>
<div><p>Maximum distance from ligand defining outer region of the scoop</p>
</div></blockquote>
<p><strong>flexin</strong> : string, optional</p>
<blockquote>
<div><p>Gives the degree of flexibility for residues of the inner region
Can be &#8216;rigid&#8217;, &#8216;sidechain&#8217; or &#8216;flexible&#8217;</p>
</div></blockquote>
<p><strong>flexout</strong> : string, optional</p>
<blockquote>
<div><p>As flexin but for residues of the outer scoop</p>
</div></blockquote>
<p><strong>terminal</strong> : string, optional</p>
<blockquote>
<div><p>Determines what to do with terminal residues
Can be &#8216;keep&#8217;, &#8216;doublekeep&#8217;,&#8217;neutralize&#8217;</p>
</div></blockquote>
<p><strong>excluded</strong> : list of int</p>
<blockquote>
<div><p>List of indices for residues to be excluded from scoop</p>
</div></blockquote>
<p><strong>added</strong> : list of int</p>
<blockquote>
<div><p>List of indices for residues to be included in outer scoop</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile</p>
<blockquote class="last">
<div><p>an object representing the scooped protein</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.simulationobjects">
<span id="tools-simulationobjects-module"></span><h2>tools.simulationobjects module<a class="headerlink" href="#module-tools.simulationobjects" title="Permalink to this headline">¶</a></h2>
<p>Useful classes for setup and analysis of ProtoMS simulations.
Contain classes to</p>
<blockquote>
<div><ol class="arabic simple">
<li>Read, modify and write structures in PDB format</li>
<li>Store parameter collections</li>
<li>Read and store ProtoMS results files</li>
<li>Read, modify and write ProtoMS template files</li>
</ol>
</div></blockquote>
<dl class="class">
<dt id="tools.simulationobjects.Atom">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">Atom</code><span class="sig-paren">(</span><em>index=0</em>, <em>name='?'</em>, <em>resname='???'</em>, <em>resindex=0</em>, <em>coords=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class for holding a PDB atom record</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>index</td>
<td>(integer) the number of the atom in the pdb file</td>
</tr>
<tr class="row-even"><td>resindex</td>
<td>(integer) the number of the residue in the pdb file</td>
</tr>
<tr class="row-odd"><td>name</td>
<td>(string) the name of the atom</td>
</tr>
<tr class="row-even"><td>resname</td>
<td>(string) the name of the residue</td>
</tr>
<tr class="row-odd"><td>coords</td>
<td>(NumpyArray) Cartesian coordinates</td>
</tr>
<tr class="row-even"><td>type</td>
<td>(string) either atom or hetatm</td>
</tr>
<tr class="row-odd"><td>element</td>
<td>(string) the element of the atom</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.Atom.getElement" title="tools.simulationobjects.Atom.getElement"><code class="xref py py-obj docutils literal"><span class="pre">getElement</span></code></a>()</td>
<td>Set the element of this atom</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.Atom.getElement">
<code class="descname">getElement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Atom.getElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the element of this atom</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.AtomSet">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">AtomSet</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.AtomSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a set of atoms and their associated parameter</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>atoms</td>
<td>(list of strings) the atoms in this set</td>
</tr>
<tr class="row-even"><td>param</td>
<td>(int or ForceFieldParameter) the parameter associated with the atoms</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.AtomSet.parse" title="tools.simulationobjects.AtomSet.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.AtomSet.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.AtomSet.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>record</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.DihParameter">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">DihParameter</code><span class="sig-paren">(</span><em>index</em>, <em>ats</em>, <em>terms</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.DihParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a dihedral parameter from a ProtoMS template file</p>
<p>A separate class is needed to handle dihedral parameters due to their
composition of multiple terms.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>index</td>
<td>(integer) the serial number of the parameter</td>
</tr>
<tr class="row-even"><td>ats</td>
<td>(list of string) the name of the atoms associated with the parameter</td>
</tr>
<tr class="row-odd"><td>b0</td>
<td>(list of DihTerm) the terms that make up this dihedral parameter</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.DihTerm">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">DihTerm</code><span class="sig-paren">(</span><em>index</em>, <em>k1</em>, <em>k2</em>, <em>k3</em>, <em>k4</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.DihTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold individual terms making up a Dihedral</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>index</td>
<td>(integer) the serial number of the parameter</td>
</tr>
<tr class="row-even"><td>k1</td>
<td>(float) The term barrier height</td>
</tr>
<tr class="row-odd"><td>k2</td>
<td>(float) OPLS inversion constant (should be either 0.0 or 1.0 for AMBER ffs)</td>
</tr>
<tr class="row-even"><td>k3</td>
<td>(float) The term periodicity</td>
</tr>
<tr class="row-odd"><td>k4</td>
<td>(float) The term phase</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.EnergyResults">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">EnergyResults</code><span class="sig-paren">(</span><em>line=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.EnergyResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold energy results</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>curr</td>
<td>(float) the energy at the current lambda</td>
</tr>
<tr class="row-even"><td>back</td>
<td>(float) the energy at the previous lambda</td>
</tr>
<tr class="row-odd"><td>forward</td>
<td>(float) the energy at the next lambda</td>
</tr>
<tr class="row-even"><td>type</td>
<td>(string) a label</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.EnergyResults.parse_line" title="tools.simulationobjects.EnergyResults.parse_line"><code class="xref py py-obj docutils literal"><span class="pre">parse_line</span></code></a>(line)</td>
<td>Parse energies from the result file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.EnergyResults.parse_line">
<code class="descname">parse_line</code><span class="sig-paren">(</span><em>line</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.EnergyResults.parse_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse energies from the result file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>line</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.ForceFieldParameter">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">ForceFieldParameter</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ForceFieldParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a general parameter set</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>key</td>
<td>(string) a label</td>
</tr>
<tr class="row-even"><td>index</td>
<td>(integer) a serial number</td>
</tr>
<tr class="row-odd"><td>params</td>
<td>(list) either a list of strings or a list of ForceFieldParameter, containing the actual parameters</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.ForceFieldParameter.parse" title="tools.simulationobjects.ForceFieldParameter.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.ForceFieldParameter.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ForceFieldParameter.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>record</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.MolTemplate">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">MolTemplate</code><a class="headerlink" href="#tools.simulationobjects.MolTemplate" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a ProtoMS template</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>name</td>
<td>(string) the name of the template</td>
</tr>
<tr class="row-even"><td>type</td>
<td>(string) the kind of template, e.g. solute</td>
</tr>
<tr class="row-odd"><td>translate</td>
<td>(float) the translation displacement</td>
</tr>
<tr class="row-even"><td>rot</td>
<td>(float) the rotational displacement</td>
</tr>
<tr class="row-odd"><td>atoms</td>
<td>(list of TemplateAtom objects) the atoms in this template</td>
</tr>
<tr class="row-even"><td>connectivity</td>
<td>(list of TemplateConnectivity objects) the connectivity in this template</td>
</tr>
<tr class="row-odd"><td>variables</td>
<td>(list of string) the variable geometries</td>
</tr>
<tr class="row-even"><td>atomclass</td>
<td>(TemplateAtom class) the class to create objects of atoms</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.MolTemplate.parse_from" title="tools.simulationobjects.MolTemplate.parse_from"><code class="xref py py-obj docutils literal"><span class="pre">parse_from</span></code></a>(fileobj)</td>
<td>Parse a full template from a file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.MolTemplate.write_to" title="tools.simulationobjects.MolTemplate.write_to"><code class="xref py py-obj docutils literal"><span class="pre">write_to</span></code></a>(fileobj)</td>
<td>Write the template to disc</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.MolTemplate.write_zmat" title="tools.simulationobjects.MolTemplate.write_zmat"><code class="xref py py-obj docutils literal"><span class="pre">write_zmat</span></code></a>(filename)</td>
<td>Write the z-matrix of this template to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.MolTemplate.parse_from">
<code class="descname">parse_from</code><span class="sig-paren">(</span><em>fileobj</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MolTemplate.parse_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a full template from a file</p>
<p>Terminates when found another mode 
or end of file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fileobj</strong> : file object</p>
<blockquote class="last">
<div><p>the file to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.MolTemplate.write_to">
<code class="descname">write_to</code><span class="sig-paren">(</span><em>fileobj</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MolTemplate.write_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the template to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fileobj</strong> : file object</p>
<blockquote class="last">
<div><p>the file to write to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.MolTemplate.write_zmat">
<code class="descname">write_zmat</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MolTemplate.write_zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the z-matrix of this template to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the file to write to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.MyArgumentParser">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">MyArgumentParser</code><span class="sig-paren">(</span><em>prog=None</em>, <em>usage=None</em>, <em>description=None</em>, <em>epilog=None</em>, <em>version=None</em>, <em>parents=[]</em>, <em>formatter_class=&lt;class 'argparse.HelpFormatter'&gt;</em>, <em>prefix_chars='-'</em>, <em>fromfile_prefix_chars=None</em>, <em>argument_default=None</em>, <em>conflict_handler='error'</em>, <em>add_help=True</em>, <em>add_fullhelp=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MyArgumentParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">argparse.ArgumentParser</span></code></p>
<p>Extention to ArgumentParser to allow separation of of help in to 
help for most common options and full help that list all arguments</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.MyArgumentParser.format_help" title="tools.simulationobjects.MyArgumentParser.format_help"><code class="xref py py-obj docutils literal"><span class="pre">format_help</span></code></a>([fullhelp])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.MyArgumentParser.print_fullhelp" title="tools.simulationobjects.MyArgumentParser.print_fullhelp"><code class="xref py py-obj docutils literal"><span class="pre">print_fullhelp</span></code></a>([file])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.MyArgumentParser.print_help" title="tools.simulationobjects.MyArgumentParser.print_help"><code class="xref py py-obj docutils literal"><span class="pre">print_help</span></code></a>([file])</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.MyArgumentParser.format_help">
<code class="descname">format_help</code><span class="sig-paren">(</span><em>fullhelp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MyArgumentParser.format_help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.MyArgumentParser.print_fullhelp">
<code class="descname">print_fullhelp</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MyArgumentParser.print_fullhelp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.MyArgumentParser.print_help">
<code class="descname">print_help</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.MyArgumentParser.print_help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.PDBFile">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">PDBFile</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for holding the atoms and residues of a PDB file</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>center</td>
<td>(NumPy array) the center of coordinates of all atoms</td>
</tr>
<tr class="row-even"><td>header</td>
<td>(string) additional lines to print before ATOM records</td>
</tr>
<tr class="row-odd"><td>name</td>
<td>(string) the name of the file</td>
</tr>
<tr class="row-even"><td>residues</td>
<td>(dictionary of Residue objects) all non-solvent residues</td>
</tr>
<tr class="row-odd"><td>solvents</td>
<td>(dictionary of Residue objects) all solvent residues</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.copy" title="tools.simulationobjects.PDBFile.copy"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a>()</td>
<td>Make a copy of the residues and solvents dictionaries,</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.getBox" title="tools.simulationobjects.PDBFile.getBox"><code class="xref py py-obj docutils literal"><span class="pre">getBox</span></code></a>([atomlist,&nbsp;reslist])</td>
<td>Calculate the smallest box to encompass the atoms</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.getCenter" title="tools.simulationobjects.PDBFile.getCenter"><code class="xref py py-obj docutils literal"><span class="pre">getCenter</span></code></a>()</td>
<td>Calculate the center of geometry</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.read" title="tools.simulationobjects.PDBFile.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(filename)</td>
<td>Read a pdb-file from disc</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.read_from" title="tools.simulationobjects.PDBFile.read_from"><code class="xref py py-obj docutils literal"><span class="pre">read_from</span></code></a>(f[,&nbsp;resname])</td>
<td>Read a pdb structure from a fileobject</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.PDBFile.write" title="tools.simulationobjects.PDBFile.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a>(filename,&nbsp;**kwargs)</td>
<td>Write the PDB file to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.PDBFile.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a copy of the residues and solvents dictionaries, 
not the Residue and Atom objects themselves</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile</p>
<blockquote class="last">
<div><p>the newly created instance</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBFile.getBox">
<code class="descname">getBox</code><span class="sig-paren">(</span><em>atomlist='all'</em>, <em>reslist='all'</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.getBox" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the smallest box to encompass the atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atomlist = list, optional</strong></p>
<blockquote>
<div><p>the atoms to be taken into acount to get the box</p>
</div></blockquote>
<p><strong>reslist = list, optional</strong></p>
<blockquote>
<div><p>the residues to be taken into acount to get the box</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dictionary of Numpy arrays</p>
<blockquote class="last">
<div><p>the center, length and origin of the box</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBFile.getCenter">
<code class="descname">getCenter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.getCenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the center of geometry</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">NumPy array</p>
<blockquote class="last">
<div><p>the center</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a pdb-file from disc</p>
<p>It will overwrite existing residues and renumber all residues from 1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the pdb file</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBFile.read_from">
<code class="descname">read_from</code><span class="sig-paren">(</span><em>f</em>, <em>resname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.read_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a pdb structure from a fileobject</p>
<p>Terminates reading when found a record starting with END</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>f</strong> : file object</p>
<blockquote>
<div><p>the object to read from</p>
</div></blockquote>
<p><strong>resname</strong> : string, optional</p>
<blockquote class="last">
<div><p>the name of the residue to read, only read this</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBFile.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the PDB file to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote>
<div><p>the name of the file</p>
</div></blockquote>
<p><strong>renumber</strong> : boolean, optional</p>
<blockquote>
<div><p>indicate if residues should be renumbered</p>
</div></blockquote>
<p><strong>header</strong> : string, optional</p>
<blockquote>
<div><p>additional lines to print before the atom records</p>
</div></blockquote>
<p><strong>solvents</strong> : boolean, optional</p>
<blockquote class="last">
<div><p>if to write the solvents</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.PDBSet">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">PDBSet</code><a class="headerlink" href="#tools.simulationobjects.PDBSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Hold a collection of PDBFile objects</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>pdbs</td>
<td>(list of PDBFile objects) the pdb files</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.PDBSet.from_residues" title="tools.simulationobjects.PDBSet.from_residues"><code class="xref py py-obj docutils literal"><span class="pre">from_residues</span></code></a>(pdbfile)</td>
<td>Split a PDB file into a set by residue</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.PDBSet.read" title="tools.simulationobjects.PDBSet.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(filename[,&nbsp;resname,&nbsp;skip,&nbsp;readmax])</td>
<td>Read a set of pdb structures from a file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.PDBSet.write" title="tools.simulationobjects.PDBSet.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a>(filenames[,&nbsp;solvents])</td>
<td>Write the set to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.PDBSet.from_residues">
<code class="descname">from_residues</code><span class="sig-paren">(</span><em>pdbfile</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBSet.from_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a PDB file into a set by residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbfile</strong> : PDBFile object</p>
<blockquote class="last">
<div><p>the pdb-file to split</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBSet.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em>, <em>resname=None</em>, <em>skip=0</em>, <em>readmax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBSet.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a set of pdb structures from a file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote>
<div><p>the name of the file to read</p>
</div></blockquote>
<p><strong>resname</strong> : string, optional</p>
<blockquote>
<div><p>the name of the residue to read, only read this</p>
</div></blockquote>
<p><strong>skip</strong> : int, optional</p>
<blockquote>
<div><p>number of snapshot at the beginning to skip</p>
</div></blockquote>
<p><strong>readmax</strong> : int, optional</p>
<blockquote class="last">
<div><p>maximum number of snapshots to read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.PDBSet.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filenames</em>, <em>solvents=True</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.PDBSet.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the set to disc</p>
<p>If one filename is given all PDB-files are written to one file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filenames</strong> : list of strings</p>
<blockquote>
<div><p>the name of the file(s) to write to</p>
</div></blockquote>
<p><strong>solvents</strong> : boolean</p>
<blockquote class="last">
<div><p>if to write the solvents</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.Parameter">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">Parameter</code><span class="sig-paren">(</span><em>index</em>, <em>ats</em>, <em>k</em>, <em>b0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a parameter from a ProtoMS template file</p>
<p>Not valid for dihedral parameters but contains sufficient
information to check that a parameter exists</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>index</td>
<td>(integer) the serial number of the parameter</td>
</tr>
<tr class="row-even"><td>ats</td>
<td>(list of string) the name of the atoms associated with the parameter</td>
</tr>
<tr class="row-odd"><td>k</td>
<td>(float) the force constant</td>
</tr>
<tr class="row-even"><td>b0</td>
<td>(float) the equilibrium value</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.ParameterSet">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">ParameterSet</code><span class="sig-paren">(</span><em>ptype</em>, <em>param_file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ParameterSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a collection of parameters</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>file_name</td>
<td>(string) the name of the file where the parameters originated</td>
</tr>
<tr class="row-even"><td>params</td>
<td>(list of Parameter objects) the parameters in this collection</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.ParameterSet.get_par_by_index" title="tools.simulationobjects.ParameterSet.get_par_by_index"><code class="xref py py-obj docutils literal"><span class="pre">get_par_by_index</span></code></a>(ind)</td>
<td>For an atm line index find matching the par line</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.ParameterSet.get_params" title="tools.simulationobjects.ParameterSet.get_params"><code class="xref py py-obj docutils literal"><span class="pre">get_params</span></code></a>(ats)</td>
<td>Find parameter sets for specific atoms.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.ParameterSet.read" title="tools.simulationobjects.ParameterSet.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(param_file)</td>
<td></td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="tools.simulationobjects.ParameterSet.formats">
<code class="descname">formats</code><em class="property"> = {'angle': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;), 'atm': (&lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;)}, 'dihedral': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;), 'atm': (&lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;), 'term': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;)}, 'clj': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;)}, 'bond': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;), 'atm': (&lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;)}}</em><a class="headerlink" href="#tools.simulationobjects.ParameterSet.formats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.ParameterSet.get_par_by_index">
<code class="descname">get_par_by_index</code><span class="sig-paren">(</span><em>ind</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ParameterSet.get_par_by_index" title="Permalink to this definition">¶</a></dt>
<dd><p>For an atm line index find matching the par line</p>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.ParameterSet.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>ats</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ParameterSet.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Find parameter sets for specific atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ats</strong> : sequence of strings</p>
<blockquote>
<div><p>the query atoms</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Parameter object</p>
<blockquote class="last">
<div><p>the found parameter</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.ParameterSet.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>param_file</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ParameterSet.read" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.Residue">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">Residue</code><span class="sig-paren">(</span><em>name='???'</em>, <em>index=0</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class for holding a set of PDB atoms</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>atoms</td>
<td>(list of Atom objects) the atom of this residue</td>
</tr>
<tr class="row-even"><td>index</td>
<td>(integer) the number of the residue in the pdb file</td>
</tr>
<tr class="row-odd"><td>name</td>
<td>(string) the name of the residue</td>
</tr>
<tr class="row-even"><td>center</td>
<td>(NumPy array) the center of coordinates of all atoms</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.Residue.addAtom" title="tools.simulationobjects.Residue.addAtom"><code class="xref py py-obj docutils literal"><span class="pre">addAtom</span></code></a>(atom)</td>
<td>Adds an atom to this residue</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.Residue.getCenter" title="tools.simulationobjects.Residue.getCenter"><code class="xref py py-obj docutils literal"><span class="pre">getCenter</span></code></a>()</td>
<td>Sets the center of coordinates for this residue</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.Residue.isAminoacid" title="tools.simulationobjects.Residue.isAminoacid"><code class="xref py py-obj docutils literal"><span class="pre">isAminoacid</span></code></a>()</td>
<td>Checks is the residue name is an aminoacid name</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.Residue.addAtom">
<code class="descname">addAtom</code><span class="sig-paren">(</span><em>atom</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Residue.addAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an atom to this residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atom</strong> : Atom object</p>
<blockquote class="last">
<div><p>the atom to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.Residue.getCenter">
<code class="descname">getCenter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Residue.getCenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the center of coordinates for this residue</p>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.Residue.isAminoacid">
<code class="descname">isAminoacid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.Residue.isAminoacid" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks is the residue name is an aminoacid name</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.RestartFile">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">RestartFile</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.RestartFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold the information on a
restart file</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>filename</td>
<td>(string) the name of the restart file</td>
</tr>
<tr class="row-even"><td>nsolutes</td>
<td>(int) the number of solute molecules</td>
</tr>
<tr class="row-odd"><td>ngcsolutes</td>
<td>(int) the number of gcsolute molecules</td>
</tr>
<tr class="row-even"><td>solutesdic</td>
<td>(dict) the correlation of solute ids with residue names</td>
</tr>
<tr class="row-odd"><td>gcsolutesdic</td>
<td>(dict) the correlation of gcsolutes ids with residue names</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.RestartFile.read" title="tools.simulationobjects.RestartFile.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(filename)</td>
<td>Read the restart file from disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.RestartFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.RestartFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the restart file from disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the file to read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.ResultsFile">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">ResultsFile</code><a class="headerlink" href="#tools.simulationobjects.ResultsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to store a collection of results</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>filename</td>
<td>(string) the name of the file</td>
</tr>
<tr class="row-even"><td>snapshots</td>
<td>(list of SnapshotResult) all the results</td>
</tr>
<tr class="row-odd"><td>series</td>
<td>(SnapshotResult) all the results in a single object</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.ResultsFile.make_series" title="tools.simulationobjects.ResultsFile.make_series"><code class="xref py py-obj docutils literal"><span class="pre">make_series</span></code></a>()</td>
<td>Make a snapshot with all the results</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.ResultsFile.read" title="tools.simulationobjects.ResultsFile.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(filename[,&nbsp;skip,&nbsp;readmax])</td>
<td>Read results from disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.ResultsFile.make_series">
<code class="descname">make_series</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ResultsFile.make_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a snapshot with all the results</p>
<p>This routine creates a special SnapshotResults object, which has
the same attributes as the objects in the snapshots list,
but rather than storing single floats and integers, this
object stores NumpyArrays of all the results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">SnapshotResults</p>
<blockquote class="last">
<div><p>the created object, also stored in self.series</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.ResultsFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em>, <em>skip=0</em>, <em>readmax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.ResultsFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read results from disc</p>
<p>The filename parameter can be either a single filename, in
case it is assumed that it is a ProtoMS3.0 results file, i.e.
it contains several snapshots
if it is a list of strings, two behaviors are supported:</p>
<blockquote>
<div><ol class="arabic simple">
<li>if the length of the list is 2, and the first filename</li>
</ol>
</div></blockquote>
<p>is a dictionary, a glob is used to list all filenames in that
directory that starts with the second filename in the list</p>
<blockquote>
<div><ol class="arabic simple" start="2">
<li>if the length is not two or you give two filenames,</li>
</ol>
</div></blockquote>
<p>each of them are processed individually and treated as individual
snapshots</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string or list of strings</p>
<blockquote>
<div><p>the name of the file to read</p>
</div></blockquote>
<p><strong>skip</strong> : int, optional</p>
<blockquote>
<div><p>number of snapshot at the beginning to skip</p>
</div></blockquote>
<p><strong>readmax</strong> : int, optional</p>
<blockquote class="last">
<div><p>maximum number of snapshots to read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="tools.simulationobjects.SetupError">
<em class="property">exception </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">SetupError</code><a class="headerlink" href="#tools.simulationobjects.SetupError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></code></p>
<p>A general exception class to be raised by setup code</p>
</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.SnapshotResults">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">SnapshotResults</code><a class="headerlink" href="#tools.simulationobjects.SnapshotResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to store a single snapshot of results</p>
<p>Not all attributes might not be set as they might not
exists in the result file</p>
<p>internal_energies and interaction_energies are dictionary
where the key is is the molecules involved in the energy, e.g.
protein1, or protein1-solute1. The value is a list of EnergyResults
objects, for the various energy components.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>lam</td>
<td>(float) the current lambda value</td>
</tr>
<tr class="row-even"><td>lamb</td>
<td>(float) the previous lambda value</td>
</tr>
<tr class="row-odd"><td>lamf</td>
<td>(float) the next lambda value</td>
</tr>
<tr class="row-even"><td>datastep</td>
<td>(int) the number of steps the averages are calculate over</td>
</tr>
<tr class="row-odd"><td>lambdareplica</td>
<td>(int) the index of the lambda replica</td>
</tr>
<tr class="row-even"><td>temperaturereplica</td>
<td>(int) the index of the temperature replica</td>
</tr>
<tr class="row-odd"><td>global replica</td>
<td>(int) the index of the global replica</td>
</tr>
<tr class="row-even"><td>temperature</td>
<td>(float) the temperature of the simulation</td>
</tr>
<tr class="row-odd"><td>efftemperature</td>
<td>(float) the effective temperature in case of REST</td>
</tr>
<tr class="row-even"><td>ngcsolutes</td>
<td>(int) the number of GC solutes</td>
</tr>
<tr class="row-odd"><td>nthetasolutes</td>
<td>(int) the number of theta solutes</td>
</tr>
<tr class="row-even"><td>bvalue</td>
<td>(float) the Adams value</td>
</tr>
<tr class="row-odd"><td>solventson</td>
<td>(int) the number of GC solutes that are turned on</td>
</tr>
<tr class="row-even"><td>pressure</td>
<td>(float) the pressure</td>
</tr>
<tr class="row-odd"><td>volume</td>
<td>(float) the volume</td>
</tr>
<tr class="row-even"><td>seed</td>
<td>(int) the random seed</td>
</tr>
<tr class="row-odd"><td>backfe</td>
<td>(float) the free energy to the previous lambda</td>
</tr>
<tr class="row-even"><td>forwfe</td>
<td>(float) the free energy to the next lambda</td>
</tr>
<tr class="row-odd"><td>total</td>
<td>(EnergyResults object) the total energy</td>
</tr>
<tr class="row-even"><td>internal_energies</td>
<td>(dictionary of lists of EnergyResults object) the internal energies</td>
</tr>
<tr class="row-odd"><td>interaction_energies</td>
<td>(dictionary of lists of EnergyResults objects) the interaction energies</td>
</tr>
<tr class="row-even"><td>capenergy</td>
<td>(EnergyResults object) the energy of the cap</td>
</tr>
<tr class="row-odd"><td>extraenergy</td>
<td>(EnergyResults object) all extra energies</td>
</tr>
<tr class="row-even"><td>feenergies</td>
<td>(dictionary of float) the total energy at various lambda values</td>
</tr>
<tr class="row-odd"><td>gradient</td>
<td>(float) the numerical gradient of lambda</td>
</tr>
<tr class="row-even"><td>agradient</td>
<td>(float) the analytical gradient of lambda</td>
</tr>
<tr class="row-odd"><td>thetavals</td>
<td>(list of float) the theta values of all GC solutes</td>
</tr>
<tr class="row-even"><td>thetasolvals</td>
<td>(list of float) the theta values of all theta solutes</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.SnapshotResults.parse" title="tools.simulationobjects.SnapshotResults.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(fileobj)</td>
<td>Parse a file for results</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.SnapshotResults.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>fileobj</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.SnapshotResults.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a file for results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fileobj</strong> : file object</p>
<blockquote>
<div><p>the file to read from</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">string :</p>
<blockquote class="last">
<div><p>the line last read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.TemplateAtom">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">TemplateAtom</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a template atom</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>name</td>
<td>(string) the name of the atom</td>
</tr>
<tr class="row-even"><td>residue</td>
<td>(string) the residue of the atom</td>
</tr>
<tr class="row-odd"><td>param0</td>
<td>(int or ForceFieldParameter) the parameter associated with this atom at v0</td>
</tr>
<tr class="row-even"><td>param1</td>
<td>(int or ForceFieldParameter) the parameter associated with this atom at v1</td>
</tr>
<tr class="row-odd"><td>bondedto</td>
<td>(string or TemplateAtom) the atom this atom is bonded to</td>
</tr>
<tr class="row-even"><td>angleto</td>
<td>(string or TemplateAtom) the atom this atom forms an angle with</td>
</tr>
<tr class="row-odd"><td>dihedto</td>
<td>(string or TemplateAtom) the atom this atom forms a dihedral with</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.TemplateAtom.parse" title="tools.simulationobjects.TemplateAtom.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.TemplateAtom.zmat" title="tools.simulationobjects.TemplateAtom.zmat"><code class="xref py py-obj docutils literal"><span class="pre">zmat</span></code></a>()</td>
<td>Produces a simple z-matrix representation of this atom</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.TemplateAtom.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateAtom.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>record</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.TemplateAtom.zmat">
<code class="descname">zmat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateAtom.zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a simple z-matrix representation of this atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">returns</p>
<blockquote class="last">
<div><p>the z-matrix representation</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.TemplateConnectivity">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">TemplateConnectivity</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateConnectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a solute bond, angle or dihedral</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>type</td>
<td>(string) the kind of connectivity, i.e. bond, angle or dihedral</td>
</tr>
<tr class="row-even"><td>atoms</td>
<td>(list of strings or TemplateAtom objects) the atoms involved in this connectivity</td>
</tr>
<tr class="row-odd"><td>flex</td>
<td>(float) the flexibility</td>
</tr>
<tr class="row-even"><td>param0</td>
<td>(int or ForceFieldParameter) the parameter associated with this connectivity at v0</td>
</tr>
<tr class="row-odd"><td>param1</td>
<td>(int or ForceFieldParameter) the parameter associated with this connectivity at v1</td>
</tr>
<tr class="row-even"><td>dummy</td>
<td>(bool) flag to indicate if this should be treated as a dummy</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.TemplateConnectivity.parse" title="tools.simulationobjects.TemplateConnectivity.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.TemplateConnectivity.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateConnectivity.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>record</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.TemplateFile">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">TemplateFile</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a ProtoMS template file</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>bondparams</td>
<td>(list of ForceFieldParameter objects) all bond parameters</td>
</tr>
<tr class="row-even"><td>bondatoms</td>
<td>(list of AtomSet objects) all atoms associated with bond parameters</td>
</tr>
<tr class="row-odd"><td>angleparams</td>
<td>(list of ForceFieldParameter objects) all angle parameters</td>
</tr>
<tr class="row-even"><td>angleatoms</td>
<td>(list of AtomSet objects) all atoms associated with angle parameters</td>
</tr>
<tr class="row-odd"><td>dihedralterms</td>
<td>(list of ForceFieldParameter objects) all dihedral term parameters</td>
</tr>
<tr class="row-even"><td>dihedralparams</td>
<td>(list of ForceFieldParameter objects) all dihedral parameters</td>
</tr>
<tr class="row-odd"><td>dihedralatoms</td>
<td>(list of AtomSet objects) all atoms associated with dihedral parameters</td>
</tr>
<tr class="row-even"><td>cljparams</td>
<td>(list of ForceFieldParameter objects) all clj parameters</td>
</tr>
<tr class="row-odd"><td>templates</td>
<td>(list of MolTemplate objects) all templates in this file</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.TemplateFile.append" title="tools.simulationobjects.TemplateFile.append"><code class="xref py py-obj docutils literal"><span class="pre">append</span></code></a>(other)</td>
<td>Adds another template file to this one</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.TemplateFile.assign_paramobj" title="tools.simulationobjects.TemplateFile.assign_paramobj"><code class="xref py py-obj docutils literal"><span class="pre">assign_paramobj</span></code></a>()</td>
<td>Replaces integers and strings with objects</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.TemplateFile.read" title="tools.simulationobjects.TemplateFile.read"><code class="xref py py-obj docutils literal"><span class="pre">read</span></code></a>(filename)</td>
<td>Read a template file from disc</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.TemplateFile.write" title="tools.simulationobjects.TemplateFile.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a>(filename)</td>
<td>Write a template file to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.TemplateFile.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateFile.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds another template file to this one</p>
<p>Will renumber the parameters of the other
file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>other</strong> : TemplateFile</p>
<blockquote class="last">
<div><p>the file to add</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.TemplateFile.assign_paramobj">
<code class="descname">assign_paramobj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateFile.assign_paramobj" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces integers and strings with objects</p>
<p>It replaces all indices to force field parameters
with references to ForceFieldParameter objects</p>
<p>It replaces all atom in templates with references
to TemplateAtom objects</p>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.TemplateFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a template file from disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the file to read</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.TemplateFile.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a template file to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote class="last">
<div><p>the name of the file to write to</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tools.simulationobjects.TemplateSoluteAtom">
<em class="property">class </em><code class="descclassname">tools.simulationobjects.</code><code class="descname">TemplateSoluteAtom</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateSoluteAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#tools.simulationobjects.TemplateAtom" title="tools.simulationobjects.TemplateAtom"><code class="xref py py-class docutils literal"><span class="pre">tools.simulationobjects.TemplateAtom</span></code></a></p>
<p>Class to hold a solute atom</p>
<p>This is a sub-class that implements functions
that are specific for solute templates</p>
<p>Has the same attributes as TemplateAtom</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#tools.simulationobjects.TemplateSoluteAtom.parse" title="tools.simulationobjects.TemplateSoluteAtom.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#tools.simulationobjects.TemplateSoluteAtom.zmat" title="tools.simulationobjects.TemplateSoluteAtom.zmat"><code class="xref py py-obj docutils literal"><span class="pre">zmat</span></code></a>()</td>
<td>Produces a simple z-matrix representation of this atom</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tools.simulationobjects.TemplateSoluteAtom.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateSoluteAtom.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>record</strong> : string</p>
<blockquote class="last">
<div><p>the line to parse from</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tools.simulationobjects.TemplateSoluteAtom.zmat">
<code class="descname">zmat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.TemplateSoluteAtom.zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a simple z-matrix representation of this atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">returns</p>
<blockquote class="last">
<div><p>the z-matrix representation, viz. ATOM BONDEDTO ANGLETO DIHEDRALTO</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.angle">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">angle</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the angle between two vectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>v1</strong> : Numpy array</p>
<blockquote>
<div><p>the first vecor</p>
</div></blockquote>
<p><strong>v2</strong> : Numpy array</p>
<blockquote>
<div><p>the second vecor</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>the angle in radians</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.angle_atms">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">angle_atms</code><span class="sig-paren">(</span><em>a1</em>, <em>a2</em>, <em>a3</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.angle_atms" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the angle between three atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a1</strong> : Numpy array</p>
<blockquote>
<div><p>the first atom</p>
</div></blockquote>
<p><strong>a2</strong> : Numpy array</p>
<blockquote>
<div><p>the second atom</p>
</div></blockquote>
<p><strong>a3</strong> : Numpy array</p>
<blockquote>
<div><p>the third atom</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">float</p>
<blockquote class="last">
<div><p>the angle in radians</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.color">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">color</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.color" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a color of index</p>
<p>For instances when the index is larger than the number of defined colors,
this routine takes care of this by periodicity, i.e.
color at idx=0 is the same color as idx=n</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>idx</strong> : int</p>
<blockquote>
<div><p>the index of the color</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of floats</p>
<blockquote class="last">
<div><p>the color</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.find_box">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">find_box</code><span class="sig-paren">(</span><em>pdbobj</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.find_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse box information from a pdb file</p>
<p>Looks for CENTER, DIMENSIONS and box keywords
in the header of the pdb file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbobj</strong> : PDBFile object</p>
<blockquote>
<div><p>the structure to parse</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dictionary of Numpy arrays</p>
<blockquote class="last">
<div><p>the center, length and origin of the box</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.is_solvent">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">is_solvent</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.is_solvent" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether a given residue name
is a solvent residue name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : string</p>
<blockquote class="last">
<div><p>the residue name</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.merge_pdbs">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">merge_pdbs</code><span class="sig-paren">(</span><em>pdbobjs</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.merge_pdbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge pdb files</p>
<p>Create a new PDBFile instance and add all residues and solvents from
all pdb files given, renumbering residues</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pdbobjs</strong> : list of PDBFile objects</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile object</p>
<blockquote class="last">
<div><p>the newly created and merged pdb structure</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.setup_logger">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">setup_logger</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.setup_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup ProtoMS logging system</p>
<p>Uses the standard logging module with two handlers,
one that prints everything above DEBUG to standard output
and one that prints everything, even DEBUG to a file</p>
<p>If filename is None no file handler is created</p>
<p>This should be called by protoms.py and all other stand-alone
programs that uses the tools</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string, optional</p>
<blockquote>
<div><p>the filename of the string</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a reference to the created logger</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.standard_filename">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">standard_filename</code><span class="sig-paren">(</span><em>filename</em>, <em>folder</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.standard_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the filename of file in the standard ProtoMS file hierarchy</p>
<p>If $PROTOMSHOME is set, it uses it as the base-path, otherwise,
it uses the location of this module as to create the base-path</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote>
<div><p>the name of the file</p>
</div></blockquote>
<p><strong>folder</strong> : string</p>
<blockquote>
<div><p>a folder in the standard ProtoMS file hierarchy</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the full path to the file</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tools.simulationobjects.write_box">
<code class="descclassname">tools.simulationobjects.</code><code class="descname">write_box</code><span class="sig-paren">(</span><em>filename</em>, <em>box</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.simulationobjects.write_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a box in PDB file format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : string</p>
<blockquote>
<div><p>the name of the file to write</p>
</div></blockquote>
<p><strong>box</strong> : dictionary of Numpy array</p>
<blockquote class="last">
<div><p>the box specification</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.solvate">
<span id="tools-solvate-module"></span><h2>tools.solvate module<a class="headerlink" href="#module-tools.solvate" title="Permalink to this headline">¶</a></h2>
<p>Routines to solvate a structure</p>
<p>This module defines a single public function:
solvate</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.solvate.solvate">
<code class="descclassname">tools.solvate.</code><code class="descname">solvate</code><span class="sig-paren">(</span><em>box</em>, <em>ligand=None</em>, <em>protein=None</em>, <em>geometry='box'</em>, <em>padding=10.0</em>, <em>radius=30.0</em>, <em>center='cent'</em>, <em>namescheme='ProtoMS'</em>, <em>offset=0.89</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.solvate.solvate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to solvate ligand and/or protein structures using a pre-equilibrated box of waters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>box</strong> : String</p>
<blockquote>
<div><p>String giving the name of a pdb file containing a box of pre-
equilibrated water molecules for solvation</p>
</div></blockquote>
<p><strong>ligand</strong> : PDBFile or string, optional</p>
<blockquote>
<div><p>Either pdb instance for ligand to be solvated, or string giving
the name of a pdb file of the ligand. NOTE - either ligand or protein
or both must be supplied</p>
</div></blockquote>
<p><strong>protein</strong> : PDBFile or string, optional</p>
<blockquote>
<div><p>Either pdb instance for protein to be solvated, or string giving
the name of a pdb file of the protein. NOTE - either ligand or protein
or both must be supplied</p>
</div></blockquote>
<p><strong>geometry</strong> : string, optional</p>
<blockquote>
<div><p>Shape of solvent box, options &#8220;box&#8221;, &#8220;droplet&#8221;, &#8220;flood&#8221;. Default box.
Droplet defines a sphere of radius &#8216;radius&#8217; around center &#8216;center&#8217;.
Box defines a box that extends at least distance &#8216;padding&#8217; from solute
Flood defines the equivalent, but waters overlapping with the solute
are not removed</p>
</div></blockquote>
<p><strong>padding</strong> : float, optional</p>
<blockquote>
<div><p>Minimum distance between the solute and the box edge. Default 10.0A</p>
</div></blockquote>
<p><strong>radius</strong> : float, optional</p>
<blockquote>
<div><p>The radius of the added droplet sphere. Default 30.0A</p>
</div></blockquote>
<p><strong>center</strong> : string, optional</p>
<blockquote>
<div><p>Defines the center of the added droplet sphere. Options &#8220;cent&#8221;,
one, two or three numbers. Default &#8220;cent&#8221;.
Cent defines the center based on all solute atom coordinates
One number defines coordinates for the center as identical x,y,z
Two numbers defines coordinates for the center over an atom range
Three numbers defines coordinates for the center as separate x,y,z</p>
</div></blockquote>
<p><strong>namescheme</strong> : string, optional</p>
<blockquote>
<div><p>Naming scheme for printout, options &#8220;ProtoMS&#8221;, &#8220;Amber&#8221;. Default ProtoMS</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBFile</p>
<blockquote>
<div><p>the created box of waters, including crystallographic water</p>
</div></blockquote>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>SetupError</strong></p>
<blockquote class="last">
<div><p>neither protein nor ligand was given, or x-ray waters is not same format as pre-equilibrated box</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools.split_jawswater">
<span id="tools-split-jawswater-module"></span><h2>tools.split_jawswater module<a class="headerlink" href="#module-tools.split_jawswater" title="Permalink to this headline">¶</a></h2>
<p>Routine to split JAWS-1 water into PDBs for JAWS-2</p>
<p>This module defines a single public function:
split_water</p>
<p>Can be executed from the command line as a stand-alone program</p>
<dl class="function">
<dt id="tools.split_jawswater.set_jaws2_box">
<code class="descclassname">tools.split_jawswater.</code><code class="descname">set_jaws2_box</code><span class="sig-paren">(</span><em>water_files</em>, <em>length=3</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.split_jawswater.set_jaws2_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the header of the pdbs containing one single
molecule to define a box around the first atom</p>
<dl class="docutils">
<dt>water_files <span class="classifier-delimiter">:</span> <span class="classifier">PDBSet</span></dt>
<dd>a pdb set containing the pdb files with one molecule</dd>
<dt>length <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>the dimensions of the box around the molecule</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tools.split_jawswater.split_waters">
<code class="descclassname">tools.split_jawswater.</code><code class="descname">split_waters</code><span class="sig-paren">(</span><em>waters</em><span class="sig-paren">)</span><a class="headerlink" href="#tools.split_jawswater.split_waters" title="Permalink to this definition">¶</a></dt>
<dd><p>Split waters in a PDB file to many PDB-files for JAWS-2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>waters</strong> : string or PDBFile object</p>
<blockquote>
<div><p>the PDB structure</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">PDBSet</p>
<blockquote>
<div><p>single waters</p>
</div></blockquote>
<p>PDBSet</p>
<blockquote class="last">
<div><p>excluding single waters</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tools">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-tools" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Richard Bradshaw, Ana Cabedo Martinez, Chris Cave-Ayland, Samuel Genheden, Gregory Ross.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>