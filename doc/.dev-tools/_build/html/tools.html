
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>protomslib package &#8212; ProtoMS 3.4 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>

<!--<div style="background-color: white; text-align: center; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci" style="width: 10em"/></a>
</div>-->

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/dolphin.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">protomslib package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-protomslib.command">Command</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#module-protomslib.free_energy.free_energy_argument_parser">FreeEnergy</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#module-protomslib.gcmc">GCMC</a></li>
<li><a class="reference internal" href="#module-protomslib.prepare">Prepare</a></li>
<li><a class="reference internal" href="#module-protomslib.simulationobjects">Simulation Objects</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#module-protomslib.solvate">Solvate</a></li>
<li><a class="reference internal" href="#template">Template</a></li>
<li><a class="reference internal" href="#module-protomslib.utils">Utils</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tools.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="protomslib-package">
<h1>protomslib package<a class="headerlink" href="#protomslib-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-protomslib.command">
<span id="command"></span><h2>Command<a class="headerlink" href="#module-protomslib.command" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="protomslib.command.DualTopology">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">DualTopology</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb', 'solute2.pdb'], solvent='water.pdb', templates=['solute1.tem', 'solute2.tem'], nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, ranseed=None, lambdaval=None, outfolder='out', restrained=[], softcore='mixed', spec_softcore=''</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.DualTopology" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProteinLigandSimulation" title="protomslib.command.ProteinLigandSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a dual-topology protein-ligand simulation
Generates input for proteins, solutes and solvent
write dual-toplogy parameters, lambda-replica exchange,
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="76%" />
<col width="24%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>make_softcore</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>spec_string_from_user_input</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.command.DualTopology.make_softcore">
<code class="descname">make_softcore</code><span class="sig-paren">(</span><em>softcore</em>, <em>spec_softcore</em>, <em>templates</em>, <em>solutes</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.DualTopology.make_softcore" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="protomslib.command.DualTopology.spec_string_from_user_input">
<code class="descname">spec_string_from_user_input</code><span class="sig-paren">(</span><em>N</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.DualTopology.spec_string_from_user_input" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.command.Equilibration">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">Equilibration</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute.pdb'], solvent='water.pdb', templates=['solute.tem'], outfolder='', ranseed=None, nsteps=100000.0, pdbfile='equilibrated.pdb'</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.Equilibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProteinLigandSimulation" title="protomslib.command.ProteinLigandSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for equilibration of a protein-ligand system
Generates input for proteins, solutes and solvent and write an
equilibration and a pdb chunk</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.command.GCAPDual">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">GCAPDual</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb', 'solute2.pdb'], solvent='water.pdb', templates=['solute1.tem', 'solute2.tem'], nequil=5000000.0, nprod=80000000.0, dumpfreq=100000.0, ranseed=None, lambdaval=None, outfolder='out', restrained=[], softcore='mixed', gcmcbox=None, gcmcwater='gcmc_water.pdb', adamval=None, watmodel='tip4p', spec_softcore=''</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.GCAPDual" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProteinLigandSimulation" title="protomslib.command.ProteinLigandSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a dual-topology protein-ligand simulation
Generates input for proteins, solutes and solvent
write dual-toplogy parameters, lambda-replica exchange,
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="76%" />
<col width="24%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>make_softcore</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>spec_string_from_user_input</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.command.GCAPDual.make_softcore">
<code class="descname">make_softcore</code><span class="sig-paren">(</span><em>softcore</em>, <em>spec_softcore</em>, <em>templates</em>, <em>solutes</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.GCAPDual.make_softcore" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="protomslib.command.GCAPDual.spec_string_from_user_input">
<code class="descname">spec_string_from_user_input</code><span class="sig-paren">(</span><em>N</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.GCAPDual.spec_string_from_user_input" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.command.GCAPSingle">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">GCAPSingle</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb'], solvent='water.pdb', templates=['solute.tem'], nequil=5000000.0, nprod=80000000.0, dumpfreq=100000.0, lambdaval=None, ranseed=None, outfolder='out', gcmcbox=None, gcmcwater='gcmc_water.pdb', adamval=None, watmodel='tip4p', restrained=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.GCAPSingle" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProteinLigandSimulation" title="protomslib.command.ProteinLigandSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a single-topology protein-ligand simulation
Generates input for proteins, solutes and solvent
write lambda-replica exchange,
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.command.GCMC">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">GCMC</code><span class="sig-paren">(</span><em>protein='protein.pdb'</em>, <em>solutes=[]</em>, <em>solvent='water.pdb'</em>, <em>templates=[]</em>, <em>gcmcwater='gcmc_water.pdb'</em>, <em>gcmcbox=None</em>, <em>nequil=5000000.0</em>, <em>nprod=80000000.0</em>, <em>dumpfreq=200000.0</em>, <em>adamval=None</em>, <em>ranseed=None</em>, <em>watmodel='tip4p'</em>, <em>outfolder='out_gcmc'</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.GCMC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProteinLigandSimulation" title="protomslib.command.ProteinLigandSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a GCMC simulation
Generates input for proteins, solutes and solvent
write GCMC parameters
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.command.Jaws1">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">Jaws1</code><span class="sig-paren">(</span><em>protein='protein.pdb'</em>, <em>solutes=[]</em>, <em>solvent='water.pdb'</em>, <em>templates=[]</em>, <em>outfolder=''</em>, <em>ranseed=None</em>, <em>jawswater='jaws_water.pdb'</em>, <em>jawsbox=None</em>, <em>nequil=5000000.0</em>, <em>nprod=40000000.0</em>, <em>watmodel='tip4p'</em>, <em>dumpfreq=100000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.Jaws1" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProteinLigandSimulation" title="protomslib.command.ProteinLigandSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a JAWS-1 simulation
Generates input for proteins, solutes and solvent
write JAWS-1 parameters
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.command.Jaws2">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">Jaws2</code><span class="sig-paren">(</span><em>protein='protein.pdb'</em>, <em>solutes=[]</em>, <em>solvent='water.pdb'</em>, <em>templates=[]</em>, <em>outfolder=''</em>, <em>ranseed=None</em>, <em>jawswater='jaws_water.pdb'</em>, <em>jbias=6.5</em>, <em>nequil=5000000.0</em>, <em>nprod=40000000.0</em>, <em>watmodel='tip4p'</em>, <em>dumpfreq=100000.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.Jaws2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProteinLigandSimulation" title="protomslib.command.ProteinLigandSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a JAWS-2 simulation
Generates input for proteins, solutes and solvent
write JAWS-2 parameters
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.command.ProteinLigandSimulation">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">ProteinLigandSimulation</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute.pdb'], solvent='water.pdb', templates=['solute.tem'], outfolder=None, ranseed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProteinLigandSimulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProtoMSSimulation" title="protomslib.command.ProtoMSSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProtoMSSimulation</span></code></a></p>
<p>This a generic command file for a protein-ligand simulation
Generates input for proteins, solutes and solvent but does not
write any chunks</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.command.ProtoMSSimulation">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">ProtoMSSimulation</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a ProtoMS command file object.This object holds all of the
information about the simulation and can either run the simulation with
this information, or can write this information to a command file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lines :</strong></dt>
<dd><p class="first last">list of strings all the lines of the ProtoMS command file</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.clear" title="protomslib.command.ProtoMSSimulation.clear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code></a>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.readCommandFile" title="protomslib.command.ProtoMSSimulation.readCommandFile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code></a>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.run" title="protomslib.command.ProtoMSSimulation.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.setChunk" title="protomslib.command.ProtoMSSimulation.setChunk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code></a>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.setDump" title="protomslib.command.ProtoMSSimulation.setDump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code></a>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.setForceField" title="protomslib.command.ProtoMSSimulation.setForceField"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code></a>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.setParameter" title="protomslib.command.ProtoMSSimulation.setParameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code></a>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.setProtein" title="protomslib.command.ProtoMSSimulation.setProtein"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code></a>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.setSolute" title="protomslib.command.ProtoMSSimulation.setSolute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code></a>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.setSolvent" title="protomslib.command.ProtoMSSimulation.setSolvent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code></a>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.setStream" title="protomslib.command.ProtoMSSimulation.setStream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code></a>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.command.ProtoMSSimulation.writeCommandFile" title="protomslib.command.ProtoMSSimulation.writeCommandFile"><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code></a>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the simulation description</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.readCommandFile">
<code class="descname">readCommandFile</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.readCommandFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in a simulation from a command file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename of the command file to read from disc</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>exe</em>, <em>cmdfile=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run this simulation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>exe</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename of the executable</p>
</dd>
<dt><strong>cmdfile</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">the filename of the command file</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.setChunk">
<code class="descname">setChunk</code><span class="sig-paren">(</span><em>chunk</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.setChunk" title="Permalink to this definition">¶</a></dt>
<dd><p>This adds the simulation chunk to ‘chunk’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>chunk</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the chunk to be executed, including parameters</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.setDump">
<code class="descname">setDump</code><span class="sig-paren">(</span><em>dump</em>, <em>freq</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.setDump" title="Permalink to this definition">¶</a></dt>
<dd><p>This adds the simulation dump to ‘dump’ with frequnecy freq</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dump</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the dump to be executed, including parameters</p>
</dd>
<dt><strong>freq</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the dump frequency</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.setForceField">
<code class="descname">setForceField</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.setForceField" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for parfile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename of the force field file</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.setParameter">
<code class="descname">setParameter</code><span class="sig-paren">(</span><em>parameter</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.setParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameter to value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>parameter</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the parameter</p>
</dd>
<dt><strong>value</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the value of the parameter</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.setProtein">
<code class="descname">setProtein</code><span class="sig-paren">(</span><em>n</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.setProtein" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for proteinN. It then returns n+1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the protein serial number</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename of the protein pdb file</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>int</strong></dt>
<dd><p class="first last">n + 1</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.setSolute">
<code class="descname">setSolute</code><span class="sig-paren">(</span><em>n</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.setSolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for soluteN. It then returns n+1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the solute serial number</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename of the solute pdb file</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>int</strong></dt>
<dd><p class="first last">n + 1</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.setSolvent">
<code class="descname">setSolvent</code><span class="sig-paren">(</span><em>n</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.setSolvent" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the filename for solventN. It then returns n+1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>n</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the solvent serial number</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename of the solvent pdb file</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>int</strong></dt>
<dd><p class="first last">n + 1</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.setStream">
<code class="descname">setStream</code><span class="sig-paren">(</span><em>stream</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.setStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the direction of the output stream to a filename</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>stream</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the stream</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename to direct the stream to</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.command.ProtoMSSimulation.writeCommandFile">
<code class="descname">writeCommandFile</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.ProtoMSSimulation.writeCommandFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the contents of this simulation object to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename to write the commands to</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.command.RestraintRelease">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">RestraintRelease</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb'], solvent='water.pdb', templates=['solute.tem'], nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, lambdaval=None, ranseed=None, outfolder='out', restrained=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.RestraintRelease" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProteinLigandSimulation" title="protomslib.command.ProteinLigandSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProteinLigandSimulation</span></code></a></p>
<p>Command file to calculate the free energy of introducing a
harmonic restraint during the bound leg of a simulation.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.command.Sampling">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">Sampling</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute.pdb'], solvent='water.pdb', templates=['solute.tem'], outfolder='', ranseed=None, nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, outprefix='', tune=False</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.Sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProteinLigandSimulation" title="protomslib.command.ProteinLigandSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for MC sampling of a protein-ligand system
Generates input for proteins, solutes and solvent and write
chunks for equilibration and simulation, as well as dumps</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.command.SingleTopology">
<em class="property">class </em><code class="descclassname">protomslib.command.</code><code class="descname">SingleTopology</code><span class="sig-paren">(</span><em>protein='protein.pdb', solutes=['solute1.pdb'], solvent='water.pdb', templates=['solute.tem'], nequil=5000000.0, nprod=40000000.0, dumpfreq=100000.0, lambdaval=None, ranseed=None, outfolder='out', restrained=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.SingleTopology" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.command.ProteinLigandSimulation" title="protomslib.command.ProteinLigandSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.command.ProteinLigandSimulation</span></code></a></p>
<p>This a command file for a single-topology protein-ligand simulation
Generates input for proteins, solutes and solvent
write lambda-replica exchange,
dump results, pdb and restart files
equilibrate and production run</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear</span></code>()</td>
<td>Clear the simulation description</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">readCommandFile</span></code>(filename)</td>
<td>Read in a simulation from a command file</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(exe[,&nbsp;cmdfile])</td>
<td>Run this simulation</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setChunk</span></code>(chunk)</td>
<td>This adds the simulation chunk to ‘chunk’.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setDump</span></code>(dump,&nbsp;freq)</td>
<td>This adds the simulation dump to ‘dump’ with frequnecy freq</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setForceField</span></code>(filename)</td>
<td>Set the filename for parfile</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setParameter</span></code>(parameter,&nbsp;value)</td>
<td>Set the parameter to value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setProtein</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for proteinN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolute</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for soluteN.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setSolvent</span></code>(n,&nbsp;filename)</td>
<td>Set the filename for solventN.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">setStream</span></code>(stream,&nbsp;filename)</td>
<td>Set the direction of the output stream to a filename</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">writeCommandFile</span></code>(filename)</td>
<td>Write the contents of this simulation object to disc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.command.generate_input">
<code class="descclassname">protomslib.command.</code><code class="descname">generate_input</code><span class="sig-paren">(</span><em>protein</em>, <em>ligands</em>, <em>templates</em>, <em>protein_water</em>, <em>ligand_water</em>, <em>ranseed</em>, <em>settings</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.command.generate_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates ProtoMS command files
If protein is a valid filename a protein(-ligand) simulation is
setup, and if ligands contains at least one valid filename a
ligand simulation is setup.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>protein</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename of a protein pdb file</p>
</dd>
<dt><strong>ligands</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd><p class="first last">filenames of solute pdb files</p>
</dd>
<dt><strong>templates</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd><p class="first last">filenames of template files to be included</p>
</dd>
<dt><strong>protein_water</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename of a solvent pdb file for the protein</p>
</dd>
<dt><strong>ligand_water</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename of a solvent pdb file for the ligands</p>
</dd>
<dt><strong>settings</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Namespace object (from argparse)</span></dt>
<dd><p class="first last">additional settings</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>free_cmd</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ProtoMSSimulation</span></dt>
<dd><p class="first last">the command file for the ligand simulation</p>
</dd>
<dt><strong>bnd_cmd</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ProtoMSSimulation</span></dt>
<dd><p class="first last">the command file for the protein simulation</p>
</dd>
<dt><strong>gas_cmd</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ProtoMSSimulation</span></dt>
<dd><p class="first last">the command file for the gas simulation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-protomslib.free_energy.free_energy_argument_parser">
<span id="freeenergy"></span><h2>FreeEnergy<a class="headerlink" href="#module-protomslib.free_energy.free_energy_argument_parser" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="protomslib.free_energy.free_energy_argument_parser.FEArgumentParser">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_argument_parser.</code><code class="descname">FEArgumentParser</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_argument_parser.FEArgumentParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">argparse.ArgumentParser</span></code></p>
<p>Thin wrapper around argparse.ArgumentParser designed to allow
specification of individual arguments that cannot be used at the
same time as one another.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.add_argument" title="protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.add_argument"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_argument</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>Thin wrapper around ArgumentParser.add_argument that uses additional keyword argument ‘clashes’.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_subparsers</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.check_clashes" title="protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.check_clashes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_clashes</span></code></a>(parsed)</td>
<td>Check that arguments in Namespace parsed are compatible, according to provided argument clashes.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">error</span></code>(message)</td>
<td>Prints a usage message incorporating the message to stderr and exits.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">exit</span></code>([status,&nbsp;message])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">format_usage</span></code>()</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.parse_args" title="protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.parse_args"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_args</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>Thin wrapper around ArgumentParser.parse_args that checks for clashing arguments.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_usage</span></code>([file])</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">register</span></code>(registry_name,&nbsp;value,&nbsp;object)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_defaults</span></code>(**kwargs)</td>
<td></td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="76%" />
<col width="24%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>add_argument_group</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>add_mutually_exclusive_group</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>convert_arg_line_to_args</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>format_help</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>format_version</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>get_default</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>parse_known_args</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>print_help</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>print_version</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.add_argument">
<code class="descname">add_argument</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.add_argument" title="Permalink to this definition">¶</a></dt>
<dd><p>Thin wrapper around ArgumentParser.add_argument that
uses additional keyword argument ‘clashes’. Clashes should
be a list that contains the names of other arguments which
cannot be provided at the same time as this one.</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.check_clashes">
<code class="descname">check_clashes</code><span class="sig-paren">(</span><em>parsed</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.check_clashes" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that arguments in Namespace parsed are compatible,
according to provided argument clashes.</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.parse_args">
<code class="descname">parse_args</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_argument_parser.FEArgumentParser.parse_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Thin wrapper around ArgumentParser.parse_args that checks
for clashing arguments.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-protomslib.free_energy.free_energy_base"></span><p>Collection of classes to form the basis of a replacement for the current
free energy calculation framework.</p>
<dl class="class">
<dt id="protomslib.free_energy.free_energy_base.BAR">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">BAR</code><span class="sig-paren">(</span><em>lambdas</em>, <em>results_name='results'</em>, <em>subdir_glob='./'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.BAR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Estimator" title="protomslib.free_energy.free_energy_base.Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.Estimator</span></code></a></p>
<p>Estimate free energy differences using Bennett’s Acceptance Ratio.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.BAR.add_data" title="protomslib.free_energy.free_energy_base.BAR.add_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.BAR.calculate" title="protomslib.free_energy.free_energy_base.BAR.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>([temp])</td>
<td>Calculate the free energy difference and return a PMF object.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">result_class</span></code></td>
<td>alias of <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Result" title="protomslib.free_energy.free_energy_base.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.BAR.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.BAR.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>series: SnapshotResults.series</strong></dt>
<dd><p class="first last">free energy simulation data for a particular lambda value</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.BAR.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp=300.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.BAR.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a PMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>temp: float, optional</strong></dt>
<dd><p class="first last">temperature of calculation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.free_energy_base.BaseResult">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">BaseResult</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.BaseResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A base class for Result objects.</p>
</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.free_energy_base.Estimator">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">Estimator</code><span class="sig-paren">(</span><em>lambdas</em>, <em>results_name='results'</em>, <em>subdir_glob='./'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Estimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for free energy estimators.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.Estimator.add_data" title="protomslib.free_energy.free_energy_base.Estimator.add_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.Estimator.calculate" title="protomslib.free_energy.free_energy_base.Estimator.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>([temp])</td>
<td>Calculate the free energy difference and return a PMF object.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.Estimator.result_class" title="protomslib.free_energy.free_energy_base.Estimator.result_class"><code class="xref py py-obj docutils literal notranslate"><span class="pre">result_class</span></code></a></td>
<td>alias of <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Result" title="protomslib.free_energy.free_energy_base.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.Estimator.subset" title="protomslib.free_energy.free_energy_base.Estimator.subset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset</span></code></a>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.Estimator.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Estimator.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>series: SnapshotResults.series</strong></dt>
<dd><p class="first last">free energy simulation data for a particular lambda value</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.Estimator.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp=300.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Estimator.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a PMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>temp: float, optional</strong></dt>
<dd><p class="first last">temperature of calculation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="protomslib.free_energy.free_energy_base.Estimator.result_class">
<code class="descname">result_class</code><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Estimator.result_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Result" title="protomslib.free_energy.free_energy_base.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.Estimator.subset">
<code class="descname">subset</code><span class="sig-paren">(</span><em>low_bound=0.0</em>, <em>high_bound=1.0</em>, <em>step=1</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Estimator.subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new class instance containing truncated data series.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>low_bound: float, default=0.</strong></dt>
<dd><p class="first last">Starting position of truncated data series.</p>
</dd>
<dt><strong>high_bound: float, default=1.</strong></dt>
<dd><p class="first last">Finishing position of truncated data series.</p>
</dd>
<dt><strong>step: int, default=1</strong></dt>
<dd><p class="first last">Subsampling frequency of data. 1=all data points,
2=every other data point, etc.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.free_energy_base.FreeEnergyCalculation">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">FreeEnergyCalculation</code><span class="sig-paren">(</span><em>root_paths, temperature, estimators=[&lt;class 'protomslib.free_energy.free_energy_base.TI'&gt;, &lt;class 'protomslib.free_energy.free_energy_base.BAR'&gt;, &lt;class 'protomslib.free_energy.free_energy_base.MBAR'&gt;], subdir='', extract_data=True, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.FreeEnergyCalculation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for performing a free energy calculation from one or more
ProtoMS simulation outputs.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.FreeEnergyCalculation.calculate" title="protomslib.free_energy.free_energy_base.FreeEnergyCalculation.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>([subset])</td>
<td>For each estimator return the evaluated potential of mean force.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.FreeEnergyCalculation.run" title="protomslib.free_energy.free_energy_base.FreeEnergyCalculation.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>(args)</td>
<td>Public method for execution of calculation.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.FreeEnergyCalculation.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>subset=(0.0</em>, <em>1.0</em>, <em>1)</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.FreeEnergyCalculation.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>For each estimator return the evaluated potential of mean force.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>subset: tuple of two floats and an int</strong></dt>
<dd><p class="first last">specify the subset of data to use in the calculation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.FreeEnergyCalculation.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.FreeEnergyCalculation.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Public method for execution of calculation. This is usually the
desired way to use execute calculations. Handles logic for
printing of output tables and saving of output pickles and
figures. Calls plt.show() to display figures.  Runs
self._body(args) and uses the return value as the calculation
result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>args</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.free_energy_base.MBAR">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">MBAR</code><span class="sig-paren">(</span><em>lambdas</em>, <em>results_name='results'</em>, <em>subdir_glob='./'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.MBAR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.free_energy.free_energy_base.TI" title="protomslib.free_energy.free_energy_base.TI"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.TI</span></code></a></p>
<p>Estimate free energy differences using the Multistate Bennett’s
Acceptante Ratio.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.MBAR.add_data" title="protomslib.free_energy.free_energy_base.MBAR.add_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.MBAR.calculate" title="protomslib.free_energy.free_energy_base.MBAR.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>([temp])</td>
<td>Calculate the free energy difference and return a PMF object.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">result_class</span></code></td>
<td>alias of <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Result" title="protomslib.free_energy.free_energy_base.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.MBAR.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.MBAR.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>series: SnapshotResults.series</strong></dt>
<dd><p class="first last">free energy simulation data for a particular lambda value</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.MBAR.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp=300.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.MBAR.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a PMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>temp: float, optional</strong></dt>
<dd><p class="first last">temperature of calculation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.free_energy_base.PMF">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">PMF</code><span class="sig-paren">(</span><em>coordinate</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.PMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Series" title="protomslib.free_energy.free_energy_base.Series"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.Series</span></code></a></p>
<p>A Potential of Mean Force, describing a free energy profile
as a function of some coordinate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="#protomslib.free_energy.free_energy_base.PMF.dG" title="protomslib.free_energy.free_energy_base.PMF.dG"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dG</span></code></a></dt>
<dd><p class="first last">The free energy difference at the PMF end points</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_floats</span></code>()</td>
<td>Return a numpy array containing the values of the data series as floats without error values.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code>(axes[,&nbsp;show_error,&nbsp;fmt,&nbsp;xlabel,&nbsp;ylabel])</td>
<td>Plot this PMF onto the provided figure axes.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="protomslib.free_energy.free_energy_base.PMF.dG">
<code class="descname">dG</code><a class="headerlink" href="#protomslib.free_energy.free_energy_base.PMF.dG" title="Permalink to this definition">¶</a></dt>
<dd><p>The free energy difference at the PMF end points</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.free_energy_base.Quantity">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">Quantity</code><span class="sig-paren">(</span><em>value</em>, <em>error</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Quantity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stores both the value and error associated with a
free energy estimate.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.Quantity.fromData" title="protomslib.free_energy.free_energy_base.Quantity.fromData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fromData</span></code></a>(data)</td>
<td>Alternative initialiser that uses of a set of data points rather than providing an explicit value and error.</td>
</tr>
</tbody>
</table>
<dl class="staticmethod">
<dt id="protomslib.free_energy.free_energy_base.Quantity.fromData">
<em class="property">static </em><code class="descname">fromData</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Quantity.fromData" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative initialiser that uses of a set of data
points rather than providing an explicit value and error.
Returns a Quantity object with a value and error determined
from the mean of and standard error of the provided data. If
Quantity objects are provided as data their individual
error attributes are ignored</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>data: sequence of numbers or Quantity objects</strong></dt>
<dd><p class="first last">data from which to determine value and error</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.free_energy_base.Result">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">Result</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Result" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.free_energy.free_energy_base.BaseResult" title="protomslib.free_energy.free_energy_base.BaseResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.BaseResult</span></code></a></p>
<p>The result of a free energy calculation. Contains multiple PMF
objects that are combined together to give a meaningful free energy
difference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="#protomslib.free_energy.free_energy_base.Result.dG" title="protomslib.free_energy.free_energy_base.Result.dG"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dG</span></code></a></dt>
<dd><p class="first last">The free energy difference at the PMF end points</p>
</dd>
<dt><a class="reference internal" href="#protomslib.free_energy.free_energy_base.Result.lambdas" title="protomslib.free_energy.free_energy_base.Result.lambdas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lambdas</span></code></a></dt>
<dd><p class="first last">Lambda values at which the calculation has been performed</p>
</dd>
<dt><a class="reference internal" href="#protomslib.free_energy.free_energy_base.Result.pmf" title="protomslib.free_energy.free_energy_base.Result.pmf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pmf</span></code></a></dt>
<dd><p class="first last">The potential of mean force for this result</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="protomslib.free_energy.free_energy_base.Result.dG">
<code class="descname">dG</code><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Result.dG" title="Permalink to this definition">¶</a></dt>
<dd><p>The free energy difference at the PMF end points</p>
</dd></dl>

<dl class="attribute">
<dt id="protomslib.free_energy.free_energy_base.Result.lambdas">
<code class="descname">lambdas</code><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Result.lambdas" title="Permalink to this definition">¶</a></dt>
<dd><p>Lambda values at which the calculation has been performed</p>
</dd></dl>

<dl class="attribute">
<dt id="protomslib.free_energy.free_energy_base.Result.pmf">
<code class="descname">pmf</code><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Result.pmf" title="Permalink to this definition">¶</a></dt>
<dd><p>The potential of mean force for this result</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.free_energy_base.Series">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">Series</code><span class="sig-paren">(</span><em>coordinate</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Series" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Object for storing data series, i.e. some value that changes
as a function of some coordinate. Designed to act as a base class
for PMF classes.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.Series.as_floats" title="protomslib.free_energy.free_energy_base.Series.as_floats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_floats</span></code></a>()</td>
<td>Return a numpy array containing the values of the data series as floats without error values.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.Series.plot" title="protomslib.free_energy.free_energy_base.Series.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>(axes[,&nbsp;show_error,&nbsp;fmt,&nbsp;xlabel,&nbsp;ylabel])</td>
<td>Plot this PMF onto the provided figure axes.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.Series.as_floats">
<code class="descname">as_floats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Series.as_floats" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numpy array containing the values of the data
series as floats without error values.</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.Series.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>axes</em>, <em>show_error=True</em>, <em>fmt='-'</em>, <em>xlabel='Lambda Value'</em>, <em>ylabel='Free Energy (kcal/mol)'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.Series.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot this PMF onto the provided figure axes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>axes</strong> <span class="classifier-delimiter">:</span> <span class="classifier">matplotlib Axes object</span></dt>
<dd><p class="first last">axes onto which the figure will be drawn</p>
</dd>
<dt><strong>show_error</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first last">if True, plot error bars</p>
</dd>
<dt><strong>xlabel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">label for x-axis</p>
</dd>
<dt><strong>ylabel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">label for y-axis</p>
</dd>
<dt><strong>**kwargs :</strong></dt>
<dd><p class="first last">additional keyword arguments to be passed to axes.plot</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.free_energy_base.TI">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">TI</code><span class="sig-paren">(</span><em>lambdas</em>, <em>results_name='results'</em>, <em>subdir_glob='./'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.TI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Estimator" title="protomslib.free_energy.free_energy_base.Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.Estimator</span></code></a></p>
<p>Estimate free energy differences using Thermodynamic Integration.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.TI.add_data" title="protomslib.free_energy.free_energy_base.TI.add_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.free_energy_base.TI.calculate" title="protomslib.free_energy.free_energy_base.TI.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>([temp])</td>
<td>Calculate the free energy difference and return a PMF object.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">result_class</span></code></td>
<td>alias of <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Result" title="protomslib.free_energy.free_energy_base.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">Result</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.TI.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.TI.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>series: SnapshotResults.series</strong></dt>
<dd><p class="first last">free energy simulation data for a particular lambda value</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.free_energy_base.TI.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp=300.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.TI.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a PMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>temp: float, optional</strong></dt>
<dd><p class="first last">temperature of calculation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.free_energy_base.get_alchemical_arg_parser">
<code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">get_alchemical_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.get_alchemical_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an argument parser suitable for use with alchemical
simulation methods e.g. free energy perturbation.</p>
</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.free_energy_base.get_base_arg_parser">
<code class="descclassname">protomslib.free_energy.free_energy_base.</code><code class="descname">get_base_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.free_energy_base.get_base_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a generic argparser for all free energy calculation scripts</p>
</dd></dl>

<span class="target" id="module-protomslib.free_energy.gcmc_free_energy_base"></span><dl class="class">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCI">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">GCI</code><span class="sig-paren">(</span><em>B_values</em>, <em>volume</em>, <em>results_name='results'</em>, <em>nsteps=None</em>, <em>nmin=None</em>, <em>nmax=None</em>, <em>nfits=10</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCI" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Estimator" title="protomslib.free_energy.free_energy_base.Estimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.Estimator</span></code></a></p>
<p>Estimate insertion free energies using Grand Canonical Integration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>N_max</strong></dt>
<dd></dd>
<dt><strong>N_min</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCI.add_data" title="protomslib.free_energy.gcmc_free_energy_base.GCI.add_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCI.calculate" title="protomslib.free_energy.gcmc_free_energy_base.GCI.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>(temp)</td>
<td>Calculate the free energy difference and return a GCMCPMF object.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">result_class</span></code></td>
<td>alias of <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Result" title="protomslib.free_energy.free_energy_base.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.Result</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCI.N_max">
<code class="descname">N_max</code><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCI.N_max" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCI.N_min">
<code class="descname">N_min</code><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCI.N_min" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCI.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCI.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>series: SnapshotResults.series</strong></dt>
<dd><p class="first last">free energy simulation data for a particular B value</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCI.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCI.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a GCMCPMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>temp: float</strong></dt>
<dd><p class="first last">Temperature of calculation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">GCMCMBAR</code><span class="sig-paren">(</span><em>lambdas</em>, <em>volume</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.free_energy.free_energy_base.MBAR" title="protomslib.free_energy.free_energy_base.MBAR"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.MBAR</span></code></a></p>
<p>Estimate free energy differences using the Multistate Bennett Acceptance
ratio for alchemical simulations performed in the Grand Canonical ensemble
at multiple B values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.Bs" title="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.Bs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Bs</span></code></a></dt>
<dd><p class="first last">Return the B value used for this calculation.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.B_to_chemical_potential" title="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.B_to_chemical_potential"><code class="xref py py-obj docutils literal notranslate"><span class="pre">B_to_chemical_potential</span></code></a>(B,&nbsp;temperature)</td>
<td>Convert a B value to the equivalent chemical potential for this simulation setup.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.add_data" title="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.add_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code></a>(series)</td>
<td>Save data from a SnapshotResults.series object for later calculation.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.calculate" title="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>([temp])</td>
<td>Calculate the free energy difference and return a PMF object.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.equilibrium_B" title="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.equilibrium_B"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equilibrium_B</span></code></a>(temperature)</td>
<td>Returns the value of B equating to equilibrium with bulk water.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">result_class</span></code></td>
<td>alias of <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Result" title="protomslib.free_energy.free_energy_base.Result"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.Result</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset</span></code>([low_bound,&nbsp;high_bound,&nbsp;step])</td>
<td>Return a new class instance containing truncated data series.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.B_to_chemical_potential">
<code class="descname">B_to_chemical_potential</code><span class="sig-paren">(</span><em>B</em>, <em>temperature</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.B_to_chemical_potential" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a B value to the equivalent chemical potential for this
simulation setup. Depends on GCMC volume of the simulation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>B: float</strong></dt>
<dd><p class="first last">the input B value</p>
</dd>
<dt><strong>temperature: float</strong></dt>
<dd><p class="first last">the simulated temperature</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.Bs">
<code class="descname">Bs</code><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.Bs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the B value used for this calculation.</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>series</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data from a SnapshotResults.series object for later
calculation. Return the length of the data series added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>series: SnapshotResults.series</strong></dt>
<dd><p class="first last">free energy simulation data for a particular simulation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>temp=300.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the free energy difference and return a PMF object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>temp: float, optional</strong></dt>
<dd><p class="first last">temperature of calculation, default 300 K</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.equilibrium_B">
<code class="descname">equilibrium_B</code><span class="sig-paren">(</span><em>temperature</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCMBAR.equilibrium_B" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of B equating to equilibrium with bulk water.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCPMF">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">GCMCPMF</code><span class="sig-paren">(</span><em>coordinate</em>, <em>values</em>, <em>volume</em>, <em>temperature</em>, <em>model</em>, <em>pmf</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCPMF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.free_energy.free_energy_base.Series" title="protomslib.free_energy.free_energy_base.Series"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.Series</span></code></a></p>
<p>A potential of mean force object for Grand Canonical calculations.
Stores occupancy data and PMF for insertion free energies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCPMF.equilibrium_B" title="protomslib.free_energy.gcmc_free_energy_base.GCMCPMF.equilibrium_B"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equilibrium_B</span></code></a></dt>
<dd><p class="first last">Returns the value of B equating to equilibrium with bulk water.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">as_floats</span></code>()</td>
<td>Return a numpy array containing the values of the data series as floats without error values.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code>(axes[,&nbsp;show_error,&nbsp;fmt,&nbsp;xlabel,&nbsp;ylabel])</td>
<td>Plot this PMF onto the provided figure axes.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCPMF.equilibrium_B">
<code class="descname">equilibrium_B</code><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCPMF.equilibrium_B" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of B equating to equilibrium with bulk water.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCResult">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">GCMCResult</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.free_energy.free_energy_base.BaseResult" title="protomslib.free_energy.free_energy_base.BaseResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.BaseResult</span></code></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCResult.B_values" title="protomslib.free_energy.gcmc_free_energy_base.GCMCResult.B_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">B_values</span></code></a></dt>
<dd><p class="first last">Return the simulated B values</p>
</dd>
<dt><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCResult.equilibrium_B" title="protomslib.free_energy.gcmc_free_energy_base.GCMCResult.equilibrium_B"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equilibrium_B</span></code></a></dt>
<dd><p class="first last">Return the B value representing equilibrium with bulk water</p>
</dd>
<dt><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.insertion_pmf" title="protomslib.free_energy.gcmc_free_energy_base.insertion_pmf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">insertion_pmf</span></code></a></dt>
<dd><p class="first last">Return a PMF object containing insertion free energies</p>
</dd>
<dt><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCResult.model" title="protomslib.free_energy.gcmc_free_energy_base.GCMCResult.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a></dt>
<dd><p class="first last">Return a Series object containing an average fitted model</p>
</dd>
<dt><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCResult.occupancies" title="protomslib.free_energy.gcmc_free_energy_base.GCMCResult.occupancies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">occupancies</span></code></a></dt>
<dd><p class="first last">Return a Series object containing occupancy data</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCResult.B_values">
<code class="descname">B_values</code><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCResult.B_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the simulated B values</p>
</dd></dl>

<dl class="attribute">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCResult.equilibrium_B">
<code class="descname">equilibrium_B</code><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCResult.equilibrium_B" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the B value representing equilibrium with bulk water</p>
</dd></dl>

<dl class="attribute">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCResult.insertion_pmf">
<code class="descname">insertion_pmf</code><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCResult.insertion_pmf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a PMF object containing insertion free energies</p>
</dd></dl>

<dl class="attribute">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCResult.model">
<code class="descname">model</code><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCResult.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Series object containing an average fitted model</p>
</dd></dl>

<dl class="attribute">
<dt id="protomslib.free_energy.gcmc_free_energy_base.GCMCResult.occupancies">
<code class="descname">occupancies</code><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.GCMCResult.occupancies" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Series object containing occupancy data</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">Slp</code><span class="sig-paren">(</span><em>x=array(0)</em>, <em>y=array(0)</em>, <em>size=1</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for fitting and storing a monotonically increasing single layer
perceptron with one input and one output.</p>
<p>Fitting is achieved by iteratively optimising one unit at a time,
rather than the more typical back-propigation algorithm, to make use of
SciPy’s monotonic optimisation routines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">the number logsistic terms, equilivalent to the number of
‘hidden units’ in an artificial neural network</p>
</dd>
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><p class="first last">the explanatory variable, which is the Adams value or
chemical potential in GCMC</p>
</dd>
<dt><strong>y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><p class="first last">the response variable, which is the average number of
inserted grand canonical molecules</p>
</dd>
<dt><strong>weights</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><p class="first last">the matrix of coefficients of the logistic terms</p>
</dd>
<dt><strong>offset</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><p class="first last">the intercept of the artificial neural network. Grouped
together with the weights when fitting</p>
</dd>
<dt><strong>streams</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">contains the output of each logistic function or ‘unit’</p>
</dd>
<dt><strong>predicted</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><p class="first last">the predicted output of the artificial neural network</p>
</dd>
<dt><strong>error: float</strong></dt>
<dd><p class="first last">the error (either mean-squared, Huber, or absolute loss) of the
artificial neural network with respect to the response variable.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.absolute" title="protomslib.free_energy.gcmc_free_energy_base.Slp.absolute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">absolute</span></code></a>()</td>
<td>Calculates the absolute loss of the model and updates the error</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.epoch" title="protomslib.free_energy.gcmc_free_energy_base.Slp.epoch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">epoch</span></code></a>([grad_tol,&nbsp;pin_min,&nbsp;pin_max,&nbsp;…])</td>
<td>Fits each unit and intercept of the artificial neural network once</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.fit_offset" title="protomslib.free_energy.gcmc_free_energy_base.Slp.fit_offset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_offset</span></code></a>([grad_tol,&nbsp;cost,&nbsp;c])</td>
<td>Fits the intercept of the artificial neural network</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.fit_unit" title="protomslib.free_energy.gcmc_free_energy_base.Slp.fit_unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_unit</span></code></a>(unit[,&nbsp;grad_tol,&nbsp;pin_max,&nbsp;…])</td>
<td>Fits an individual unit of the artificial neural network</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.forward" title="protomslib.free_energy.gcmc_free_energy_base.Slp.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>()</td>
<td>Evaluates the output from ALL units for a given set of weights and updates the prediction of the whole network</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.forward_unit" title="protomslib.free_energy.gcmc_free_energy_base.Slp.forward_unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward_unit</span></code></a>(unit)</td>
<td>Evaluates the output from ONE unit for a given set of weights and updates the prediction of the whole network</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.huber" title="protomslib.free_energy.gcmc_free_energy_base.Slp.huber"><code class="xref py py-obj docutils literal notranslate"><span class="pre">huber</span></code></a>([c])</td>
<td>Calculates the pseudo Huber loss function and updates the error of the model</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.msd" title="protomslib.free_energy.gcmc_free_energy_base.Slp.msd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">msd</span></code></a>()</td>
<td>Calculates the mean-squared error of the model and updates the error</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.predict" title="protomslib.free_energy.gcmc_free_energy_base.Slp.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(x)</td>
<td>Returns the prediction for the artificial neural network</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.randomise" title="protomslib.free_energy.gcmc_free_energy_base.Slp.randomise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">randomise</span></code></a>([pin_max])</td>
<td>Produces initial values of weights by random sampling</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.randsearch" title="protomslib.free_energy.gcmc_free_energy_base.Slp.randsearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">randsearch</span></code></a>(samples)</td>
<td>Performs a crude initial random search of the space of weights, and saves the best set of weights</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.train" title="protomslib.free_energy.gcmc_free_energy_base.Slp.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>([iterations,&nbsp;grad_tol_low,&nbsp;…])</td>
<td>Iterates over a specified amount of training epochs.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.absolute">
<code class="descname">absolute</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.absolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the absolute loss of the model and updates the error</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.epoch">
<code class="descname">epoch</code><span class="sig-paren">(</span><em>grad_tol=0.001</em>, <em>pin_min=None</em>, <em>pin_max=None</em>, <em>monotonic=True</em>, <em>cost='msd'</em>, <em>c=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits each unit and intercept of the artificial neural network once</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>grad_tol</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the tolorance of the gradient that determines when optimisation stops</p>
</dd>
<dt><strong>pin_min</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the value of the fixed intercept. If None, it will be fitted.</p>
</dd>
<dt><strong>pin_max</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the value of the maximum value to model can produce.
If None, it will be fitted</p>
</dd>
<dt><strong>monotonic</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first last">whether to insure the artificial neural
network is monotonically increasing</p>
</dd>
<dt><strong>cost</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the type of cost/loss function that will be used
can be ‘msd’, ‘abs’ or ‘huber’</p>
</dd>
<dt><strong>c</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the paramater of the huber loss function</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.fit_offset">
<code class="descname">fit_offset</code><span class="sig-paren">(</span><em>grad_tol=0.001</em>, <em>cost='msd'</em>, <em>c=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.fit_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the intercept of the artificial neural network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>grad_tol</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the tolorance of the gradient that determines when optimisation stops</p>
</dd>
<dt><strong>cost</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><dl class="first last docutils">
<dt>the type of cost/loss function that will be used</dt>
<dd><p class="first last">can be ‘msd’, ‘abs’ or ‘huber’</p>
</dd>
</dl>
</dd>
<dt><strong>c</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the paramater of the Huber loss function</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.fit_unit">
<code class="descname">fit_unit</code><span class="sig-paren">(</span><em>unit</em>, <em>grad_tol=0.001</em>, <em>pin_max=None</em>, <em>monotonic=True</em>, <em>cost='msd'</em>, <em>c=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.fit_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits an individual unit of the artificial neural network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>unit</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the index of the logistic function whose weights
(parameters) will be optimised</p>
</dd>
<dt><strong>grad_tol</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the tolorance of the gradient that determines when optimisation stops</p>
</dd>
<dt><strong>pin_max</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the value of the maximum value to model can produce.
If None, it will be fitted</p>
</dd>
<dt><strong>monotonic</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first last">whether to insure the artificial neural network is
monotonically increasing</p>
</dd>
<dt><strong>cost</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the type of cost/loss function that will be used
can be ‘msd’, ‘abs’ or ‘huber’</p>
</dd>
<dt><strong>c</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the paramater of the Huber loss function</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the output from ALL units for a given set of weights
and updates the prediction of the whole network</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.forward_unit">
<code class="descname">forward_unit</code><span class="sig-paren">(</span><em>unit</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.forward_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the output from ONE unit for a given set of weights
and updates the prediction of the whole network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>unit</strong> <span class="classifier-delimiter">:</span> <span class="classifier">the index of the logisitic function</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.huber">
<code class="descname">huber</code><span class="sig-paren">(</span><em>c=2</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.huber" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the pseudo Huber loss function and
updates the error of the model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>c</strong> <span class="classifier-delimiter">:</span> <span class="classifier">number</span></dt>
<dd><p class="first last">the pseudo Huber loss function parameter</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.msd">
<code class="descname">msd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.msd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean-squared error of the model and updates the error</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the prediction for the artificial neural network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">the vector of Adams or chemical potentials</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.randomise">
<code class="descname">randomise</code><span class="sig-paren">(</span><em>pin_max=True</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.randomise" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces initial values of weights by random sampling</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>pin_max</strong> <span class="classifier-delimiter">:</span> <span class="classifier">whether to constrain the random weights so that the sum</span></dt>
<dd><p class="first last">of the units cannot exceed the maximum value of the response variable</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.randsearch">
<code class="descname">randsearch</code><span class="sig-paren">(</span><em>samples</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.randsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a crude initial random search of the space of weights,
and saves the best set of weights</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>samples</strong> <span class="classifier-delimiter">:</span> <span class="classifier">how many initial guesses of the weights shall be attempted</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.Slp.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>iterations=100</em>, <em>grad_tol_low=-3</em>, <em>grad_tol_high=1</em>, <em>pin_min=None</em>, <em>pin_max=None</em>, <em>monotonic=True</em>, <em>cost='msd'</em>, <em>c=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.Slp.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterates over a specified amount of training epochs. After each epoch,
the fitting tolerance will decrease to gradually refine the fits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>iterations</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the maximum number of training epochs that will be tested.</p>
</dd>
<dt><strong>grad_tol_low</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">ten to the power of this value is the
initial tolerance of the gradient</p>
</dd>
<dt><strong>grad_tol_high</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">ten to the power of this value is the final tolerance of the gradient</p>
</dd>
<dt><strong>pin_min</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the value of the fixed intercept. If left blank, it will be fitted.</p>
</dd>
<dt><strong>pin_max</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the value of the maximum value to model can produce.
If None, it will be fitted</p>
</dd>
<dt><strong>monotonic</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first last">whether to insure the artificial neural network
is monotonically increasing</p>
</dd>
<dt><strong>cost</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the type of cost/loss function that will be used
can be ‘msd’, ‘abs’ or ‘huber’</p>
</dd>
<dt><strong>c</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the paramater of the huber loss function</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.gcmc_free_energy_base.TitrationCalculation">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">TitrationCalculation</code><span class="sig-paren">(</span><em>root_paths</em>, <em>temperature</em>, <em>volume</em>, <em>nsteps=None</em>, <em>nmin=None</em>, <em>nmax=None</em>, <em>nfits=5</em>, <em>pin_min=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.TitrationCalculation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.free_energy.free_energy_base.FreeEnergyCalculation" title="protomslib.free_energy.free_energy_base.FreeEnergyCalculation"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.free_energy.free_energy_base.FreeEnergyCalculation</span></code></a></p>
<p>Calculate free energy differences using the Grand Canonical Integration
method. Collates water occupancy data from simulations carried out at
diferent chemical potentials and gives NVT binding free energies.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.gcmc_free_energy_base.TitrationCalculation.calculate" title="protomslib.free_energy.gcmc_free_energy_base.TitrationCalculation.calculate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate</span></code></a>([subset])</td>
<td>For each estimator return the evaluated potential of mean force.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>(args)</td>
<td>Public method for execution of calculation.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.gcmc_free_energy_base.TitrationCalculation.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>subset=(0.0</em>, <em>1.0</em>, <em>1)</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.TitrationCalculation.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>For each estimator return the evaluated potential of mean force.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>subset: tuple of two floats and an int</strong></dt>
<dd><p class="first last">specify the subset of data to use in the calculation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.gcmc_free_energy_base.fit_ensemble">
<code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">fit_ensemble</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>size</em>, <em>repeats=20</em>, <em>randstarts=1000</em>, <em>iterations=100</em>, <em>grad_tol_low=-3</em>, <em>grad_tol_high=1</em>, <em>pin_min=False</em>, <em>pin_max=None</em>, <em>monotonic=True</em>, <em>cost='msd'</em>, <em>c=2.0</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.fit_ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a collection of ANN models to GCMC titration data. Each ANN
is fitted with different set of initial ANN weights.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><p class="first last">the B/Adams values or chemical potentials used in a titration</p>
</dd>
<dt><strong>y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><p class="first last">the average value of water at each chemical potential</p>
</dd>
<dt><strong>repeats</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the number of repeats of the fitting. This gives the “ensemble” of models</p>
</dd>
<dt><strong>others</strong></dt>
<dd><p class="first last">As specified in Slp.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.gcmc_free_energy_base.get_gci_arg_parser">
<code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">get_gci_arg_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.get_gci_arg_parser" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.gcmc_free_energy_base.insertion_pmf">
<code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">insertion_pmf</code><span class="sig-paren">(</span><em>N</em>, <em>gcmc_model</em>, <em>volume</em>, <em>T=298.15</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.insertion_pmf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the free energy to insert water from ideal gas to
the GCMC volume.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>N</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><p class="first last">vector of bound water numbers between which relative
free energies will be calculated</p>
</dd>
<dt><strong>gcmc_model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Slp object</span></dt>
<dd><p class="first last">an ANN model (single layer perceptron) that will
be used to calculate the free energy</p>
</dd>
<dt><strong>volume</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the volume of the GCMC region in Angstroms^3</p>
</dd>
<dt><strong>T</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the temperature of the simulation in Kelvin</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.gcmc_free_energy_base.integrated_logistic">
<code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">integrated_logistic</code><span class="sig-paren">(</span><em>params</em>, <em>Bi</em>, <em>Bf</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.integrated_logistic" title="Permalink to this definition">¶</a></dt>
<dd><p>The integral of the logistic function, for use in the function
“insertion_pmf”. The problem is that it is prone to numerical instabilities
when the exponents are large and positive. While one could fix the problem,
I’ve opted for numerical integration instead in “insertion_pmf”.
This function has been used to verify the numerical integration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list or numpy array</span></dt>
<dd><p class="first last">the parameters of the logistic function</p>
</dd>
<dt><strong>Bi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the lower value of the interval of integration</p>
</dd>
<dt><strong>Bf</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the higher value of the interval of integration</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.gcmc_free_energy_base.inverse_slp">
<code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">inverse_slp</code><span class="sig-paren">(</span><em>model</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.inverse_slp" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given ANN model, this function returns the value of x that
corresponds to the value of y. It’s basically the inverse function of an
ANN. Used to determine which B value produces a given average of waters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Slp object</span></dt>
<dd><p class="first last">the ANN (single layer perceptron) to return the inverse function of</p>
</dd>
<dt><strong>y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the value which you want to find the corresponding value of x</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.gcmc_free_energy_base.logistic">
<code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">logistic</code><span class="sig-paren">(</span><em>params</em>, <em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.logistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Logistic function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list or numpy array</span></dt>
<dd><p class="first last">the three parameters of the logistic function</p>
</dd>
<dt><strong>x</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><p class="first last">the explanatory variable</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.gcmc_free_energy_base.plot_insertion_pmf">
<code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">plot_insertion_pmf</code><span class="sig-paren">(</span><em>results</em>, <em>title=''</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.plot_insertion_pmf" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to plot the insertion pmf data from repeats</p>
</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.gcmc_free_energy_base.plot_titration">
<code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">plot_titration</code><span class="sig-paren">(</span><em>results</em>, <em>ax</em>, <em>dot_fmt='b'</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.plot_titration" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to plot the titration data from repeats.</p>
</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.gcmc_free_energy_base.pseudohuber">
<code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">pseudohuber</code><span class="sig-paren">(</span><em>r</em>, <em>c</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.pseudohuber" title="Permalink to this definition">¶</a></dt>
<dd><p>The pseudo Huber loss/cost function. Smooth version of Huber loss function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>r</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">residual, i.e. difference between predicted value and its target</p>
</dd>
<dt><strong>c</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">parameter that determines roughly where residuals will have less weight</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.free_energy.gcmc_free_energy_base.simplex_sample">
<code class="descclassname">protomslib.free_energy.gcmc_free_energy_base.</code><code class="descname">simplex_sample</code><span class="sig-paren">(</span><em>size</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.gcmc_free_energy_base.simplex_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples uniformly over a simplex, such that the output sums to 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">the number of random numbers you want</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-protomslib.free_energy.table"></span><p>Collection of classes to handle output table formatting</p>
<dl class="class">
<dt id="protomslib.free_energy.table.Column">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.table.</code><code class="descname">Column</code><span class="sig-paren">(</span><em>header=''</em>, <em>value_fmt='%.4f'</em>, <em>error_fmt='%.4f'</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.table.Column" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Table column entry.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><a class="reference internal" href="#protomslib.free_energy.table.Column.width" title="protomslib.free_energy.table.Column.width"><code class="xref py py-obj docutils literal notranslate"><span class="pre">width</span></code></a></dt>
<dd><p class="first last">Width of the column in number of characters</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.table.Column.add_data" title="protomslib.free_energy.table.Column.add_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code></a>(data)</td>
<td>Add a entry to this column.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.table.Column.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.table.Column.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a entry to this column.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>data: Quantity object or number</strong></dt>
<dd><p class="first last">entry to add</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="protomslib.free_energy.table.Column.width">
<code class="descname">width</code><a class="headerlink" href="#protomslib.free_energy.table.Column.width" title="Permalink to this definition">¶</a></dt>
<dd><p>Width of the column in number of characters</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.table.SubColumn">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.table.</code><code class="descname">SubColumn</code><span class="sig-paren">(</span><em>fmt='%.4f'</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.table.SubColumn" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The left or right side of a Column.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.table.SubColumn.add_data" title="protomslib.free_energy.table.SubColumn.add_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code></a>(data)</td>
<td>Add a entry to this subcolumn.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.table.SubColumn.add_data">
<code class="descname">add_data</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.table.SubColumn.add_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a entry to this subcolumn.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>data: number</strong></dt>
<dd><p class="first last">entry to add</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.free_energy.table.Table">
<em class="property">class </em><code class="descclassname">protomslib.free_energy.table.</code><code class="descname">Table</code><span class="sig-paren">(</span><em>title</em>, <em>fmts</em>, <em>headers=[]</em>, <em>space=3</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.table.Table" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Output table for displaying data</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.free_energy.table.Table.add_blank_row" title="protomslib.free_energy.table.Table.add_blank_row"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_blank_row</span></code></a>()</td>
<td>Add a blank row to the table.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.free_energy.table.Table.add_row" title="protomslib.free_energy.table.Table.add_row"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_row</span></code></a>(data)</td>
<td>Add a row to the table.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.free_energy.table.Table.add_blank_row">
<code class="descname">add_blank_row</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.table.Table.add_blank_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a blank row to the table.</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.free_energy.table.Table.add_row">
<code class="descname">add_row</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.free_energy.table.Table.add_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a row to the table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>data: list of objects</strong></dt>
<dd><p class="first last">table entries for this run, objects must be convertable to
strings according to the corresponding column format</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-protomslib.gcmc">
<span id="gcmc"></span><h2>GCMC<a class="headerlink" href="#module-protomslib.gcmc" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="protomslib.gcmc.clear_gcmcbox">
<code class="descclassname">protomslib.gcmc.</code><code class="descname">clear_gcmcbox</code><span class="sig-paren">(</span><em>gcmcbox</em>, <em>waters</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.gcmc.clear_gcmcbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes solvent molecules from the GCMC/JAWS-1 box as they will not be
able to move during the simulation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>gcmcbox</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or PDBFile object</span></dt>
<dd><p class="first last">the gcmcbox</p>
</dd>
<dt><strong>waters</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or PDBFile object</span></dt>
<dd><p class="first last">the water molecule to check</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>int</strong></dt>
<dd><p class="first last">the number of removed water molecules</p>
</dd>
<dt><strong>PDBFile</strong></dt>
<dd><p class="first last">the cleared solvation box</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.gcmc.distribute_particles">
<code class="descclassname">protomslib.gcmc.</code><code class="descname">distribute_particles</code><span class="sig-paren">(</span><em>box</em>, <em>particles</em>, <em>watermodel='t4p'</em>, <em>resname='WA1'</em>, <em>partnumb=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.gcmc.distribute_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly distribute molecules in a box</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>box</strong> <span class="classifier-delimiter">:</span> <span class="classifier">a list or dictionary</span></dt>
<dd><p class="first last">the origin and length of the box
where the molecules will be placed</p>
</dd>
<dt><strong>particles</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or PDB object</span></dt>
<dd><p class="first last">the number of waters to include in the box
or the pdb object or filename with the molecules
to include in the box</p>
</dd>
<dt><strong>watermodel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">(only used when particles is a number)
for instance, “t4p”, “tip4p”, “t3p” “tip3p”,
the water model for the generated waters</p>
</dd>
<dt><strong>partnumb</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string,optional</span></dt>
<dd><p class="first last">(only used when particles is a file)
the number of particles. If not specified it is set
to be as many as there are in the file</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>pdb object</strong></dt>
<dd><p class="first last">the pdb object with the molecules
distributed randomly in the box</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.gcmc.make_gcmcbox">
<code class="descclassname">protomslib.gcmc.</code><code class="descname">make_gcmcbox</code><span class="sig-paren">(</span><em>pdb</em>, <em>filename</em>, <em>padding=2.0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.gcmc.make_gcmcbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a GCMC/JAWS-1 simulation box around a PDB-structure</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>pdb</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile object</span></dt>
<dd><p class="first last">the PDB structure</p>
</dd>
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the output file</p>
</dd>
<dt><strong>padding</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">the amount of extra space around the ligand to add</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.gcmc.print_bequil">
<code class="descclassname">protomslib.gcmc.</code><code class="descname">print_bequil</code><span class="sig-paren">(</span><em>boxlen</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.gcmc.print_bequil" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-protomslib.prepare">
<span id="prepare"></span><h2>Prepare<a class="headerlink" href="#module-protomslib.prepare" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="protomslib.prepare.make_dummy">
<code class="descclassname">protomslib.prepare.</code><code class="descname">make_dummy</code><span class="sig-paren">(</span><em>pdbfile</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.make_dummy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a dummy PDB structure to match a molecule</p>
<p>It will place the dummy at the centre of the molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pdbfile</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or PDBFile</span></dt>
<dd><p class="first last">the pdb structure of the molecule</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>PDBFile instance</strong></dt>
<dd><p class="first last">the dummy structure</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.prepare.pdb2pms">
<code class="descclassname">protomslib.prepare.</code><code class="descname">pdb2pms</code><span class="sig-paren">(</span><em>pdb_in</em>, <em>forcefield</em>, <em>conversion_file</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.pdb2pms" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert atom names to ProtoMS standard</p>
<p>The protein object is not modified by this routine, but the Residue
and Atom objects are.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pdb_in</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile</span></dt>
<dd><p class="first last">the pdb file to modify inline</p>
</dd>
<dt><strong>forcefield</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the style of the input PDB-file</p>
</dd>
<dt><strong>conversion_file :</strong></dt>
<dd><p class="first last">a file with conversion rules</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>a PDBFile instance with ProtoMS names</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.prepare.read_convfile">
<code class="descclassname">protomslib.prepare.</code><code class="descname">read_convfile</code><span class="sig-paren">(</span><em>file=None</em>, <em>inmode=None</em>, <em>outmode=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.read_convfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a conversion file into a dictionary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>file</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the filename of the conversion file</p>
</dd>
<dt><strong>inmode</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the style of the input PDB-file</p>
</dd>
<dt><strong>outmode</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the style of the output PDB-file</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>a dictionary of the conversion</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ValueError</strong></dt>
<dd><p class="first last">if any of the parameters are none</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.prepare.run_antechamber">
<code class="descclassname">protomslib.prepare.</code><code class="descname">run_antechamber</code><span class="sig-paren">(</span><em>lig</em>, <em>charge</em>, <em>resnam=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.run_antechamber" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for antechamber with default parameters and AM1-BCC charges</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>lig</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile or string</span></dt>
<dd><p class="first last">the ligand to run Antechamber on</p>
</dd>
<dt><strong>charge</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the net charge of the ligand</p>
</dd>
<dt><strong>resnam</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">the residue name of the ligand</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>string</strong></dt>
<dd><p class="first last">the filename of the created prepi file</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.prepare.run_parmchk">
<code class="descclassname">protomslib.prepare.</code><code class="descname">run_parmchk</code><span class="sig-paren">(</span><em>lig</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.run_parmchk" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for parmcheck with default parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>lig</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile or string</span></dt>
<dd><p class="first last">the ligand to run Parmcheck on</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>string</strong></dt>
<dd><p class="first last">the filename of the created frcmod file</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-protomslib.prepare.scoop"></span><dl class="function">
<dt id="protomslib.prepare.scoop.scoop">
<code class="descclassname">protomslib.prepare.scoop.</code><code class="descname">scoop</code><span class="sig-paren">(</span><em>protein</em>, <em>ligand</em>, <em>innercut=16</em>, <em>outercut=20</em>, <em>flexin='full'</em>, <em>flexout='sidechain'</em>, <em>terminal='neutralize'</em>, <em>excluded=[]</em>, <em>added=[]</em>, <em>scooplimit=10</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.scoop.scoop" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a scoop from protein structure</p>
<p>The protein object is not modified by this routine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>protein</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile</span></dt>
<dd><p class="first last">pdb instance for the protein to be scooped</p>
</dd>
<dt><strong>ligand</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile or string</span></dt>
<dd><p class="first last">Either pdb instance for ligand to be scooped around, or string giving
the name of a file containing 3 floats to act as coords for scoop
centre, or a string with three floating point numbers</p>
</dd>
<dt><strong>innercut</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Maximum distance from ligand defining inner region of the scoop</p>
</dd>
<dt><strong>outercut</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Maximum distance from ligand defining outer region of the scoop</p>
</dd>
<dt><strong>flexin</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">Gives the degree of flexibility for residues of the inner region
Can be ‘rigid’, ‘sidechain’ or ‘flexible’</p>
</dd>
<dt><strong>flexout</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">As flexin but for residues of the outer scoop</p>
</dd>
<dt><strong>terminal</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">Determines what to do with terminal residues
Can be ‘keep’, ‘doublekeep’,’neutralize’</p>
</dd>
<dt><strong>excluded</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of int</span></dt>
<dd><p class="first last">List of indices for residues to be excluded from scoop</p>
</dd>
<dt><strong>added</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of int</span></dt>
<dd><p class="first last">List of indices for residues to be included in outer scoop</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>PDBFile</strong></dt>
<dd><p class="first last">an object representing the scooped protein</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-protomslib.prepare.water"></span><dl class="function">
<dt id="protomslib.prepare.water.alignhydrogens">
<code class="descclassname">protomslib.prepare.water.</code><code class="descname">alignhydrogens</code><span class="sig-paren">(</span><em>watcoords</em>, <em>template</em>, <em>tol=1e-06</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.water.alignhydrogens" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Rotates a template water molecule such that it has the same orientation
as a reference water molecule. Useful for converting between different
water models in cases when one wishes to retain the same orientations
of hydrogens. It assumes that both the template and the reference water
have maching oxygen locations.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>watcoords</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><blockquote class="first">
<div><p>the coordinates of the water molecule that will be aligned to.
The first row must be the x,y,z coordinates of the oxygen atom.</p>
<blockquote>
<div><p>Hydrogens must be present in the proceeding two rows</p>
</div></blockquote>
</div></blockquote>
<dl class="last docutils">
<dt>template <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><p class="first last">the template water molecule whose hydrogens will be aligned to match
that of watcoords. Does not have to be same water model
(e.g. tip4p versus spc) as watcoords.</p>
</dd>
<dt>tol <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the tolerance level for the BFGS solver. At a tolerance level of 0.1,
orientating 1000 water molecules takes about 10s. With a lower
tolerance, alignment is more accurate, but can take up to 17s
per 1000 waters.</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy array</strong></dt>
<dd><p class="first last">the rotated set of water coordinates.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.prepare.water.convertwater">
<code class="descclassname">protomslib.prepare.water.</code><code class="descname">convertwater</code><span class="sig-paren">(</span><em>pdb_in</em>, <em>watermodel</em>, <em>ignorH=False</em>, <em>watresname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.water.convertwater" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts water in a pdb object to ideal water geometries of an input model</p>
<p>The protein object is not modified by this routine, but the Residue
and Atom objects are.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pdb_in</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile</span></dt>
<dd><p class="first last">the PDB object containing the water molecules that will be converted</p>
</dd>
<dt><strong>watermodel</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the water model that will be used in the transformtation,
e.g. tip4p, t3p.</p>
</dd>
<dt><strong>ignorH</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">whether to ignore hydrogens in the input water.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>PDBFile</strong></dt>
<dd><p class="first last">a pdb file whose solvent elements have the geometry of the
desired solvent model</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.prepare.water.rotatesolute">
<code class="descclassname">protomslib.prepare.water.</code><code class="descname">rotatesolute</code><span class="sig-paren">(</span><em>solutecoords</em>, <em>alpha</em>, <em>beta</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.water.rotatesolute" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Rotates a molecule about the centre of geometry (the mean of x,y,z of
each atom in the molecule).</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>solutecoords</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><blockquote class="first">
<div><p>the coordinates of the molecule.</p>
</div></blockquote>
<dl class="last docutils">
<dt>alpha <span class="classifier-delimiter">:</span> <span class="classifier">float or integer</span></dt>
<dd><p class="first last">the angle (in radians) by which rotation is performed about the x-axis.</p>
</dd>
<dt>beta <span class="classifier-delimiter">:</span> <span class="classifier">float or integer</span></dt>
<dd><p class="first last">the angle (in radians) by which rotation is performed about the y-axis.</p>
</dd>
<dt>gamma <span class="classifier-delimiter">:</span> <span class="classifier">float or integer</span></dt>
<dd><p class="first last">the angle (in radians) by which rotation is performed about the z-axis.</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy array</strong></dt>
<dd><p class="first last">the rotated set of molecule coordinates.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.prepare.water.rotatewat">
<code class="descclassname">protomslib.prepare.water.</code><code class="descname">rotatewat</code><span class="sig-paren">(</span><em>watcoords</em>, <em>alpha</em>, <em>beta</em>, <em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.water.rotatewat" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Rotates a water molecule about the oxygen atom, which is assumed to be
the first element in the coordinate array.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>watcoords</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy array</span></dt>
<dd><blockquote class="first">
<div><p>the coordinates of the water molecule. The first row must be the x,y,z
coordinates of the oxygen atom. Hydrogens must be present in the
proceeding two rows</p>
</div></blockquote>
<dl class="last docutils">
<dt>alpha <span class="classifier-delimiter">:</span> <span class="classifier">float or integer</span></dt>
<dd><p class="first last">the angle (in radians) by which rotation is performed about the x-axis.</p>
</dd>
<dt>beta <span class="classifier-delimiter">:</span> <span class="classifier">float or integer</span></dt>
<dd><p class="first last">the angle (in radians) by which rotation is performed about the y-axis.</p>
</dd>
<dt>gamma <span class="classifier-delimiter">:</span> <span class="classifier">float or integer</span></dt>
<dd><p class="first last">the angle (in radians) by which rotation is performed about the z-axis.</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy array</strong></dt>
<dd><p class="first last">the rotated set of water coordinates.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.prepare.water.set_jaws2_box">
<code class="descclassname">protomslib.prepare.water.</code><code class="descname">set_jaws2_box</code><span class="sig-paren">(</span><em>water_files</em>, <em>length=3</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.water.set_jaws2_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the header of the pdbs containing one single
molecule to define a box around the first atom</p>
<dl class="docutils">
<dt>water_files <span class="classifier-delimiter">:</span> <span class="classifier">PDBSet</span></dt>
<dd>a pdb set containing the pdb files with one molecule</dd>
<dt>length <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>the dimensions of the box around the molecule</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="protomslib.prepare.water.split_waters">
<code class="descclassname">protomslib.prepare.water.</code><code class="descname">split_waters</code><span class="sig-paren">(</span><em>waters</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.prepare.water.split_waters" title="Permalink to this definition">¶</a></dt>
<dd><p>Split waters in a PDB file to many PDB-files for JAWS-2</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>waters</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or PDBFile object</span></dt>
<dd><p class="first last">the PDB structure</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>PDBSet</strong></dt>
<dd><p class="first last">single waters</p>
</dd>
<dt><strong>PDBSet</strong></dt>
<dd><p class="first last">excluding single waters</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-protomslib.simulationobjects">
<span id="simulation-objects"></span><h2>Simulation Objects<a class="headerlink" href="#module-protomslib.simulationobjects" title="Permalink to this headline">¶</a></h2>
<p>Useful classes for setup and analysis of ProtoMS simulations.
Contain classes to</p>
<blockquote>
<div><ol class="arabic simple">
<li>Read, modify and write structures in PDB format</li>
<li>Store parameter collections</li>
<li>Read and store ProtoMS results files</li>
<li>Read, modify and write ProtoMS template files</li>
</ol>
</div></blockquote>
<dl class="class">
<dt id="protomslib.simulationobjects.Atom">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">Atom</code><span class="sig-paren">(</span><em>index=0</em>, <em>name='?'</em>, <em>resname='???'</em>, <em>resindex=0</em>, <em>coords=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for holding a PDB atom record</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>index</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">the number of the atom in the pdb file</p>
</dd>
<dt><strong>resindex</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">the number of the residue in the pdb file</p>
</dd>
<dt><strong>name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the atom</p>
</dd>
<dt><strong>resname</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the residue</p>
</dd>
<dt><strong>coords</strong> <span class="classifier-delimiter">:</span> <span class="classifier">NumpyArray</span></dt>
<dd><p class="first last">Cartesian coordinates</p>
</dd>
<dt><strong>type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">either atom or hetatm</p>
</dd>
<dt><strong>element</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the element of the atom</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.Atom.getElement" title="protomslib.simulationobjects.Atom.getElement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getElement</span></code></a>()</td>
<td>Set the element of this atom</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.Atom.getElement">
<code class="descname">getElement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.Atom.getElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the element of this atom</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.AtomSet">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">AtomSet</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.AtomSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a set of atoms and their associated parameter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>atoms</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd><p class="first last">the atoms in this set</p>
</dd>
<dt><strong>param</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or ForceFieldParameter</span></dt>
<dd><p class="first last">the parameter associated with the atoms</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.AtomSet.parse" title="protomslib.simulationobjects.AtomSet.parse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.AtomSet.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.AtomSet.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>record</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the line to parse from</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.DihParameter">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">DihParameter</code><span class="sig-paren">(</span><em>index</em>, <em>ats</em>, <em>terms</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.DihParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a dihedral parameter from a ProtoMS template file</p>
<p>A separate class is needed to handle dihedral parameters due to their
composition of multiple terms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>index</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">the serial number of the parameter</p>
</dd>
<dt><strong>ats</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of string</span></dt>
<dd><p class="first last">the name of the atoms associated with the parameter</p>
</dd>
<dt><strong>b0</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of DihTerm</span></dt>
<dd><p class="first last">the terms that make up this dihedral parameter</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.DihTerm">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">DihTerm</code><span class="sig-paren">(</span><em>index</em>, <em>k1</em>, <em>k2</em>, <em>k3</em>, <em>k4</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.DihTerm" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold individual terms making up a Dihedral</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>index</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">the serial number of the parameter</p>
</dd>
<dt><strong>k1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The term barrier height</p>
</dd>
<dt><strong>k2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">OPLS inversion constant (should be either 0.0 or 1.0 for AMBER ffs)</p>
</dd>
<dt><strong>k3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The term periodicity</p>
</dd>
<dt><strong>k4</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The term phase</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.EnergyResults">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">EnergyResults</code><span class="sig-paren">(</span><em>line=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.EnergyResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold energy results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>curr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the energy at the current lambda</p>
</dd>
<dt><strong>back</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the energy at the previous lambda</p>
</dd>
<dt><strong>forward</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the energy at the next lambda</p>
</dd>
<dt><strong>type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">a label</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.EnergyResults.parse_line" title="protomslib.simulationobjects.EnergyResults.parse_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_line</span></code></a>(line)</td>
<td>Parse energies from the result file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.EnergyResults.parse_line">
<code class="descname">parse_line</code><span class="sig-paren">(</span><em>line</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.EnergyResults.parse_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse energies from the result file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>line</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the line to parse</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.ForceFieldParameter">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">ForceFieldParameter</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.ForceFieldParameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a general parameter set</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>key</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">a label</p>
</dd>
<dt><strong>index</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">a serial number</p>
</dd>
<dt><strong>params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">either a list of strings or
a list of ForceFieldParameter, containing
the actual parameters</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.ForceFieldParameter.parse" title="protomslib.simulationobjects.ForceFieldParameter.parse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.ForceFieldParameter.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.ForceFieldParameter.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>record</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the line to parse from</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.MolTemplate">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">MolTemplate</code><a class="headerlink" href="#protomslib.simulationobjects.MolTemplate" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a ProtoMS template</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the template</p>
</dd>
<dt><strong>type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the kind of template, e.g. solute</p>
</dd>
<dt><strong>translate</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the translation displacement</p>
</dd>
<dt><strong>rot</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the rotational displacement</p>
</dd>
<dt><strong>atoms</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of TemplateAtom objects</span></dt>
<dd><p class="first last">the atoms in this template</p>
</dd>
<dt><strong>connectivity</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of TemplateConnectivity objects</span></dt>
<dd><p class="first last">the connectivity in this template</p>
</dd>
<dt><strong>variables</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of string</span></dt>
<dd><p class="first last">the variable geometries</p>
</dd>
<dt><strong>atomclass</strong> <span class="classifier-delimiter">:</span> <span class="classifier">TemplateAtom class</span></dt>
<dd><p class="first last">the class to create objects of atoms</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.MolTemplate.parse_from" title="protomslib.simulationobjects.MolTemplate.parse_from"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_from</span></code></a>(fileobj)</td>
<td>Parse a full template from a file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.MolTemplate.write_to" title="protomslib.simulationobjects.MolTemplate.write_to"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_to</span></code></a>(fileobj)</td>
<td>Write the template to disc</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.MolTemplate.write_zmat" title="protomslib.simulationobjects.MolTemplate.write_zmat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_zmat</span></code></a>(filename)</td>
<td>Write the z-matrix of this template to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.MolTemplate.parse_from">
<code class="descname">parse_from</code><span class="sig-paren">(</span><em>fileobj</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.MolTemplate.parse_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a full template from a file</p>
<p>Terminates when found another mode
or end of file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>fileobj</strong> <span class="classifier-delimiter">:</span> <span class="classifier">file object</span></dt>
<dd><p class="first last">the file to parse from</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.MolTemplate.write_to">
<code class="descname">write_to</code><span class="sig-paren">(</span><em>fileobj</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.MolTemplate.write_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the template to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>fileobj</strong> <span class="classifier-delimiter">:</span> <span class="classifier">file object</span></dt>
<dd><p class="first last">the file to write to</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.MolTemplate.write_zmat">
<code class="descname">write_zmat</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.MolTemplate.write_zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the z-matrix of this template to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file to write to</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.MyArgumentParser">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">MyArgumentParser</code><span class="sig-paren">(</span><em>prefix_chars='-'</em>, <em>add_fullhelp=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.MyArgumentParser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">argparse.ArgumentParser</span></code></p>
<p>Extention to ArgumentParser to allow separation of of help in to
help for most common options and full help that list all arguments</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_argument</span></code>(dest,&nbsp;…[,&nbsp;name,&nbsp;name])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_subparsers</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">error</span></code>(message)</td>
<td>Prints a usage message incorporating the message to stderr and exits.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">exit</span></code>([status,&nbsp;message])</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">format_usage</span></code>()</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_args</span></code>([args,&nbsp;namespace])</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_usage</span></code>([file])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">register</span></code>(registry_name,&nbsp;value,&nbsp;object)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_defaults</span></code>(**kwargs)</td>
<td></td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="76%" />
<col width="24%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>add_argument_group</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>add_mutually_exclusive_group</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>convert_arg_line_to_args</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>format_help</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>format_version</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>get_default</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>parse_known_args</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>print_fullhelp</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><strong>print_help</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>print_version</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.MyArgumentParser.format_help">
<code class="descname">format_help</code><span class="sig-paren">(</span><em>fullhelp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.MyArgumentParser.format_help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.MyArgumentParser.print_fullhelp">
<code class="descname">print_fullhelp</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.MyArgumentParser.print_fullhelp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.MyArgumentParser.print_help">
<code class="descname">print_help</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.MyArgumentParser.print_help" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.PDBFile">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">PDBFile</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.PDBFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for holding the atoms and residues of a PDB file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">NumPy array</span></dt>
<dd><p class="first last">the center of coordinates of all atoms</p>
</dd>
<dt><strong>header</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">additional lines to print before ATOM records</p>
</dd>
<dt><strong>name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file</p>
</dd>
<dt><strong>residues</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dictionary of Residue objects</span></dt>
<dd><p class="first last">all non-solvent residues</p>
</dd>
<dt><strong>solvents</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dictionary of Residue objects</span></dt>
<dd><p class="first last">all solvent residues</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.PDBFile.copy" title="protomslib.simulationobjects.PDBFile.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</td>
<td>Make a copy of the residues and solvents dictionaries, not the Residue and Atom objects themselves</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.PDBFile.getBox" title="protomslib.simulationobjects.PDBFile.getBox"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getBox</span></code></a>([atomlist,&nbsp;reslist])</td>
<td>Calculate the smallest box to encompass the atoms</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.PDBFile.getCenter" title="protomslib.simulationobjects.PDBFile.getCenter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getCenter</span></code></a>()</td>
<td>Calculate the center of geometry</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.PDBFile.read" title="protomslib.simulationobjects.PDBFile.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(filename)</td>
<td>Read a pdb-file from disc</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.PDBFile.read_from" title="protomslib.simulationobjects.PDBFile.read_from"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_from</span></code></a>(f[,&nbsp;resname])</td>
<td>Read a pdb structure from a fileobject</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.PDBFile.write" title="protomslib.simulationobjects.PDBFile.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>(filename,&nbsp;**kwargs)</td>
<td>Write the PDB file to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.PDBFile.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.PDBFile.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a copy of the residues and solvents dictionaries,
not the Residue and Atom objects themselves</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>PDBFile</strong></dt>
<dd><p class="first last">the newly created instance</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.PDBFile.getBox">
<code class="descname">getBox</code><span class="sig-paren">(</span><em>atomlist='all'</em>, <em>reslist='all'</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.PDBFile.getBox" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the smallest box to encompass the atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>atomlist = list, optional</strong></dt>
<dd><p class="first last">the atoms to be taken into acount to get the box</p>
</dd>
<dt><strong>reslist = list, optional</strong></dt>
<dd><p class="first last">the residues to be taken into acount to get the box</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dictionary of Numpy arrays</strong></dt>
<dd><p class="first last">the center, length and origin of the box</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.PDBFile.getCenter">
<code class="descname">getCenter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.PDBFile.getCenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the center of geometry</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>NumPy array</strong></dt>
<dd><p class="first last">the center</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.PDBFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.PDBFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a pdb-file from disc</p>
<p>It will overwrite existing residues and renumber all residues from 1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the pdb file</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.PDBFile.read_from">
<code class="descname">read_from</code><span class="sig-paren">(</span><em>f</em>, <em>resname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.PDBFile.read_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a pdb structure from a fileobject</p>
<p>Terminates reading when found a record starting with END</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>f</strong> <span class="classifier-delimiter">:</span> <span class="classifier">file object</span></dt>
<dd><p class="first last">the object to read from</p>
</dd>
<dt><strong>resname</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">the name of the residue to read, only read this</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.PDBFile.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.PDBFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the PDB file to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file</p>
</dd>
<dt><strong>renumber</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean, optional</span></dt>
<dd><p class="first last">indicate if residues should be renumbered</p>
</dd>
<dt><strong>header</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">additional lines to print before the atom records</p>
</dd>
<dt><strong>solvents</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean, optional</span></dt>
<dd><p class="first last">if to write the solvents</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.PDBSet">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">PDBSet</code><a class="headerlink" href="#protomslib.simulationobjects.PDBSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Hold a collection of PDBFile objects</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>pdbs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of PDBFile objects</span></dt>
<dd><p class="first last">the pdb files</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.PDBSet.from_residues" title="protomslib.simulationobjects.PDBSet.from_residues"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_residues</span></code></a>(pdbfile)</td>
<td>Split a PDB file into a set by residue</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.PDBSet.read" title="protomslib.simulationobjects.PDBSet.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(filename[,&nbsp;resname,&nbsp;skip,&nbsp;readmax])</td>
<td>Read a set of pdb structures from a file</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.PDBSet.write" title="protomslib.simulationobjects.PDBSet.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>(filenames[,&nbsp;solvents])</td>
<td>Write the set to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.PDBSet.from_residues">
<code class="descname">from_residues</code><span class="sig-paren">(</span><em>pdbfile</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.PDBSet.from_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a PDB file into a set by residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>pdbfile</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile object</span></dt>
<dd><p class="first last">the pdb-file to split</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.PDBSet.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em>, <em>resname=None</em>, <em>skip=0</em>, <em>readmax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.PDBSet.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a set of pdb structures from a file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file to read</p>
</dd>
<dt><strong>resname</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">the name of the residue to read, only read this</p>
</dd>
<dt><strong>skip</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">number of snapshot at the beginning to skip</p>
</dd>
<dt><strong>readmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">maximum number of snapshots to read</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.PDBSet.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filenames</em>, <em>solvents=True</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.PDBSet.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the set to disc</p>
<p>If one filename is given all PDB-files are written to one file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filenames</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings</span></dt>
<dd><p class="first last">the name of the file(s) to write to</p>
</dd>
<dt><strong>solvents</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean</span></dt>
<dd><p class="first last">if to write the solvents</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.Parameter">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">Parameter</code><span class="sig-paren">(</span><em>index</em>, <em>ats</em>, <em>k</em>, <em>b0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.Parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a parameter from a ProtoMS template file</p>
<p>Not valid for dihedral parameters but contains sufficient
information to check that a parameter exists</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>index</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">the serial number of the parameter</p>
</dd>
<dt><strong>ats</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of string</span></dt>
<dd><p class="first last">the name of the atoms associated with the parameter</p>
</dd>
<dt><strong>k</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the force constant</p>
</dd>
<dt><strong>b0</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the equilibrium value</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.ParameterSet">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">ParameterSet</code><span class="sig-paren">(</span><em>ptype</em>, <em>param_file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.ParameterSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a collection of parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>file_name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file where the parameters originated</p>
</dd>
<dt><strong>params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of Parameter objects</span></dt>
<dd><p class="first last">the parameters in this collection</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.ParameterSet.get_par_by_index" title="protomslib.simulationobjects.ParameterSet.get_par_by_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_par_by_index</span></code></a>(ind)</td>
<td>For an atm line index find matching the par line</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.ParameterSet.get_params" title="protomslib.simulationobjects.ParameterSet.get_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code></a>(ats)</td>
<td>Find parameter sets for specific atoms.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="44%" />
<col width="56%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>read</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="protomslib.simulationobjects.ParameterSet.formats">
<code class="descname">formats</code><em class="property"> = {'angle': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;), 'atm': (&lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;)}, 'bond': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;), 'atm': (&lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;)}, 'clj': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;)}, 'dihedral': {'par': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;, &lt;type 'int'&gt;), 'atm': (&lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'str'&gt;, &lt;type 'int'&gt;), 'term': (&lt;type 'str'&gt;, &lt;type 'int'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;, &lt;type 'float'&gt;)}}</em><a class="headerlink" href="#protomslib.simulationobjects.ParameterSet.formats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.ParameterSet.get_par_by_index">
<code class="descname">get_par_by_index</code><span class="sig-paren">(</span><em>ind</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.ParameterSet.get_par_by_index" title="Permalink to this definition">¶</a></dt>
<dd><p>For an atm line index find matching the par line</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.ParameterSet.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>ats</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.ParameterSet.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Find parameter sets for specific atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>ats</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sequence of strings</span></dt>
<dd><p class="first last">the query atoms</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>Parameter object</strong></dt>
<dd><p class="first last">the found parameter</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.ParameterSet.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>param_file</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.ParameterSet.read" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.Residue">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">Residue</code><span class="sig-paren">(</span><em>name='???'</em>, <em>index=0</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.Residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for holding a set of PDB atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>atoms</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of Atom objects</span></dt>
<dd><p class="first last">the atom of this residue</p>
</dd>
<dt><strong>index</strong> <span class="classifier-delimiter">:</span> <span class="classifier">integer</span></dt>
<dd><p class="first last">the number of the residue in the pdb file</p>
</dd>
<dt><strong>name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the residue</p>
</dd>
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">NumPy array</span></dt>
<dd><p class="first last">the center of coordinates of all atoms</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.Residue.addAtom" title="protomslib.simulationobjects.Residue.addAtom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">addAtom</span></code></a>(atom)</td>
<td>Adds an atom to this residue</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.Residue.getCenter" title="protomslib.simulationobjects.Residue.getCenter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getCenter</span></code></a>()</td>
<td>Sets the center of coordinates for this residue</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.Residue.isAminoacid" title="protomslib.simulationobjects.Residue.isAminoacid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isAminoacid</span></code></a>()</td>
<td>Checks is the residue name is an aminoacid name</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.Residue.addAtom">
<code class="descname">addAtom</code><span class="sig-paren">(</span><em>atom</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.Residue.addAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an atom to this residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>atom</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Atom object</span></dt>
<dd><p class="first last">the atom to add</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.Residue.getCenter">
<code class="descname">getCenter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.Residue.getCenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the center of coordinates for this residue</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.Residue.isAminoacid">
<code class="descname">isAminoacid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.Residue.isAminoacid" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks is the residue name is an aminoacid name</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.RestartFile">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">RestartFile</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.RestartFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold the information on a
restart file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the restart file</p>
</dd>
<dt><strong>nsolutes</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the number of solute molecules</p>
</dd>
<dt><strong>ngcsolutes</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the number of gcsolute molecules</p>
</dd>
<dt><strong>solutesdic</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">the correlation of solute ids
with residue names</p>
</dd>
<dt><strong>gcsolutesdic</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">the correlation of gcsolutes ids
with residue names</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.RestartFile.read" title="protomslib.simulationobjects.RestartFile.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(filename)</td>
<td>Read the restart file from disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.RestartFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.RestartFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the restart file from disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file to read</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.ResultsFile">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">ResultsFile</code><a class="headerlink" href="#protomslib.simulationobjects.ResultsFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to store a collection of results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file</p>
</dd>
<dt><strong>snapshots</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of SnapshotResult</span></dt>
<dd><p class="first last">all the results</p>
</dd>
<dt><strong>series</strong> <span class="classifier-delimiter">:</span> <span class="classifier">SnapshotResult</span></dt>
<dd><p class="first last">all the results in a single object</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.ResultsFile.make_series" title="protomslib.simulationobjects.ResultsFile.make_series"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_series</span></code></a>()</td>
<td>Make a snapshot with all the results</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.ResultsFile.read" title="protomslib.simulationobjects.ResultsFile.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(filename[,&nbsp;skip,&nbsp;readmax])</td>
<td>Read results from disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.ResultsFile.make_series">
<code class="descname">make_series</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.ResultsFile.make_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a snapshot with all the results</p>
<p>This routine creates a special SnapshotResults object, which has
the same attributes as the objects in the snapshots list,
but rather than storing single floats and integers, this
object stores NumpyArrays of all the results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>SnapshotResults</strong></dt>
<dd><p class="first last">the created object, also stored in self.series</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.ResultsFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em>, <em>skip=0</em>, <em>readmax=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.ResultsFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read results from disc</p>
<p>The filename parameter can be either a single filename, in
case it is assumed that it is a ProtoMS3.0 results file, i.e.
it contains several snapshots
if it is a list of strings, two behaviors are supported:</p>
<blockquote>
<div><ol class="arabic simple">
<li>if the length of the list is 2, and the first filename</li>
</ol>
</div></blockquote>
<p>is a dictionary, a glob is used to list all filenames in that
directory that starts with the second filename in the list</p>
<blockquote>
<div><ol class="arabic simple" start="2">
<li>if the length is not two or you give two filenames,</li>
</ol>
</div></blockquote>
<p>each of them are processed individually and treated as individual
snapshots</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or list of strings</span></dt>
<dd><p class="first last">the name of the file to read</p>
</dd>
<dt><strong>skip</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">number of snapshot at the beginning to skip</p>
</dd>
<dt><strong>readmax</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">maximum number of snapshots to read</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="protomslib.simulationobjects.SetupError">
<em class="property">exception </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">SetupError</code><a class="headerlink" href="#protomslib.simulationobjects.SetupError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">exceptions.Exception</span></code></p>
<p>A general exception class to be raised by setup code</p>
</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.SnapshotResults">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">SnapshotResults</code><a class="headerlink" href="#protomslib.simulationobjects.SnapshotResults" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to store a single snapshot of results</p>
<p>Not all attributes might not be set as they might not
exists in the result file</p>
<p>internal_energies and interaction_energies are dictionary
where the key is is the molecules involved in the energy, e.g.
protein1, or protein1-solute1. The value is a list of EnergyResults
objects, for the various energy components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>lam</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the current lambda value</p>
</dd>
<dt><strong>lamb</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the previous lambda value</p>
</dd>
<dt><strong>lamf</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the next lambda value</p>
</dd>
<dt><strong>datastep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the number of steps the averages are calculate over</p>
</dd>
<dt><strong>lambdareplica</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the index of the lambda replica</p>
</dd>
<dt><strong>temperaturereplica</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the index of the temperature replica</p>
</dd>
<dt><strong>global replica</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the index of the global replica</p>
</dd>
<dt><strong>temperature</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the temperature of the simulation</p>
</dd>
<dt><strong>efftemperature</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the effective temperature in case of REST</p>
</dd>
<dt><strong>ngcsolutes</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the number of GC solutes</p>
</dd>
<dt><strong>nthetasolutes</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the number of theta solutes</p>
</dd>
<dt><strong>bvalue</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the Adams value</p>
</dd>
<dt><strong>solventson</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the number of GC solutes that are turned on</p>
</dd>
<dt><strong>pressure</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the pressure</p>
</dd>
<dt><strong>volume</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the volume</p>
</dd>
<dt><strong>seed</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the random seed</p>
</dd>
<dt><strong>backfe</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the free energy to the previous lambda</p>
</dd>
<dt><strong>forwfe</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the free energy to the next lambda</p>
</dd>
<dt><strong>total</strong> <span class="classifier-delimiter">:</span> <span class="classifier">EnergyResults object</span></dt>
<dd><p class="first last">the total energy</p>
</dd>
<dt><strong>internal_energies</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dictionary of lists of EnergyResults object</span></dt>
<dd><p class="first last">the internal energies</p>
</dd>
<dt><strong>interaction_energies</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dictionary of lists of EnergyResults objects</span></dt>
<dd><p class="first last">the interaction energies</p>
</dd>
<dt><strong>capenergy</strong> <span class="classifier-delimiter">:</span> <span class="classifier">EnergyResults object</span></dt>
<dd><p class="first last">the energy of the cap</p>
</dd>
<dt><strong>extraenergy</strong> <span class="classifier-delimiter">:</span> <span class="classifier">EnergyResults object</span></dt>
<dd><p class="first last">all extra energies</p>
</dd>
<dt><strong>feenergies</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dictionary of float</span></dt>
<dd><p class="first last">the total energy at various lambda values</p>
</dd>
<dt><strong>gradient</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the numerical gradient of lambda</p>
</dd>
<dt><strong>agradient</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the analytical gradient of lambda</p>
</dd>
<dt><strong>thetavals</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of float</span></dt>
<dd><p class="first last">the theta values of all GC solutes</p>
</dd>
<dt><strong>thetasolvals</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of float</span></dt>
<dd><p class="first last">the theta values of all theta solutes</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.SnapshotResults.parse" title="protomslib.simulationobjects.SnapshotResults.parse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse</span></code></a>(fileobj)</td>
<td>Parse a file for results</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.SnapshotResults.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>fileobj</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.SnapshotResults.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a file for results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>fileobj</strong> <span class="classifier-delimiter">:</span> <span class="classifier">file object</span></dt>
<dd><p class="first last">the file to read from</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>string :</strong></dt>
<dd><p class="first last">the line last read</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.TemplateAtom">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">TemplateAtom</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a template atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the atom</p>
</dd>
<dt><strong>residue</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the residue of the atom</p>
</dd>
<dt><strong>param0</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or ForceFieldParameter</span></dt>
<dd><p class="first last">the parameter associated with this atom at v0</p>
</dd>
<dt><strong>param1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or ForceFieldParameter</span></dt>
<dd><p class="first last">the parameter associated with this atom at v1</p>
</dd>
<dt><strong>bondedto</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or TemplateAtom</span></dt>
<dd><p class="first last">the atom this atom is bonded to</p>
</dd>
<dt><strong>angleto</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or TemplateAtom</span></dt>
<dd><p class="first last">the atom this atom forms an angle with</p>
</dd>
<dt><strong>dihedto</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string or TemplateAtom</span></dt>
<dd><p class="first last">the atom this atom forms a dihedral with</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.TemplateAtom.parse" title="protomslib.simulationobjects.TemplateAtom.parse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.TemplateAtom.zmat" title="protomslib.simulationobjects.TemplateAtom.zmat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">zmat</span></code></a>()</td>
<td>Produces a simple z-matrix representation of this atom</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.TemplateAtom.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateAtom.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>record</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the line to parse from</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.TemplateAtom.zmat">
<code class="descname">zmat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateAtom.zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a simple z-matrix representation of this atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>returns</strong></dt>
<dd><p class="first last">the z-matrix representation</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.TemplateConnectivity">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">TemplateConnectivity</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateConnectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a solute bond, angle or dihedral</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the kind of connectivity, i.e. bond, angle or dihedral</p>
</dd>
<dt><strong>atoms</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of strings or TemplateAtom objects</span></dt>
<dd><p class="first last">the atoms involved in this connectivity</p>
</dd>
<dt><strong>flex</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the flexibility</p>
</dd>
<dt><strong>param0</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or ForceFieldParameter</span></dt>
<dd><p class="first last">the parameter associated with this connectivity at v0</p>
</dd>
<dt><strong>param1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or ForceFieldParameter</span></dt>
<dd><p class="first last">the parameter associated with this connectivity at v1</p>
</dd>
<dt><strong>dummy</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">flag to indicate if this should be treated as a dummy</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.TemplateConnectivity.parse" title="protomslib.simulationobjects.TemplateConnectivity.parse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.TemplateConnectivity.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateConnectivity.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>record</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the line to parse from</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.TemplateFile">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">TemplateFile</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to hold a ProtoMS template file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>bondparams</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of ForceFieldParameter objects</span></dt>
<dd><p class="first last">all bond parameters</p>
</dd>
<dt><strong>bondatoms</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of AtomSet objects</span></dt>
<dd><p class="first last">all atoms associated with bond parameters</p>
</dd>
<dt><strong>angleparams</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of ForceFieldParameter objects</span></dt>
<dd><p class="first last">all angle parameters</p>
</dd>
<dt><strong>angleatoms</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of AtomSet objects</span></dt>
<dd><p class="first last">all atoms associated with angle parameters</p>
</dd>
<dt><strong>dihedralterms</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of ForceFieldParameter objects</span></dt>
<dd><p class="first last">all dihedral term parameters</p>
</dd>
<dt><strong>dihedralparams</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of ForceFieldParameter objects</span></dt>
<dd><p class="first last">all dihedral parameters</p>
</dd>
<dt><strong>dihedralatoms</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of AtomSet objects</span></dt>
<dd><p class="first last">all atoms associated with dihedral parameters</p>
</dd>
<dt><strong>cljparams</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of ForceFieldParameter objects</span></dt>
<dd><p class="first last">all clj parameters</p>
</dd>
<dt><strong>templates</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of MolTemplate objects</span></dt>
<dd><p class="first last">all templates in this file</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.TemplateFile.append" title="protomslib.simulationobjects.TemplateFile.append"><code class="xref py py-obj docutils literal notranslate"><span class="pre">append</span></code></a>(other)</td>
<td>Adds another template file to this one</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.TemplateFile.assign_paramobj" title="protomslib.simulationobjects.TemplateFile.assign_paramobj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assign_paramobj</span></code></a>()</td>
<td>Replaces integers and strings with objects</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.TemplateFile.read" title="protomslib.simulationobjects.TemplateFile.read"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read</span></code></a>(filename)</td>
<td>Read a template file from disc</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.TemplateFile.write" title="protomslib.simulationobjects.TemplateFile.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>(filename)</td>
<td>Write a template file to disc</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.TemplateFile.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateFile.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds another template file to this one</p>
<p>Will renumber the parameters of the other
file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>other</strong> <span class="classifier-delimiter">:</span> <span class="classifier">TemplateFile</span></dt>
<dd><p class="first last">the file to add</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.TemplateFile.assign_paramobj">
<code class="descname">assign_paramobj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateFile.assign_paramobj" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces integers and strings with objects</p>
<p>It replaces all indices to force field parameters
with references to ForceFieldParameter objects</p>
<p>It replaces all atom in templates with references
to TemplateAtom objects</p>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.TemplateFile.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateFile.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a template file from disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file to read</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.TemplateFile.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateFile.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a template file to disc</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file to write to</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="protomslib.simulationobjects.TemplateSoluteAtom">
<em class="property">class </em><code class="descclassname">protomslib.simulationobjects.</code><code class="descname">TemplateSoluteAtom</code><span class="sig-paren">(</span><em>record=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateSoluteAtom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#protomslib.simulationobjects.TemplateAtom" title="protomslib.simulationobjects.TemplateAtom"><code class="xref py py-class docutils literal notranslate"><span class="pre">protomslib.simulationobjects.TemplateAtom</span></code></a></p>
<p>Class to hold a solute atom</p>
<p>This is a sub-class that implements functions
that are specific for solute templates</p>
<p>Has the same attributes as TemplateAtom</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#protomslib.simulationobjects.TemplateSoluteAtom.parse" title="protomslib.simulationobjects.TemplateSoluteAtom.parse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse</span></code></a>(record)</td>
<td>Parse a line from a ProtoMS file</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#protomslib.simulationobjects.TemplateSoluteAtom.zmat" title="protomslib.simulationobjects.TemplateSoluteAtom.zmat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">zmat</span></code></a>()</td>
<td>Produces a simple z-matrix representation of this atom</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="protomslib.simulationobjects.TemplateSoluteAtom.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>record</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateSoluteAtom.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from a ProtoMS file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>record</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the line to parse from</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="protomslib.simulationobjects.TemplateSoluteAtom.zmat">
<code class="descname">zmat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.TemplateSoluteAtom.zmat" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a simple z-matrix representation of this atom</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>returns</strong></dt>
<dd><p class="first last">the z-matrix representation, viz. ATOM BONDEDTO ANGLETO DIHEDRALTO</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="protomslib.simulationobjects.angle">
<code class="descclassname">protomslib.simulationobjects.</code><code class="descname">angle</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the angle between two vectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>v1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Numpy array</span></dt>
<dd><p class="first last">the first vecor</p>
</dd>
<dt><strong>v2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Numpy array</span></dt>
<dd><p class="first last">the second vecor</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>float</strong></dt>
<dd><p class="first last">the angle in radians</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.simulationobjects.angle_atms">
<code class="descclassname">protomslib.simulationobjects.</code><code class="descname">angle_atms</code><span class="sig-paren">(</span><em>a1</em>, <em>a2</em>, <em>a3</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.angle_atms" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the angle between three atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>a1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Numpy array</span></dt>
<dd><p class="first last">the first atom</p>
</dd>
<dt><strong>a2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Numpy array</span></dt>
<dd><p class="first last">the second atom</p>
</dd>
<dt><strong>a3</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Numpy array</span></dt>
<dd><p class="first last">the third atom</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>float</strong></dt>
<dd><p class="first last">the angle in radians</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.simulationobjects.color">
<code class="descclassname">protomslib.simulationobjects.</code><code class="descname">color</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.color" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a color of index</p>
<p>For instances when the index is larger than the number of defined colors,
this routine takes care of this by periodicity, i.e.
color at idx=0 is the same color as idx=n</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>idx</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">the index of the color</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>list of floats</strong></dt>
<dd><p class="first last">the color</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.simulationobjects.find_box">
<code class="descclassname">protomslib.simulationobjects.</code><code class="descname">find_box</code><span class="sig-paren">(</span><em>pdbobj</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.find_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse box information from a pdb file</p>
<p>Looks for CENTER, DIMENSIONS and box keywords
in the header of the pdb file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pdbobj</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile object</span></dt>
<dd><p class="first last">the structure to parse</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>dictionary of Numpy arrays</strong></dt>
<dd><p class="first last">the center, length and origin of the box</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.simulationobjects.is_solvent">
<code class="descclassname">protomslib.simulationobjects.</code><code class="descname">is_solvent</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.is_solvent" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether a given residue name
is a solvent residue name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the residue name</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.simulationobjects.merge_pdbs">
<code class="descclassname">protomslib.simulationobjects.</code><code class="descname">merge_pdbs</code><span class="sig-paren">(</span><em>pdbobjs</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.merge_pdbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge pdb files</p>
<p>Create a new PDBFile instance and add all residues and solvents from
all pdb files given, renumbering residues</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pdbobjs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of PDBFile objects</span></dt>
<dd></dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>PDBFile object</strong></dt>
<dd><p class="first last">the newly created and merged pdb structure</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.simulationobjects.setup_logger">
<code class="descclassname">protomslib.simulationobjects.</code><code class="descname">setup_logger</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.setup_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup ProtoMS logging system</p>
<p>Uses the standard logging module with two handlers,
one that prints everything above DEBUG to standard output
and one that prints everything, even DEBUG to a file</p>
<p>If filename is None no file handler is created</p>
<p>This should be called by protoms.py and all other stand-alone
programs that uses the tools</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">the filename of the string</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>a reference to the created logger</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.simulationobjects.standard_filename">
<code class="descclassname">protomslib.simulationobjects.</code><code class="descname">standard_filename</code><span class="sig-paren">(</span><em>filename</em>, <em>folder</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.standard_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the filename of file in the standard ProtoMS file hierarchy</p>
<p>If $PROTOMSHOME is set, it uses it as the base-path, otherwise,
it uses the location of this module as to create the base-path</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file</p>
</dd>
<dt><strong>folder</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">a folder in the standard ProtoMS file hierarchy</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>the full path to the file</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.simulationobjects.write_box">
<code class="descclassname">protomslib.simulationobjects.</code><code class="descname">write_box</code><span class="sig-paren">(</span><em>filename</em>, <em>box</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.simulationobjects.write_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a box in PDB file format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>filename</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">the name of the file to write</p>
</dd>
<dt><strong>box</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dictionary of Numpy array</span></dt>
<dd><p class="first last">the box specification</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-protomslib.solvate">
<span id="solvate"></span><h2>Solvate<a class="headerlink" href="#module-protomslib.solvate" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="protomslib.solvate.solvate">
<code class="descclassname">protomslib.solvate.</code><code class="descname">solvate</code><span class="sig-paren">(</span><em>box</em>, <em>ligand=None</em>, <em>protein=None</em>, <em>geometry='box'</em>, <em>padding=10.0</em>, <em>radius=30.0</em>, <em>center='cent'</em>, <em>namescheme='ProtoMS'</em>, <em>offset=0.89</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.solvate.solvate" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to solvate ligand and/or protein structures using a
pre-equilibrated box of waters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>box</strong> <span class="classifier-delimiter">:</span> <span class="classifier">String</span></dt>
<dd><p class="first last">String giving the name of a pdb file containing a box of pre-
equilibrated water molecules for solvation</p>
</dd>
<dt><strong>ligand</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile or string, optional</span></dt>
<dd><p class="first last">Either pdb instance for ligand to be solvated, or string giving
the name of a pdb file of the ligand. NOTE - either ligand or protein
or both must be supplied</p>
</dd>
<dt><strong>protein</strong> <span class="classifier-delimiter">:</span> <span class="classifier">PDBFile or string, optional</span></dt>
<dd><p class="first last">Either pdb instance for protein to be solvated, or string giving
the name of a pdb file of the protein. NOTE - either ligand or protein
or both must be supplied</p>
</dd>
<dt><strong>geometry</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">Shape of solvent box, options “box”, “droplet”, “flood”. Default box.
Droplet defines a sphere of radius ‘radius’ around center ‘center’.
Box defines a box that extends at least distance ‘padding’ from solute
Flood defines the equivalent, but waters overlapping with the solute
are not removed</p>
</dd>
<dt><strong>padding</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Minimum distance between the solute and the box edge. Default 10.0A</p>
</dd>
<dt><strong>radius</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">The radius of the added droplet sphere. Default 30.0A</p>
</dd>
<dt><strong>center</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">Defines the center of the added droplet sphere. Options “cent”,
one, two or three numbers. Default “cent”.
Cent defines the center based on all solute atom coordinates
One number defines coordinates for the center as identical x,y,z
Two numbers defines coordinates for the center over an atom range
Three numbers defines coordinates for the center as separate x,y,z</p>
</dd>
<dt><strong>namescheme</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first last">Naming scheme for printout, options “ProtoMS”, “Amber”. Default ProtoMS</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>PDBFile</strong></dt>
<dd><p class="first last">the created box of waters, including crystallographic water</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>SetupError</strong></dt>
<dd><dl class="first last docutils">
<dt>neither protein nor ligand was given, or x-ray waters is not</dt>
<dd><p class="first last">same format as pre-equilibrated box</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="template">
<h2>Template<a class="headerlink" href="#template" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-protomslib.utils">
<span id="utils"></span><h2>Utils<a class="headerlink" href="#module-protomslib.utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="protomslib.utils.rotmat_x">
<code class="descclassname">protomslib.utils.</code><code class="descname">rotmat_x</code><span class="sig-paren">(</span><em>alpha</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.utils.rotmat_x" title="Permalink to this definition">¶</a></dt>
<dd><p>3D rotation matrix for rotations about x-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>alpha</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or integer</span></dt>
<dd><p class="first last">the angle (in radians) by which rotation is performed about the x-axis.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy array</strong></dt>
<dd><p class="first last">the rotation matrix for the desired angle.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.utils.rotmat_y">
<code class="descclassname">protomslib.utils.</code><code class="descname">rotmat_y</code><span class="sig-paren">(</span><em>beta</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.utils.rotmat_y" title="Permalink to this definition">¶</a></dt>
<dd><p>3D rotation matrix for rotations about x-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>beta</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or integer</span></dt>
<dd><p class="first last">the angle (in radians) by which rotation is performed about the y-axis.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy array</strong></dt>
<dd><p class="first last">the rotation matrix for the desired angle.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="protomslib.utils.rotmat_z">
<code class="descclassname">protomslib.utils.</code><code class="descname">rotmat_z</code><span class="sig-paren">(</span><em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#protomslib.utils.rotmat_z" title="Permalink to this definition">¶</a></dt>
<dd><p>3D rotation matrix for rotations about x-axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>gamma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float or integer</span></dt>
<dd><p class="first last">the angle (in radians) by which rotation is performed about the z-axis.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy array</strong></dt>
<dd><p class="first last">the rotation matrix for the desired angle.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Richard Bradshaw, Ana Cabedo Martinez, Chris Cave-Ayland, Samuel Genheden, Gregory Ross.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>