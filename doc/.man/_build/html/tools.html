<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tools &mdash; ProtoMS 3.1 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ProtoMS 3.1 documentation" href="index.html" />
    <link rel="next" title="Test Suite" href="testsuite.html" />
    <link rel="prev" title="protoms.py" href="protomspy.html" /> 
  </head>
  <body role="document">

<!--<div style="background-color: white; text-align: center; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci" style="width: 10em"/></a>
</div>-->

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="testsuite.html" title="Test Suite"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="protomspy.html" title="protoms.py"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/dolphin.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tools</a><ul>
<li><a class="reference internal" href="#ambertools-py">ambertools.py</a></li>
<li><a class="reference internal" href="#build-template-py">build_template.py</a></li>
<li><a class="reference internal" href="#calc-bar-py">calc_bar.py</a></li>
<li><a class="reference internal" href="#calc-clusters-py">calc_clusters.py</a></li>
<li><a class="reference internal" href="#calc-density-py">calc_density.py</a></li>
<li><a class="reference internal" href="#calc-dg-py">calc_dg.py</a></li>
<li><a class="reference internal" href="#calc-gci-py">calc_gci.py</a></li>
<li><a class="reference internal" href="#calc-gcsingle-py">calc_gcsingle.py</a></li>
<li><a class="reference internal" href="#calc-replicapath-py">calc_replicapath.py</a></li>
<li><a class="reference internal" href="#calc-rmsd-py">calc_rmsd.py</a></li>
<li><a class="reference internal" href="#calc-series-py">calc_series.py</a></li>
<li><a class="reference internal" href="#calc-ti-py">calc_ti.py</a></li>
<li><a class="reference internal" href="#clear-gcmcbox-py">clear_gcmcbox.py</a></li>
<li><a class="reference internal" href="#convertatomnames-py">convertatomnames.py</a></li>
<li><a class="reference internal" href="#convertwater-py">convertwater.py</a></li>
<li><a class="reference internal" href="#distribute-waters-py">distribute_waters.py</a></li>
<li><a class="reference internal" href="#divide-pdb-py">divide_pdb.py</a></li>
<li><a class="reference internal" href="#generate-input-py">generate_input.py</a></li>
<li><a class="reference internal" href="#make-dummy-py">make_dummy.py</a></li>
<li><a class="reference internal" href="#make-gcmcbox-py">make_gcmcbox.py</a></li>
<li><a class="reference internal" href="#make-single-py">make_single.py</a></li>
<li><a class="reference internal" href="#merge-templates-py">merge_templates.py</a></li>
<li><a class="reference internal" href="#plot-theta-py">plot_theta.py</a></li>
<li><a class="reference internal" href="#pms2pymbar-py">pms2pymbar.py</a></li>
<li><a class="reference internal" href="#scoop-py">scoop.py</a></li>
<li><a class="reference internal" href="#solvate-py">solvate.py</a></li>
<li><a class="reference internal" href="#split-jawswater-py">split_jawswater.py</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="protomspy.html"
                        title="previous chapter">protoms.py</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="testsuite.html"
                        title="next chapter">Test Suite</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tools">
<h1>Tools<a class="headerlink" href="#tools" title="Permalink to this headline">¶</a></h1>
<p>In the <code class="docutils literal"><span class="pre">$PROTOMSHOME/tools</span></code> folder we have collect a range of useful scripts to setup and analyse ProtoMS simulations. Many of them are used by the <code class="docutils literal"><span class="pre">protoms.py</span></code> setup script. In this page we have collected the documentation for these tools with the user as a focus. Developers might be interested in looking at the Python code manual in the <code class="docutils literal"><span class="pre">.doc</span></code> folder.</p>
<div class="section" id="ambertools-py">
<h2>ambertools.py<a class="headerlink" href="#ambertools-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">ambertools.py</span> <span class="pre">-f</span> <span class="pre">pdbfile</span> <span class="pre">[pdbfile2</span> <span class="pre">...]</span> <span class="pre">[-n</span> <span class="pre">name</span> <span class="pre">name2</span> <span class="pre">...]</span> <span class="pre">[-c</span> <span class="pre">charge</span> <span class="pre">charge2</span> <span class="pre">...]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-f</span> <span class="pre">pdbfile</span> <span class="pre">pdbfile2</span> <span class="pre">...</span></code> = the name of one or more structures in PDB format</dt>
<dd><p class="first last">at least one filename needs to be given</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-n</span> <span class="pre">name</span> <span class="pre">name2</span> <span class="pre">...</span></code> = the name of the molecule(s) in the PDB file(s)</dt>
<dd><p class="first last">optional, default = UNK</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-c</span> <span class="pre">charge</span> <span class="pre">charge2</span> <span class="pre">...</span></code> = the net charge of the molecule(s) in the PDB file(s)</dt>
<dd><p class="first last">optional, default=0</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>ambertools.py -f benzene.pdb
ambertools.py -f benzene.pdb -n BNZ
ambertools.py -f benzenamide.pdb -c 0
ambertools.py -f benzene.pdb toluene.pdb -n BNZ TOL
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool encapsulate the program <code class="docutils literal"><span class="pre">antechamber</span></code> and <code class="docutils literal"><span class="pre">parmchk</span></code> from the AmberTools suite of programs.</p>
<p>It will produce an Amber prepi-file, containing the z-matrix and atom types of the given solutes, parametrized with the general Amber force field and AM1-BCC charges. It will also produce an Amber frcmod-file with additional parameters not found in the GAFF definition. These files be named after the input <code class="docutils literal"><span class="pre">pdbfile</span></code>, replacing the extension <code class="docutils literal"><span class="pre">.pdb</span></code> with <code class="docutils literal"><span class="pre">.prepi</span></code> and <code class="docutils literal"><span class="pre">.frcmod</span></code></p>
<p>The AmberTools program should exist in the system path.</p>
</div>
<div class="section" id="build-template-py">
<h2>build_template.py<a class="headerlink" href="#build-template-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">build_template.py</span> <span class="pre">-p</span> <span class="pre">prepifile</span> <span class="pre">[-f</span> <span class="pre">frcmodfile]</span> <span class="pre">[-z</span> <span class="pre">zmatfile]</span> <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[-n</span> <span class="pre">name]</span> <span class="pre">[-t</span> <span class="pre">trans]</span> <span class="pre">[-r</span> <span class="pre">rot]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-p</span> <span class="pre">prepifile</span></code> = the name of an Amber prepi file containing the z-matrix and atom types of a solute</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-f</span> <span class="pre">frcmodfile</span></code> = the name of an Amber frcmod file</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-z</span> <span class="pre">zmatfile</span></code> = the name of a file containing the ProtoMS z-matrix of a solute</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the name of a ProtoMS template file</dt>
<dd><p class="first last">optional, default = lig.tem</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-n</span> <span class="pre">name</span></code> = the name of the solute</dt>
<dd><p class="first last">optional, default = UNK</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-t</span> <span class="pre">trans</span></code> = the maximum translational displacement</dt>
<dd><p class="first last">optional, default = 0.25 A</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-r</span> <span class="pre">rot</span></code> = the maximum rotational displacement</dt>
<dd><p class="first last">optional, default = 5 degrees</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>build_template.py -p benzene.prepi
build_template.py -p benzene.prepi -f benzene.frcmod
build_template.py -p benzene.prepi -f benzene.frcmod -o benzene.template -n BNZ
build_template.py -p benzene.prepi -f benzene.frcmod -t 1.0 -r 10
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool builds a ProtoMS template file for a solute given an Amber prepi file.</p>
<p>If the solute needs parameter not in the GAFF release, they should be supplied with the <code class="docutils literal"><span class="pre">frcmodfile</span></code>.</p>
<p>The tool will automatically make an appropriate z-matrix for Monte Carlo sampling. This works in most situations. However, if something is not working properly with the generated z-matrix, one can be supplied in the <code class="docutils literal"><span class="pre">zmatfile</span></code></p>
<p>The default translational and rotational displacements are based on experience and should be appropriate in most situations.</p>
</div>
<div class="section" id="calc-bar-py">
<h2>calc_bar.py<a class="headerlink" href="#calc-bar-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">calc_bar.py</span> <span class="pre">[-d</span> <span class="pre">directory]</span> <span class="pre">[-r</span> <span class="pre">results]</span> <span class="pre">[-s</span> <span class="pre">nskip]</span> <span class="pre">[-m</span> <span class="pre">nmax]</span> <span class="pre">[-t</span> <span class="pre">temperature]</span>&nbsp; <span class="pre">[-b</span> <span class="pre">nbootstraps]</span> <span class="pre">[-pw]</span> <span class="pre">[-pu]</span> <span class="pre">[-pl]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-d</span> <span class="pre">directory</span></code> = name of output directory of the simulation</dt>
<dd><p class="first last">optional, default = current working directory (.)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-r</span> <span class="pre">results</span></code> = the beginning of the name of the file to analyse</dt>
<dd><p class="first last">optional, default = results_inst</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-s</span> <span class="pre">nskip</span></code> = the number of snapshots to skip at the beginning of the simulation</dt>
<dd><p class="first last">optional, default = 0</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-m</span> <span class="pre">nmax</span></code> = the maximum number of snapshots to process</dt>
<dd><p class="first last">optional, default = the total number of snapshot in the results file, excluding nskip</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-t</span> <span class="pre">temperature</span></code> = the simulation temperature in degree Celsius</dt>
<dd><p class="first last">optional, default = 25 degrees</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-b</span> <span class="pre">nbootstraps</span></code> = the number of bootstraps samples to use in uncertainty estimation</dt>
<dd><p class="first last">optional, default = 100</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pw</span></code>  = flag that turns <em>off</em> the printing of individual free energies between windows</dt>
<dd><p class="first last">optional, default = on</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pu</span></code>  = flag that turns <em>off</em> the printing of uncertainties</dt>
<dd><p class="first last">optional, default = on</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pl</span></code>  = flag that turns <em>off</em> the printing of <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-values</dt>
<dd><p class="first last">optional, default = on</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>calc_bar.py -d out_free/
calc_bar.py -s 200
calc_bar.py -m 200
calc_bar.py -d out_free/ -pw
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool calculates free energies using the Bennets Acceptance Ratio (BAR) method.</p>
<p>The program expects that in the <code class="docutils literal"><span class="pre">directory</span></code> there exist an output folder for each <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-value, eg. <code class="docutils literal"><span class="pre">lam-0.000</span></code> and <code class="docutils literal"><span class="pre">lam-1.000</span></code></p>
<p>The uncertainty of the free energies is estimated by boostrapping the energy differnces. The number of bootstrap samples is set by the <code class="docutils literal"><span class="pre">nbootstraps</span></code> argument. The procedure is rather slow, so in order to obtain a quick estimate of the free energy, lower this value.</p>
<p>Block estimates can be constructed by combining <code class="docutils literal"><span class="pre">nskip</span></code> and <code class="docutils literal"><span class="pre">nmax</span></code>. For instance, these commands calculates block estimates with a block size of 5 m snapshots</p>
<div class="highlight-python"><div class="highlight"><pre>for X in 0 50 100 150 200 250 300 350
do
calc_bar.py -d out_free -nskip $X -nmax 50 -b 5 -pw -pu
done
</pre></div>
</div>
</div>
<div class="section" id="calc-clusters-py">
<h2>calc_clusters.py<a class="headerlink" href="#calc-clusters-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">calc_clusters.py</span> <span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">[file2</span> <span class="pre">...]</span>&nbsp; <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[-m</span> <span class="pre">molecule]</span> <span class="pre">[-a</span> <span class="pre">atom]</span> <span class="pre">[-t</span> <span class="pre">type]</span> <span class="pre">[-c</span> <span class="pre">cutoff]</span> <span class="pre">[--skip</span> <span class="pre">N]</span> <span class="pre">[--max</span> <span class="pre">N]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">file2</span></code> ... = name(s) of PDB-file(s) containing simulation snapshots</dt>
<dd><p class="first last">at least one file needs to be specified
can read a PDB trajectory</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the produced clusters in PDB format</dt>
<dd><p class="first last">optional, clusters.pdb</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-m</span> <span class="pre">molecuke</span></code> = the name of the molecule to cluster</dt>
<dd><p class="first last">optional, default = wat</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-a</span> <span class="pre">atom</span></code> = the name of the atom in the residue to cluster</dt>
<dd><p class="first last">optional, no default
if not specified, the entire molecule will be clustered</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-t</span> <span class="pre">type</span></code> = the clustering algorith</dt>
<dd><p class="first last">optional, default = average
can be any of average, single, complete, weighted and centroid</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-c</span> <span class="pre">cutoff</span></code> = the cluster cut-off</dt>
<dd><p class="first last">optional, default = 2.0 A</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--skip</span> <span class="pre">N</span></code> = skip N snapshots at the beginning of the simulation</dt>
<dd><p class="first last">optional, default = 0</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--max</span> <span class="pre">N</span></code> = read and process a maximum of N snapshots</dt>
<dd><p class="first last">optional, default = 99999</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>calc_clusters.py -f all.pdb
calc_clusters.py -f all.pdb all2.pdb
calc_clusters.py -f all.pdb -o all_clusters.pdb
calc_clusters.py -f all.pdb -t complete
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool cluster molecules from a simulation</p>
<p>It will extract the coordinates of all atoms with name equal to <code class="docutils literal"><span class="pre">atom</span></code> in residues with name equal to <code class="docutils literal"><span class="pre">molecule</span></code> in all input files and cluster them using the selected algorithm.  If no atom is specified, the entire molecule will be clustered. By default this atom and residue name is set to match GCMC / JAWS output with the standard water template.</p>
</div>
<div class="section" id="calc-density-py">
<h2>calc_density.py<a class="headerlink" href="#calc-density-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">calc_density.py</span> <span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">[file2</span> <span class="pre">...]</span>&nbsp; <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[-r</span> <span class="pre">residue]</span> <span class="pre">[-a</span> <span class="pre">atom]</span> <span class="pre">[-p</span> <span class="pre">padding]</span> <span class="pre">[-s</span> <span class="pre">spacing]</span> <span class="pre">[-e</span> <span class="pre">extent]</span> <span class="pre">[-n</span> <span class="pre">norm]</span> <span class="pre">[-t</span> <span class="pre">sphere|gaussian]</span> <span class="pre">[--skip</span> <span class="pre">N]</span> <span class="pre">[--max</span> <span class="pre">N]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">file2</span></code> ... = name(s) of PDB-file(s) containing simulation snapshots</dt>
<dd><p class="first last">at least one file needs to be specified
can read a PDB trajectory</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the produced density in DX-format</dt>
<dd><p class="first last">optional, default = grid.dx</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-r</span> <span class="pre">residue</span></code> = the name of the residue to make a grid on</dt>
<dd><p class="first last">optional, default = wat</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-a</span> <span class="pre">atom</span></code> = the name of the atom in the residue to make a grid on</dt>
<dd><p class="first last">optional, default = o00</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-p</span> <span class="pre">padding</span></code> = the amount to increase the minimum box in each dimension</dt>
<dd><p class="first last">optional, default = 2.0 A</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-s</span> <span class="pre">spacing</span></code> = the grid resolution</dt>
<dd><p class="first last">optional, default = 0.5 A</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-e</span> <span class="pre">extent</span></code> = the size of the smoothing</dt>
<dd><p class="first last">optional, default =  1.0 A</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-n</span> <span class="pre">norm</span></code> = the normalisation constant</dt>
<dd><p class="first last">optional, default = the number of snapshot processed</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-t</span> <span class="pre">sphere|gaussian</span></code> = the type of coordinate smoothing</dt>
<dd><p class="first last">optional, default = sphere
<code class="docutils literal"><span class="pre">sphere</span></code> = spherical smoothing with extent radius
<code class="docutils literal"><span class="pre">gaussian</span></code> = smoothing with Gaussian with standard deviation = extent</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--skip</span> <span class="pre">N</span></code> = skip N snapshots at the beginning of the simulation</dt>
<dd><p class="first last">optional, default = 0</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--max</span> <span class="pre">N</span></code> = read and process a maximum of N snapshots</dt>
<dd><p class="first last">optional, default = 99999</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>calc_density.py -f all.pdb
calc_density.py -f all.pdb all2.pdb
calc_density.py -f all.pdb -o gcmc_density.dx
calc_density.py -f all.pdb -r t4p -n o00
calc_density.py -f all.pdb -p 1.0 -s 1.0
calc_density.py -f all.pdb -e 0.5 -t gaussian
calc_density.py -f all.pdb -n 100
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool discretises atoms on a grid, thereby representing a simulation output as a density.</p>
<p>It will extract the coordinates of all atoms with name equal to <code class="docutils literal"><span class="pre">atom</span></code> in residues with name equal to <code class="docutils literal"><span class="pre">residue</span></code> in all input files and discretise them on a grid. By default this atom and residue name is set to match GCMC / JAWS output with the standard water template.</p>
<p>The produced density can be visualized with most programs, e.g.</p>
<div class="highlight-python"><div class="highlight"><pre>vmd -m all.pdb grid.dx
</pre></div>
</div>
</div>
<div class="section" id="calc-dg-py">
<h2>calc_dg.py<a class="headerlink" href="#calc-dg-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">calc_dg.py</span> <span class="pre">[-d</span> <span class="pre">directory</span> <span class="pre">directory2</span> <span class="pre">...]</span> <span class="pre">[-r</span> <span class="pre">results]</span> <span class="pre">[-e</span> <span class="pre">ti|bar|mbar]</span> <span class="pre">[-s</span> <span class="pre">nskip]</span> <span class="pre">[-m</span> <span class="pre">nmax]</span> <span class="pre">[-t</span> <span class="pre">temperature]</span>&nbsp; <span class="pre">[-b</span> <span class="pre">nbootstraps]</span>&nbsp; <span class="pre">[-pe]</span> <span class="pre">[-pg]</span> <span class="pre">[-gr]</span> <span class="pre">[--analytical]</span> <span class="pre">[--numerical</span> <span class="pre">both|back|forw</span> <span class="pre">]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-d</span> <span class="pre">directory</span> <span class="pre">directory2</span></code> ... = name of output directories of simulations</dt>
<dd><p class="first last">optional, default = current working directory (.)
one or more directories can be specified</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-r</span> <span class="pre">results</span></code> = the beginning of the name of the file to analyse</dt>
<dd><p class="first last">optional, default = results_inst</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-e</span> <span class="pre">ti|bar|mbar</span></code> = the free energy estimator</dt>
<dd><p class="first last">optional, default = ti bar mbar
one or more estimators can be specified</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-s</span> <span class="pre">nskip</span></code> = the number of snapshots to skip at the beginning of the simulation</dt>
<dd><p class="first last">optional, default = 0</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-m</span> <span class="pre">nmax</span></code> = the maximum number of snapshots to process</dt>
<dd><p class="first last">optional, default = the total number of snapshot in the results file, excluding nskip</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-t</span> <span class="pre">temperature</span></code> = the simulation temperature in degree Celsius</dt>
<dd><p class="first last">optional, default = 25 degrees</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-b</span> <span class="pre">nbootstraps</span></code> = the number of bootstraps samples to use in uncertainty estimation</dt>
<dd><p class="first last">optional, default = 100</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pe</span></code>  = flag that turns <em>off</em> the printing of free energy for each directory</dt>
<dd><p class="first last">optional, default = on</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pg</span></code>  = flag that turns <em>off</em> the printing of the gradient</dt>
<dd><p class="first last">optional, default = on</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-gr</span></code>  = flag that turns <em>on</em> the plotting of the gradient</dt>
<dd><p class="first last">optional, default = off</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">--analytical</span></code> = turns <em>on</em> the use of analytical gradients
optional, default = off</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">--numerical</span></code> = turns <em>on</em> the use of numerical gradients and selects the kind
optional, default = both
<code class="docutils literal"><span class="pre">both</span></code> = uses the free energy in both backward and forward direction to compute the free energy gradient
<code class="docutils literal"><span class="pre">back</span></code> = uses the free energy in the backward direction to compute the free energy gradient
<code class="docutils literal"><span class="pre">forw</span></code> = uses the free energy in the forward direction to compute the free energy gradient</p>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>calc_dg.py -d out_free/
calc_dg.py -d out_free1/ out_free2/ out_free3/ -s 200
calc_dg.py -d out_free1/ out_free2/ out_free3/ -m 200
calc_dg.py -d out_free1/ out_free2/ out_free3/ -e ti bar
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool calculates free energies using the method of thermodynamic integration (TI), Bennet&#8217;s Acceptance Ratio (BAR) and Multi BAR (MBAR).</p>
<p>The program expects that in the <code class="docutils literal"><span class="pre">directory</span></code>, <code class="docutils literal"><span class="pre">directory2</span></code> etc. there exist an output folder for each <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-value, eg. <code class="docutils literal"><span class="pre">lam-0.000</span></code> and <code class="docutils literal"><span class="pre">lam-1.000</span></code></p>
<p>If the <code class="docutils literal"><span class="pre">-gr</span></code> flag is set the gradient with respect to <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/> is plotted and saved to a file called <code class="docutils literal"><span class="pre">gradient.png</span></code></p>
<p>The MBAR estimator only works if PyMBAR is properly installed and can be loaded as a python library.</p>
</div>
<div class="section" id="calc-gci-py">
<h2>calc_gci.py<a class="headerlink" href="#calc-gci-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">calc_gci.py</span> <span class="pre">-d</span> <span class="pre">directories</span> <span class="pre">[-f</span> <span class="pre">file]</span> <span class="pre">[-p</span> <span class="pre">titration|fit|percentiles|pmf|excess|all]</span> <span class="pre">[-c</span> <span class="pre">fit|pmf|minimum|excess|all]</span> <span class="pre">[-s</span> <span class="pre">nskip]</span> <span class="pre">[-b</span> <span class="pre">nboots]</span> <span class="pre">[-i]</span> <span class="pre">[-o]</span> <span class="pre">[--steps</span> <span class="pre">nsteps]</span> <span class="pre">[--range</span> <span class="pre">A</span> <span class="pre">B]</span> <span class="pre">[--reverse]</span> <span class="pre">[--fit_options]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-d</span> <span class="pre">directories</span></code> = the output directories from GCMC</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-f</span> <span class="pre">file</span></code> = the name of ProtoMS results file
optional, default =results</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-p</span></code> = the selections for ploting data,
optional, default = none</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">titration</span></code> = the average number of GCMC waters at each B value
<code class="docutils literal"><span class="pre">fit</span></code> = titration plot with line of best fit
<code class="docutils literal"><span class="pre">percentiles</span></code> = titration plot with median fit (red line), 50% confidense region of fit (orange), and 90% confidense region of fit (gray)
<code class="docutils literal"><span class="pre">pmf</span></code> = relative binding free energy of a given number of waters, median (blue line), 50% confidense region of fit (light blue), and 90% confidense region of fit (gray)
<code class="docutils literal"><span class="pre">excess</span></code> = excess chemical potential of cavity as a function of water occupancy and equilibrium point with bulk water
<code class="docutils literal"><span class="pre">all</span></code> = calculate everything</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-c</span></code> = selection for one or several calculations,
optional, default = none</p>
<blockquote>
<div><p><code class="docutils literal"><span class="pre">fit</span></code> = whether to fit and artficial neural network to smooth GCMC titration data
<code class="docutils literal"><span class="pre">pmf</span></code> = potential of mean force: free energies for inserting or deleting waters calculated with grand canonical integration
<code class="docutils literal"><span class="pre">minimum</span></code> = whether to calculate the occupancy that minimises binding free energy
<code class="docutils literal"><span class="pre">excess</span></code> = excess chemical potential of cavity as a function of water
<code class="docutils literal"><span class="pre">all</span></code> = calculate everything</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-s</span> <span class="pre">nskip</span></code> = the number of initial snapshots to discard
optional, default = 0</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-b</span></code> = the number of bootstrap samples
optional, default = none</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-i</span></code> = python pickle of fitted artificial neural network you wish to use
optional, default = none</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-o</span></code> = name of the python pickle of fitted artificial neural network you wish to save
optional, default = none</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">--steps</span> <span class="pre">nsteps</span></code> = the number of units that will comprise the artificial neural network, recommended to be set to equal the number of steps observed in the titration data
optional, default = 1</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">--range</span> <span class="pre">A</span> <span class="pre">B</span></code> = the minimum and maximum number of waters you wish to consider
optional, default = the range spanned by the titration data</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">--reverse</span></code> = whether to peform grand canonical integration in the reverse direction: from the high to low water occupancy, instead of low to high
optional, default = False</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">--fit_options</span></code> = set of fitting options to parse to the artificial neural network optimisation.
optional, default = None</p>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>calc_gci.py -d out_gcmc/b_* -p titration
calc_gci.py -d out_gcmc/b_* -p all -c all --steps 3
calc_gci.py -d out_gcmc/b_* -p percentiles -c fit --steps 3 -b 1000 --fit_options &quot;repeats 1 pin_min 0.0 cost huber c 1&quot; -o ANN.pickle
calc_gci.py -d out_gcmc/b_* -i ANN.pickle -p pmf -c pmf minimum
calc_gci.py -d out_gcmc/b_* -i ANN.pickle -c pmf --range 3 4
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>Collection of tools to analyse and visualise GCMC titration data of water using grand canonical integration (GCI). Used to plot average number of waters for a given Adams value, i.e. GCMC titration data, calculate transfer free energies from ideal gas, calculate absolute and relative binding free energies of water, calculate and/or estimate optimal number of bound waters. As described in Ross et al., J. Am. Chem. Soc., 2015, 137 (47), pp 14930-14943.</p>
<p>Prior to using the armoury of options available in this script, it is wise to first view the titration data with <code class="docutils literal"><span class="pre">-p</span> <span class="pre">titration</span></code>. The plot shows the average number of water molecules at each Adams value. It&#8217;s important to use <code class="docutils literal"><span class="pre">--skip</span> <span class="pre">nframes</span></code> to check that the form of the graph doesn&#8217;t significantly change if some initial snapshots are discarded when computing the average. The value of <code class="docutils literal"><span class="pre">nframes</span></code> can be informed by the tool <code class="docutils literal"><span class="pre">calc_series.py</span></code>.</p>
<p>All the other functions contained in this tool require the fitting of a monotonically increasing artificial neural network (ANN) to the titration data. This is merely a sum of logistic/step functions that has been constrained to produce a line with upward steps. The purpose of the ANN is to smooth over the titration data so the area under the curve can be reliably evaluated; the imposition of monotonicity is important as it is a property the titration data should have. The number of units in the ANN (i.e. the number of step functions) is input using <code class="docutils literal"><span class="pre">--steps</span> <span class="pre">nsteps</span></code> and should be chosen to capture the major features of the titration data. It is better to err on the side of over-fitting than under-fitting, so don&#8217;t be stingy with how many steps you use. To improve reproducibility and to save time in subsequent analyses, an ANN can be saved and loaded using the flags <code class="docutils literal"><span class="pre">-i</span></code> and <code class="docutils literal"><span class="pre">-o</span></code> respectively. The fitting of an ANN is performed automatically if any of the calculation options (other than <code class="docutils literal"><span class="pre">fit</span></code>) with <code class="docutils literal"><span class="pre">-c</span></code> are specified. Detailed fitting parameters can be parsed to the ANN using <code class="docutils literal"><span class="pre">--fit_options</span></code>, discussed below.</p>
<p>Error estimates of free energies and optimal number of waters are based on either (a) automatic repeated fitting of the ANN from different random initial parameters or (b) bootstrap sampling of the titration data, which samples B-values with replacement. The latter is selected with <code class="docutils literal"><span class="pre">-b</span> <span class="pre">nboots</span></code>, where <code class="docutils literal"><span class="pre">nboots</span></code> is the number of bootstrap samples. When running a large number of bootstrap samples (eg 1000), its recommended to save to bootstrap ANNs with <code class="docutils literal"><span class="pre">-o</span></code>.</p>
<p>The flag <code class="docutils literal"><span class="pre">-c</span> <span class="pre">pmf</span></code> calculates the free energy to transfer water molecules from ideal gas, and from bulk water, where the abbreviation stands for “potential of mean force”. A table will be printed
that contains the free energy to transfer water from ideal gas to the simulated volume (with the heading <code class="docutils literal"><span class="pre">IDEAL</span> <span class="pre">GAS</span> <span class="pre">TRANSFER</span> <span class="pre">FREE</span> <span class="pre">ENERGIES</span></code>), and the free energy to transfer from bulk water at a temperature of 298.15 K (with the heading <code class="docutils literal"><span class="pre">BINDING</span> <span class="pre">FREE</span> <span class="pre">ENERGIES</span></code>). From the multiple ANN fits (either automatic repeated fits or bootstrap sampling), various statistics have been calculated. The <code class="docutils literal"><span class="pre">Mean</span></code> and <code class="docutils literal"><span class="pre">Median</span></code> are different averages of the calculated free energies, with the median being more robust to bad fits of the ANN than the mean. The standard deviation (<code class="docutils literal"><span class="pre">Std.</span>&nbsp; <span class="pre">Dev.</span></code>) as well as the range between the 25th and 75th percentiles serve as error estimates.</p>
<p>Due to the accumulation of error when performing integration, the estimated error of the calculated free energies increases with the number of water molecules. To emphasise this, one can also perform GCI in the reverse direction and calculate the free energy to decouple water from the simulated volume with the flag <code class="docutils literal"><span class="pre">--reverse</span></code>.</p>
<p>One can calculate the free energy to add and remove a specific number of waters with the <code class="docutils literal"><span class="pre">--range</span></code> flag, which requires and upper and a lower number of waters as input. Particularly, the estimated error for the relative free energy between two occupancies is improved as accumulated integration error is reduced.</p>
<p>If this flag is specified along with &#8216;minimum&#8217;, eg <code class="docutils literal"><span class="pre">-c</span> <span class="pre">pmf</span> <span class="pre">minimum</span></code>, then the number of water molecules that minimises the explicitly calculated binding free energy (the optimal number) is printed under the heading <code class="docutils literal"><span class="pre">MINIMUM</span> <span class="pre">BINDING</span> <span class="pre">FREE</span> <span class="pre">ENERGY</span> <span class="pre">STATE</span></code>. The B-value that produces an average number of waters equal to the optimal number is also estimated. If only <code class="docutils literal"><span class="pre">-c</span> <span class="pre">minimum</span></code> is specified, the B-value that replicates equilibrium with bulk water at a temperature of 298.15 K is estimated using an analytical formula, without calculating binding free energies with GCI. This B-value, and the average number of waters that appear at this B-value are printed under <code class="docutils literal"><span class="pre">THERMODYNAMIC</span> <span class="pre">EQUILIBRIUM</span> <span class="pre">STATE</span></code>.</p>
<p>The flag <code class="docutils literal"><span class="pre">--fit_options</span></code> allows one to pass commands into the ANN fitting tool. The default options for the ANN may need tweaking to accurately reproduce the GCMC titration data. The most important options for the user are “repeats&#8221; - number of times the entire process of fitting an ANN is repeated, all fits are retained to estimate the fitting error, default=20; “pin_min” - value to constrain the intercept to, useful when a titration goes to zero waters; “cost” - the type of cost/loss function that is minimised when fitting, the three choices are &#8216;msd&#8217; (mean squared deviation), &#8216;absolute&#8217; (absolute error), and &#8216;huber&#8217; (pseudo Huber loss), default=msd; “c” - the parameter in the pseudo Huber loss function, default=2. Both the &#8216;absolute&#8217; and &#8216;huber&#8217; loss functions are suited to very noisy titration data, as they are more robust to outliers than &#8216;msd&#8217;, although using  the fitting algorithm may produce unstable fits with &#8216;absolute&#8217;.</p>
</div>
<div class="section" id="calc-gcsingle-py">
<h2>calc_gcsingle.py<a class="headerlink" href="#calc-gcsingle-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">calc_gcsingle.py</span> <span class="pre">-d</span> <span class="pre">directories</span> <span class="pre">[-f</span> <span class="pre">file]</span> <span class="pre">[-s</span> <span class="pre">nskip]</span> <span class="pre">[-c]</span> <span class="pre">[-p]</span> <span class="pre">[--guess</span> <span class="pre">number]</span> <span class="pre">[--excess]</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-d</span> <span class="pre">directories</span></code> = the output directories from GCMC</li>
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">file</span></code> = the name of ProtoMS results file
optional, default =results</li>
<li><code class="docutils literal"><span class="pre">-s</span> <span class="pre">nskip</span></code> = the number of initial snapshots to discard
optional, default = 0</li>
<li><code class="docutils literal"><span class="pre">-c</span></code> = whether to calculate the ideal gas transfer free energy,
optional, default = True
if not set the program will use all data</li>
<li><code class="docutils literal"><span class="pre">-p</span></code> = whether to plot the titration data with least squares fit and bootstrap fit
optional</li>
<li><code class="docutils literal"><span class="pre">--guess</span> <span class="pre">number</span></code> = the initial estimate of the transfer free energy used as the initial value in least squares fitting
optional, default = -6.2</li>
<li><code class="docutils literal"><span class="pre">--excess</span></code> = whether to view and calculate the excess chemical potential
optional</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>calc_gcsingle.py -d out_gcmc/b_* -p
calc_gcsingle.py -d out_gcmc/b_* -p --guess -10
calc_gcsingle.py -d out_gcmc/b_* --excess
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool analyses and plots free energies from GCMC simulations on sites that can bind only a single water molecule as described in Ross et al., J. Am. Chem. Soc., 2015, 137 (47), pp 14930-14943. The tool fits a logistic function to GCMC titration data, where the point of inflection/point of half maximum is equals the free energy to transfer a water molecule from ideal gas to the GCMC volume, divided by kT. This tool should only be applied to GCMC titration data where the maximum occupancy equals 1.</p>
</div>
<div class="section" id="calc-replicapath-py">
<h2>calc_replicapath.py<a class="headerlink" href="#calc-replicapath-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">calc_replicapath.py</span> <span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">[file2</span> <span class="pre">...]</span> <span class="pre">-p</span> <span class="pre">replica1</span> <span class="pre">[replica2</span> <span class="pre">...]</span> <span class="pre">-k</span> <span class="pre">lambda|temperature|rest|global</span> <span class="pre">[-o</span> <span class="pre">outfile]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">file2</span></code> ... = the name(s) of ProtoMS results file(s)</dt>
<dd><p class="first last">at least one file needs to be given</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-p</span> <span class="pre">replica1</span> <span class="pre">replica2</span></code> ... = the replica values to plot</dt>
<dd><p class="first last">at least one replica value needs to be given</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-k</span> <span class="pre">lambda|temperature|rest|global</span></code> = the kind of replicas</dt>
<dd><p class="first last">optional, default = lambda
<code class="docutils literal"><span class="pre">lambda</span></code> = <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/> replica exchange replicas
<code class="docutils literal"><span class="pre">temperature</span></code> = temperature replica exchange replicas
<code class="docutils literal"><span class="pre">rest</span></code> = solute tempering replica exchange replicas
<code class="docutils literal"><span class="pre">global</span></code> = global replica exchange replicas, if combining <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/> and temperature replica exchange</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the name of a PNG file to write the replica paths</dt>
<dd><p class="first last">optional, default = replica_path.png</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>calc_replicapath.py -f out_free/lam-0.*/results -p 0.000 1.000
calc_replicapath.py -f out_free/lam-0.*/results -p 0.000 0.500 1.000 -o replica_paths.png
calc_replicapath.py -f out_free/t-*/lam-0.000/results -p 25.0 35.0 45.0 -k temperature
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tools plots the path of different replicas in a replica exchange simulation as a function of simulation time.</p>
<p>If the kind of replicas is from <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/> replica exchange the <code class="docutils literal"><span class="pre">replica1</span></code> and <code class="docutils literal"><span class="pre">replica2</span></code> etc should be individual <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-values to plot.</p>
<p>If the kind of replicas is from REST or temperature replica exchange the <code class="docutils literal"><span class="pre">replica1</span></code> and <code class="docutils literal"><span class="pre">replica2</span></code> etc should be individual temperatures to plot.</p>
</div>
<div class="section" id="calc-rmsd-py">
<h2>calc_rmsd.py<a class="headerlink" href="#calc-rmsd-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">calc_rmsd.py</span> <span class="pre">-i</span> <span class="pre">pdbfile</span> <span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">[file2</span> <span class="pre">...]</span> <span class="pre">-l</span> <span class="pre">ligand</span> <span class="pre">[-a</span> <span class="pre">atom]</span> <span class="pre">[-t</span> <span class="pre">temperature]</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-i</span> <span class="pre">pdbfile</span></code> = the reference, initial PDB file</li>
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">file2</span></code> ... = the name(s) of ProtoMS results file(s)
at least one file needs to be given</li>
<li><code class="docutils literal"><span class="pre">-l</span> <span class="pre">ligand</span></code> = the residue name of the ligand</li>
<li><code class="docutils literal"><span class="pre">-a</span> <span class="pre">atom</span></code> = the atom to calculate the RMSD of
optional, if not set the program will calculate the RMSD of the geometric center</li>
<li><code class="docutils literal"><span class="pre">-t</span> <span class="pre">temperature</span></code> = the simulation temperature in K
optional, default = 298 K</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>calc_rmsd.py -i benzene.pdb -f out_bnd/all.pdb -r bnz
calc_rmsd.py -i benzene.pdb -f out_bnd/all.pdb -r bnz -a c4
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool calculate the RMSD of a ligand in a simulation.</p>
<p>If the <code class="docutils literal"><span class="pre">atom</span></code> name is given, the tool will calculate the RMSD of that atom with respect to its position in <code class="docutils literal"><span class="pre">pdbfile</span></code>. Otherwise, the program will calculate the RMSD of the geometric centre with respect to <code class="docutils literal"><span class="pre">pdbfile</span></code>.</p>
<p>A force constant to keep the ligand constrained is estimated from the RMSD using the equipartition theorem.</p>
</div>
<div class="section" id="calc-series-py">
<h2>calc_series.py<a class="headerlink" href="#calc-series-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">calc_series.py</span> <span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">[file2</span> <span class="pre">...]</span> <span class="pre">[-o</span> <span class="pre">outprefix]</span> <span class="pre">[-s</span> <span class="pre">series</span> <span class="pre">series2</span> <span class="pre">...]</span> <span class="pre">[-p</span> <span class="pre">sep|sub|single|single_first0|single_last0]</span> <span class="pre">[--nperm</span> <span class="pre">N]</span> <span class="pre">[--threshold</span> <span class="pre">N]</span> <span class="pre">[--average]</span> <span class="pre">[--moving</span> <span class="pre">windowsize]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">file2</span></code> ... = the name(s) of ProtoMS result file(s)</dt>
<dd><p class="first last">at least one name needs to be given</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outprefix</span></code> = the prefix of the created PNG-files</dt>
<dd><p class="first last">optional, default = results</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-s</span> <span class="pre">serie</span> <span class="pre">series2</span></code> ... = the name of the series to plot</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-p</span> <span class="pre">sep|sub|single|single_first0|single_last0</span></code> = the type of plot if plotting multiple series</dt>
<dd><p class="first last">optional, no default
<code class="docutils literal"><span class="pre">sep</span></code> = separate plots
<code class="docutils literal"><span class="pre">sub</span></code> = sub plots
<code class="docutils literal"><span class="pre">single</span></code> = all series in one plot
<code class="docutils literal"><span class="pre">single_first0</span></code> = all series in one plot, but make the first value zero
<code class="docutils literal"><span class="pre">single_last0</span></code> = all series in one plot, but make the last value zero</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--nperm</span> <span class="pre">N</span></code> = the number of permutation tests to determine equilibration</dt>
<dd><p class="first last">optional, default = 0 (use analytical test)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--threshold</span> <span class="pre">N</span></code> = the signficance level for testing equilibration</dt>
<dd><p class="first last">optional, default = 0.05</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--average</span></code> = flag that turns <em>on</em> plotting running averages of the series</dt>
<dd><p class="first last">optional, default = off (plot raw series)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--moving</span> <span class="pre">windowsize</span></code> = turns <em>on</em> plotting of moving averages with a specific window size</dt>
<dd><p class="first last">optional, default = off (plot raw series)</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>calc_series.py -f results
calc_series.py -f results -s total gradient
calc_series.py -f results -s total gradient -p sub
calc_series.py -f lam-*/results -s gradient
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tools plots and analyses time series.</p>
<p>The series to plot is selected by the <code class="docutils literal"><span class="pre">-s</span></code> flag. Basically any property written to the ProtoMS results file can be plotted, e.g. energies, volume, gradients etc. If the <code class="docutils literal"><span class="pre">-s</span></code> flag is not specified, a wizard will display all available series that can be plotted. This can be useful if one is unsure what the name of the series is.</p>
<p>The tool can plot multiple series and there is five choices how produce these plots, set by the <code class="docutils literal"><span class="pre">-p</span></code> flag. If the <code class="docutils literal"><span class="pre">sep</span></code> multiple PNG files will be created, one for each series. With all other choices, one PNG file is created. If the <code class="docutils literal"><span class="pre">-p</span></code> flag is not specified on the command line, a wizard will prompt the user for the different options.</p>
<p>All plotted data series will also be written to disc. If <code class="docutils literal"><span class="pre">sep</span></code> is used, separate files will be written as well.</p>
<p>For each time series, the tool will estimate the equilibration time. It will do this by performing a statistical test based on the rank order of the series. If the series is equilibrated it will have a slope close to zero and the Kendall&#8217;s &amp;tau; will be zero. When the equilibration time has been determined, the tool will estimate the number of independent samples in the production part using the method of statistical inefficiency. The equilibration time will also be estimated from a method that maximizes the number uncorrelated samples as suggested on alchemistry.org.</p>
<p>Apart from the raw series, the tool can also plot the running average if the <code class="docutils literal"><span class="pre">--average</span></code> flag is set or the moving average if the <code class="docutils literal"><span class="pre">--moving</span></code> flag is used.</p>
<p>Typically only a single ProtoMS results file will be analysed and plotted. However, for the series <code class="docutils literal"><span class="pre">grad</span></code> and <code class="docutils literal"><span class="pre">agrad</span></code> (the gradient and analytical gradient, respectively), multiple results file can be given. In this case, the gradients for each results file is used to estimate the free energy using thermodynamic integration.</p>
</div>
<div class="section" id="calc-ti-py">
<h2>calc_ti.py<a class="headerlink" href="#calc-ti-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">calc_ti.py</span> <span class="pre">[-d</span> <span class="pre">directory]</span> <span class="pre">[-r</span> <span class="pre">results]</span> <span class="pre">[-s</span> <span class="pre">nskip]</span> <span class="pre">[-m</span> <span class="pre">nmax]</span>&nbsp; <span class="pre">[-pg]</span> <span class="pre">[-pp]</span> <span class="pre">[-pl]</span> <span class="pre">[-pu]</span> <span class="pre">[-gr]</span> <span class="pre">[--analytical]</span> <span class="pre">[--numerical</span> <span class="pre">both|back|forw</span> <span class="pre">]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-d</span> <span class="pre">directory</span></code> = name of output directory of the simulation</dt>
<dd><p class="first last">optional, default = current working directory (.)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-r</span> <span class="pre">results</span></code> = the beginning of the name of the file to analyse</dt>
<dd><p class="first last">optional, default = results_inst</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-s</span> <span class="pre">nskip</span></code> = the number of snapshots to skip at the beginning of the simulation</dt>
<dd><p class="first last">optional, default = 0</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-m</span> <span class="pre">nmax</span></code> = the maximum number of snapshots to process</dt>
<dd><p class="first last">optional, default = the total number of snapshot in the results file, excluding nskip</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pg</span></code>  = flag that turns <em>off</em> the printing of the gradient</dt>
<dd><p class="first last">optional, default = on</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pp</span></code>  = flag that turns <em>off</em> the printing of the PMF</dt>
<dd><p class="first last">optional, default = on</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pl</span></code>  = flag that turns <em>off</em> the printing of <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-values</dt>
<dd><p class="first last">optional, default = on</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pu</span></code>  = flag that turns <em>off</em> the printing of uncertainties</dt>
<dd><p class="first last">optional, default = on</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-gr</span></code>  = flag that turns <em>on</em> the plotting of the gradient</dt>
<dd><p class="first last">optional, default = off</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">--analytical</span></code> = turns <em>on</em> the use of analytical gradients
optional, default = off</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">--numerical</span></code> = turns <em>on</em> the use of numerical gradients and selects the kind
optional, default = both
<code class="docutils literal"><span class="pre">both</span></code> = uses the free energy in both backward and forward direction to compute the free energy gradient
<code class="docutils literal"><span class="pre">back</span></code> = uses the free energy in the backward direction to compute the free energy gradient
<code class="docutils literal"><span class="pre">forw</span></code> = uses the free energy in the forward direction to compute the free energy gradient</p>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>calc_ti.py -d out_free/
calc_ti.py -s 200
calc_ti.py -m 200
calc_ti.py -d out_free/ --analytical
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool calculates free energies using the method of thermodynamic integration (TI).</p>
<p>The program expects that in the <code class="docutils literal"><span class="pre">directory</span></code> there exist an output folder for each <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-value, eg. <code class="docutils literal"><span class="pre">lam-0.000</span></code> and <code class="docutils literal"><span class="pre">lam-1.000</span></code></p>
<p>If the <code class="docutils literal"><span class="pre">-gr</span></code> flag is set the gradient with respect to <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/> is plotted and saved to a file called <code class="docutils literal"><span class="pre">gradient.png</span></code></p>
<p>Block estimates can be constructed by combining <code class="docutils literal"><span class="pre">nskip</span></code> and <code class="docutils literal"><span class="pre">nmax</span></code>. For instance, these commands calculates block estimates with a block size of 5 m snapshots</p>
<div class="highlight-python"><div class="highlight"><pre>for X in 0 50 100 150 200 250 300 350
do
calc_bar.py -d out_free -nskip $X -nmax 50 -b 5 -pw -pu
done
</pre></div>
</div>
</div>
<div class="section" id="clear-gcmcbox-py">
<h2>clear_gcmcbox.py<a class="headerlink" href="#clear-gcmcbox-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">clear_gcmcbox.py</span> <span class="pre">-b</span> <span class="pre">boxfile</span> <span class="pre">-s</span> <span class="pre">waterfile</span> <span class="pre">[-o</span> <span class="pre">outfile]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-b</span> <span class="pre">boxfile</span></code> = the name of a PDB file containing a GCMC or JAWS1 box</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-w</span> <span class="pre">waterfile</span></code> = the name of a PDB file containing the bulk water</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the created PDB file containing cleaned bulk water</dt>
<dd><p class="first last">optional, default = cleared_box.pdb</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>clear_gcmcbox.py -b gcmc_box.pdb -w water.pdb
clear_gcmcbox.py -b gcmc_box.pdb -w water.pdb -o water_cleared.pdb
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool clears a GCMC or JAWS-1 simulation box from any bulk water placed there by the solvation method.</p>
<p>In a GCMC and JAWS-1 simulation the bulk water is prevented to enter or exit a GCMC or JAWS-1 simulation box. Therefore, bulk water that are within this box needs to be removed prior to the GCMC or JAWS-1 simulation.</p>
<p>The <code class="docutils literal"><span class="pre">boxfile</span></code> is typically created by <code class="docutils literal"><span class="pre">make_gcmcbox.py</span></code> and the <code class="docutils literal"><span class="pre">waterfile</span></code> is typically created by <code class="docutils literal"><span class="pre">solvate.py</span></code> and can be either a droplet or a box</p>
</div>
<div class="section" id="convertatomnames-py">
<h2>convertatomnames.py<a class="headerlink" href="#convertatomnames-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">convertatomnames.py</span> <span class="pre">-p</span> <span class="pre">pdbfile</span> <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[-s</span> <span class="pre">style]</span> <span class="pre">[-c</span> <span class="pre">conversionfile]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-p</span> <span class="pre">pdbfile</span></code> = the name of a PDB file that should be modified</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the name of the modified PDB file</dt>
<dd><p class="first last">optional, default = protein_pms.pdb</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-s</span> <span class="pre">style</span></code> = the naming convention in pdbfile</dt>
<dd><p class="first last">optional, default = amber</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-c</span> <span class="pre">conversionfile</span></code> = the name of file containing conversion instructions</dt>
<dd><p class="first last">optional, default = atomnamesmap.dat</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>convertatomnames.py -p protein.pdb
convertatomnames.py -p protein.pdb -c $PROTOMSHOME/data/atomnamesmap.dat
convertatomnames.py -p protein.pdb -s charmm
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool converts residue and atom names to ProtoMS convention.</p>
<p>This script modfies in particular names of hydrogen atoms, but also some residue names, e.g. histidines.</p>
<p>A file containing conversion instructions for amber and charmm is available in the <code class="docutils literal"><span class="pre">$PROTOMSHOME/data</span></code> folder.</p>
</div>
<div class="section" id="convertwater-py">
<h2>convertwater.py<a class="headerlink" href="#convertwater-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">convertwater.py</span> <span class="pre">-p</span> <span class="pre">pdbfile</span> <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[-m</span> <span class="pre">model]</span> <span class="pre">[--ignoreh]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-p</span> <span class="pre">pdbfile</span></code> = the name of a PDB containing waters to be modified</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the name of the modified PDB file</dt>
<dd><p class="first last">optional, default = convertedwater.pdb</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-m</span> <span class="pre">model</span></code> = the name of the target water model</dt>
<dd><p class="first last">optional, default = tip4p</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--ignoreh</span></code> = flag that turns <em>on</em> the ignoring of hydrogen atoms</dt>
<dd><p class="first last">optional, default = off</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>convertwater.py -p protein.pdb
convertwater.py -p protein.pdb -m tip3p
convertwater.py -p protein.pdb --ignoreh
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool converts water molecules to a specific model.</p>
<p>Currently the script recognizes TIP3P and TIP4P water models. The valid values for <code class="docutils literal"><span class="pre">style</span></code> is therefore <code class="docutils literal"><span class="pre">t4p,</span> <span class="pre">tip4p,</span> <span class="pre">tp4,</span> <span class="pre">t3p,</span> <span class="pre">tip3p,</span> <span class="pre">tp3</span></code></p>
<p>If the <code class="docutils literal"><span class="pre">--ignoreh</span></code> flag is given, the script will discard the hydrogen atoms found in <code class="docutils literal"><span class="pre">pdbfile</span></code> and add them at a random orientation.</p>
</div>
<div class="section" id="distribute-waters-py">
<h2>distribute_waters.py<a class="headerlink" href="#distribute-waters-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">distribute_waters.py</span> <span class="pre">-b</span> <span class="pre">box</span> <span class="pre">-m</span> <span class="pre">molecules</span> <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[--model</span> <span class="pre">t3p|t4p</span> <span class="pre">]</span> <span class="pre">[--resname</span> <span class="pre">resname]</span> <span class="pre">[--number</span> <span class="pre">number]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-b</span> <span class="pre">box</span></code> = the dimensions of the box where the (water) molecules will be distributed. Six arguments expected: origin (x,y,z) &amp; length (x,y,z)</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-m</span> <span class="pre">molecules</span></code> = either the file containing the molecules to distribute, or the number of water molecules to distribute in the box</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the name of the file where the distributed molecules will be saved</dt>
<dd><p class="first last">optional, default = ghostmolecules.pdb</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--model</span> <span class="pre">t3p|t4p</span></code> = the water model used when a number is especified in &#8216;-m molecules&#8217;</dt>
<dd><p class="first last">optional, default =  t4p
<code class="docutils literal"><span class="pre">t4p</span></code> = tip4p water model
<code class="docutils literal"><span class="pre">t3p</span></code> = tip3p water model</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--resname</span> <span class="pre">resname</span></code> = the residue name used in the outfile when a number is especified in &#8216;-m molecules&#8217;</dt>
<dd><p class="first last">optional, default = WAT</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--number</span> <span class="pre">number</span></code> = the required number of molecules in the box when it differs from the number of molecules in the file specified in &#8216;-m molecules&#8217;</dt>
<dd><p class="first last">optional, default = None (only the molecules in the file will be distributed in the box)</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>distribute_waters.py -b 53.4 56.28 13.23 10 10 10 -m 12
distribute_waters.py -b 53.4 56.28 13.23 10 10 10 -m 12 --model t3p --resname T3P
distribute_waters.py -b 53.4 56.28 13.23 10 10 10 -m myonewater.pdb --number 12 -o mywatersinbox.pdb
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool can place water molecules at random within a GCMC or JAWS-1 simulation box.</p>
<p>It can place molecules in random positions and orientations with their geometry center restricted to the given dimensions of a box.</p>
</div>
<div class="section" id="divide-pdb-py">
<h2>divide_pdb.py<a class="headerlink" href="#divide-pdb-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">divide_pdb.py</span> <span class="pre">[-i</span> <span class="pre">input]</span> <span class="pre">[-o</span> <span class="pre">output]</span> <span class="pre">[-p</span> <span class="pre">path]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-i</span> <span class="pre">input</span></code> = the name of your multi-pdb file</dt>
<dd><p class="first last">optional, default = all.pdb</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">output</span></code> = the beginning of the name of your individual pdb files</dt>
<dd><p class="first last">optional, default = snapshot_</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-p</span> <span class="pre">path</span></code> = the directory where the input should be found and the output printed</dt>
<dd><p class="first last">optional, default = ./</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<dl class="docutils">
<dt>::</dt>
<dd>divide_pdb.py
divide_pdb.py -i mypmsout.pdb -o individual -p outfolder/</dd>
</dl>
<p><strong>Description:</strong></p>
<p>This tool splits up a PDB file with multiple models (the keyword END defines the end of a model) into several PDB files.</p>
</div>
<div class="section" id="generate-input-py">
<h2>generate_input.py<a class="headerlink" href="#generate-input-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">generate_input.py</span> <span class="pre">[-s</span> <span class="pre">equilibration|sampling|dualtopology|singletopology|gcmc|jaws1|jaws2]</span> <span class="pre">[-p</span> <span class="pre">protein.pdb]</span> <span class="pre">[-l</span> <span class="pre">lig1.pdb</span> <span class="pre">lig2.pdb</span> <span class="pre">...]</span> <span class="pre">[-t</span> <span class="pre">template1</span> <span class="pre">template2</span> <span class="pre">...]</span> <span class="pre">[-pw</span> <span class="pre">protwat.pdb]</span> <span class="pre">[-lw</span> <span class="pre">ligwat.pdb]</span> <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[--outfolder</span> <span class="pre">folder]</span> <span class="pre">[--lambdas</span> <span class="pre">nlambdas</span> <span class="pre">|</span> <span class="pre">lambda1</span> <span class="pre">lambda2</span> <span class="pre">...]</span> <span class="pre">[--adams</span> <span class="pre">B1</span> <span class="pre">B2</span> <span class="pre">...]</span> <span class="pre">[--jawsbias</span> <span class="pre">bias]</span> <span class="pre">[--gcmcwater</span> <span class="pre">wat.pdb]</span> <span class="pre">[--gcmcbox</span> <span class="pre">box.pdb]</span> <span class="pre">[--nequil</span> <span class="pre">N]</span> <span class="pre">[--nprod</span> <span class="pre">N]</span> <span class="pre">[--dumpfreq</span> <span class="pre">N]</span> <span class="pre">[--absolute]</span> <span class="pre">[--dovacuum]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-s</span> <span class="pre">equilibration|sampling|dualtopology|singletopology|gcmc|jaws1|jaws2</span></code> = the type of simulation to perform</dt>
<dd><p class="first last">optional, default = equilibration</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-p</span> <span class="pre">protein.pdb</span></code> = the name of the protein PDB file</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-l</span> <span class="pre">lig1.pdb</span> <span class="pre">lig2.pdb</span> <span class="pre">...</span></code> = the name(s) of PDB file(s) containing ligand(s)</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-t</span> <span class="pre">template1</span> <span class="pre">template2</span> <span class="pre">...</span></code> = the name(s) of ProtoMS template file(s) that needs to be loaded</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pw</span> <span class="pre">protwat.pdb</span></code> = the name of a PDB file with bulk water for the protein</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-lw</span> <span class="pre">ligwat.pdb</span></code> = the name of a PDB file with bulk water for the ligand(s)</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the prefix for the created ProtoMS command file</dt>
<dd><p class="first last">optional, default = run</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--outfolder</span> <span class="pre">folder</span></code> = the ProtoMS output folder</dt>
<dd><p class="first last">optional, default = &#8220;&#8221; (empty string)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--lambdas</span> <span class="pre">nlambdas</span> <span class="pre">|</span> <span class="pre">lambda1</span> <span class="pre">lambada2</span></code> ... = specification of <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/> space for free energy calculations</dt>
<dd><p class="first last">optional, default = 16
if a single value is given, this number of <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-values is created uniformly from 0 to 1
if a list of values are given, this is the <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-values to use</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--adams</span> <span class="pre">B1</span> <span class="pre">B2</span> <span class="pre">...</span></code> = the Adams parameter for GCMC</dt>
<dd><p class="first last">optional, default = 0</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--jawsbias</span> <span class="pre">bias</span></code> = the bias to apply in JAWS-2 simulations</dt>
<dd><p class="first last">optional, default = 0</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--gcmcwater</span> <span class="pre">wat.pdb</span></code> = the name of a PDB file with reservoir waters for GCMC and JAWS-1</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--gcmcbox</span> <span class="pre">box.pdb</span></code> = the name of a PDB file with GCMC or JAWS-1 simulation box dimension</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--nequil</span> <span class="pre">N</span></code> = the number of equilibration moves</dt>
<dd><p class="first last">optional, default = 5E6</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--nprod</span> <span class="pre">N</span></code> = the number of production moves</dt>
<dd><p class="first last">optional, default = 40E6</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--dumpfreq</span> <span class="pre">N</span></code> = the frequency with which output is written to disc</dt>
<dd><p class="first last">optional, default = 1E5</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--absolute</span></code> = turns <em>on</em> the setup of absolute free energies</dt>
<dd><p class="first last">optional, default = off</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--dovacuum</span></code> = turns <em>on</em> the setup of vacuum simulation</dt>
<dd><p class="first last">optional, default = off</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>generate_input.py -s dualtopology -l lig1.pdb lig2.pdb -p protein.pdb -t li1-li2.tem -pw droplet.pdb -lw lig1_wat.pdb --lambas 8
generate_input.py -s dualtopology -l lig1.pdb dummy.pdb -t li1-dummy.tem -lw lig1_wat.pdb --absolute
generate_input.py -s gcmc -p protein.pdb -pw droplet.pdb --adams -4 -2 0 2 4 6 --gcmcwater gcmc_water.pdb --gcmcbox gcmc_box.pdb
generate_input.py -s sampling -l lig1.pdb -t lig1.tem --dovacuum
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool generates input files with commands for ProtoMS.</p>
<p>The settings generate are made according to experience and should work in most situations.</p>
<p>The tool will create at most two ProtoMS command files, one for the protein simulation and one for the ligand simulation. These can be used to run ProtoMS, e.g.</p>
<div class="highlight-python"><div class="highlight"><pre>$PROTOMS/protoms3 run_free.cmd
</pre></div>
</div>
</div>
<div class="section" id="make-dummy-py">
<h2>make_dummy.py<a class="headerlink" href="#make-dummy-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">make_dummy.py</span> <span class="pre">-f</span> <span class="pre">pdbfile</span> <span class="pre">[-o</span> <span class="pre">outfile]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-f</span> <span class="pre">pdbfile</span></code> = the name of PDB file containing the solute</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the name of the created dummy PDB file</dt>
<dd><p class="first last">optional, default = dummy.pdb</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>make_dummy.py -f benzene.pdb
make_dummy.py -f benzene.pdb -o benzene_dummy.pdb
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool makes a matching dummy particle for a solute.</p>
<p>The dummy particle will be placed at the centre of the solute.</p>
</div>
<div class="section" id="make-gcmcbox-py">
<h2>make_gcmcbox.py<a class="headerlink" href="#make-gcmcbox-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">make_gcmcbox.py</span> <span class="pre">-s</span> <span class="pre">pdbfile</span> <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[-p</span> <span class="pre">padding]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-s</span> <span class="pre">pdbfile</span></code> = the name of a PDB file containing a solute molecule</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = a PDB file with the created box</dt>
<dd><p class="first last">optional, default = gcmc_box.pdb</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-p</span> <span class="pre">padding</span></code> = the extra space to add to the box in each dimension</dt>
<dd><p class="first last">optional, default = 2.0 A</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>make_gcmcbox.py -s benzene.pdb
make_gcmcbox.py -s benzene.pdb -p 0.0
make_gcmcbox.py -s benzene.pdb -o benzene_gcmc_box.pdb
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool makes a GCMC or JAWS-1 simulation box to fit on top of a solute.</p>
<p>The box will be created so that it has the extreme dimensions of the solute and then <code class="docutils literal"><span class="pre">padding</span></code> will be added in each dimension</p>
<p>The box can be visualised with most common programs, e.g.</p>
<div class="highlight-python"><div class="highlight"><pre>vmd -m benzene.pdb benzene_gcmc_box.pdb
</pre></div>
</div>
<p>this is a good way to see that the box is of appropriate dimensions.</p>
<p>When an appropriate box has been made, it can be used by <code class="docutils literal"><span class="pre">solvate.py</span></code> to fill it with water.</p>
</div>
<div class="section" id="make-single-py">
<h2>make_single.py<a class="headerlink" href="#make-single-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">make_single.py</span> <span class="pre">-t0</span> <span class="pre">template0</span> <span class="pre">-t1</span> <span class="pre">template1</span> <span class="pre">-p0</span> <span class="pre">pdbfile0</span> <span class="pre">-p1</span> <span class="pre">pdbfile1</span> <span class="pre">[-m</span> <span class="pre">map]</span> <span class="pre">[-o</span> <span class="pre">outfile]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-t0</span> <span class="pre">template0</span></code> = the name of a ProtoMS template file of solute at <img class="math" src="_images/math/3d52aae84bb4dafbecb3cbaa1d1f3c34d2f0b067.png" alt="\lambda=0.0"/></p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-t1</span> <span class="pre">template1</span></code> = the name of a ProtoMS template file of solute at <img class="math" src="_images/math/de2b235953cdcca237d3d179abdce516e2553346.png" alt="\lambda`=1.0"/></p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-p0</span> <span class="pre">pdbfile0</span></code> = the name of a PDB file of the solute at <img class="math" src="_images/math/3d52aae84bb4dafbecb3cbaa1d1f3c34d2f0b067.png" alt="\lambda=0.0"/></p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">-p1</span> <span class="pre">pdbfile1</span></code> = the name of a PDB file of the solute at <img class="math" src="_images/math/72b7673db8aec667d9ad50cdcbc58be27b083b2e.png" alt="\lambda=1.0"/></p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-m</span> <span class="pre">map</span></code> = the name of a correspondence map</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the start of the name of the created single-topology templates</dt>
<dd><p class="first last">optional, default = single</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>make_single.py -t0 benzene.tem -t1 toluene.tem -p0 benzene.pdb -p1 toluene.pdb
make_single.py -t0 benzene.tem -t1 toluene.tem -p0 benzene.pdb -p1 toluene.pdb -m bnz2tol.dat
make_single.py -t0 benzene.tem -t1 toluene.tem -p0 benzene.pdb -p1 toluene.pdb -o bnz-tol
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool makes ProtoMS template files for single topology free energy simulations.</p>
<p>The program will automatically try to match atoms in <code class="docutils literal"><span class="pre">template0</span></code> with atoms in <code class="docutils literal"><span class="pre">template1</span></code>. It will do this by looking for atoms with the same atom type that are on top of each other in <code class="docutils literal"><span class="pre">pdbfile0</span></code> and <code class="docutils literal"><span class="pre">pdbfile1</span></code>. A cut-off of 0.02 A2 will be used for this. All atoms that cannot be identified in this way are written to the screen and the user has to enter the corresponding atoms. If no corresponding atom exists, i.e., the atom should be perturbed to a dummy, the user may enter blank.</p>
<p>The user may also write the corresponding atoms to a file and provide it as <code class="docutils literal"><span class="pre">map</span></code> above. In this file there should be one atom pair on each line, separated by white-space. A dummy atom should be denoted as <code class="docutils literal"><span class="pre">DUM</span></code>. If <code class="docutils literal"><span class="pre">map</span></code> is not given, the program will write the created correspondence map to a file based on the <code class="docutils literal"><span class="pre">outfile</span></code> string.</p>
<p>Currently, dummy atoms are not supported in the solute at <img class="math" src="_images/math/3d52aae84bb4dafbecb3cbaa1d1f3c34d2f0b067.png" alt="\lambda=0.0"/>. Therefore, this solute needs to be the larger one.</p>
<p>The tool will write two ProtoMS template files, one for the electrostatic perturbation, one for the van der Waals perturbation and one for the combined perturbation. These template files will end in <code class="docutils literal"><span class="pre">_ele.tem</span></code>, <code class="docutils literal"><span class="pre">_vdw.tem</span></code>, <code class="docutils literal"><span class="pre">_comb.tem</span></code> respectively.</p>
<p>A summary of the charges and van der Waals parameters in the four states will be printed to the screen. This information should be checked carefully.</p>
</div>
<div class="section" id="merge-templates-py">
<h2>merge_templates.py<a class="headerlink" href="#merge-templates-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">merge_templates.py</span> <span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">file2</span> <span class="pre">[file3</span> <span class="pre">...]</span> <span class="pre">-o</span> <span class="pre">outfile</span></code></p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-f</span> <span class="pre">file1</span> <span class="pre">file2</span> <span class="pre">file3</span></code> ... = the ProtoMS template files that should be merged</li>
<li><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the name of the merged ProtoMS templatefile</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>merge_templates.py -f benzene.tem dummy.tem -o bnz-dummy.tem
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool combines several ProtoMS template files into a single template file.</p>
<p>The force field parameters in <code class="docutils literal"><span class="pre">file2</span></code> will be re-numbered so that they do not conflict with <code class="docutils literal"><span class="pre">file1</span></code>. This is important when you want to load both parameters into ProtoMS at the same time.</p>
</div>
<div class="section" id="plot-theta-py">
<h2>plot_theta.py<a class="headerlink" href="#plot-theta-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong>
<code class="docutils literal"><span class="pre">plot_theta.py</span> <span class="pre">[-h]</span> <span class="pre">[-r</span> <span class="pre">results]</span> <span class="pre">[-s</span> <span class="pre">restart]</span> <span class="pre">[-m</span> <span class="pre">molecule]</span> <span class="pre">[-p</span> <span class="pre">plotname]</span> <span class="pre">[--skip]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-r</span> <span class="pre">results</span></code> = the name of the results file</dt>
<dd><p class="first last">optional, deafult = &#8216;results&#8217;</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-s</span> <span class="pre">restart</span></code> = the replica values to plot</dt>
<dd><p class="first last">optional, default = &#8216;restart&#8217;</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-m</span> <span class="pre">molecule</span></code> = the residue name of the JAWS molecule</dt>
<dd><p class="first last">optional, default = &#8216;WAT&#8217;</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-p</span> <span class="pre">plotname</span></code> = the start of the filename for the plots generated</dt>
<dd><p class="first last">optional, default = &#8216;theta_dist&#8217;</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--skip</span></code> = the number of results snapshots to skip</dt>
<dd><p class="first last">optional, default = 0</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>plot_theta.py -m WA1 --skip 50
plot_theta.py -m WA1 -p theta_wa1
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool plots the theta distribution resulting from a JAWS stage one simulation.</p>
<p>Two different histograms will be generated. One in which all different copies of the same molecule are added up, and a different one where each copy is displayed individually.</p>
</div>
<div class="section" id="pms2pymbar-py">
<h2>pms2pymbar.py<a class="headerlink" href="#pms2pymbar-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">pms2pymbar.py</span> <span class="pre">[-d</span> <span class="pre">directory]</span> <span class="pre">[-r</span> <span class="pre">results]</span> <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[-s</span> <span class="pre">nskip]</span> <span class="pre">[-m</span> <span class="pre">nmax]</span> <span class="pre">[-t</span> <span class="pre">temperature]</span> <span class="pre">[--run]</span> <span class="pre">[--nobar]</span></code></p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-d</span> <span class="pre">directory</span></code> = name of output directory of the simulation</dt>
<dd><p class="first last">optional, default = current working directory (.)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-r</span> <span class="pre">results</span></code> = the beginning of the name of the file to analyse</dt>
<dd><p class="first last">optional, default = results</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the name of file with all energy values</dt>
<dd><p class="first last">optional, default = pymbar_energy</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-s</span> <span class="pre">nskip</span></code> = the number of snapshots to skip at the beginning of the simulation</dt>
<dd><p class="first last">optional, default = 0</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-m</span> <span class="pre">nmax</span></code> = the maximum number of snapshots to process</dt>
<dd><p class="first last">optional, default = the total number of snapshot in the results file, excluding nskip</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-t</span> <span class="pre">temperature</span></code> = the simulation temperature in degree Celsius</dt>
<dd><p class="first last">optional, default = 25 degrees</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--run</span></code> = flag indicating if to run pymbar</dt>
<dd><p class="first last">optional, default = No</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--nobar</span></code> = flag indicating if to estimate BAR</dt>
<dd><p class="first last">optional, default = No</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>pms2pymbar.py -d out_free/
pms2pymbar.py -s 200
pms2pymbar.py -m 200
pms2pymbar.py -d out_free/ --run
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool extract free energy data from ProtoMS output files and makes them compatible with the PyMBAR software.</p>
<p>The program expects that in the <code class="docutils literal"><span class="pre">directory</span></code> there exist an output folder for each <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-value, eg. <code class="docutils literal"><span class="pre">lam-0.000</span></code> and <code class="docutils literal"><span class="pre">lam-1.000</span></code></p>
<p>The tool writes a file <code class="docutils literal"><span class="pre">outfile</span></code> to each folder in <code class="docutils literal"><span class="pre">directory</span></code> that is human readable. It contains some header information such as units, current <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-value and total number of &amp;lambda-values. It then contains one row for each snapshot and each of these rows contains a column with the total energy at a specific <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-value., one column for each <img class="math" src="_images/math/1ab0134b6e0837594649c75a2ed83cfd85a2d03d.png" alt="\lambda"/>-value. These files can then be read by PyMBAR.</p>
<p>Alternatively, if PyMBAR is properly installed and can be loaded as a python library, the user can add the <code class="docutils literal"><span class="pre">--run</span></code> flag and the tool will automatically feed PyMBAR with the energy values and compute the free energy using MBAR.</p>
</div>
<div class="section" id="scoop-py">
<h2>scoop.py<a class="headerlink" href="#scoop-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">scoop.py</span> <span class="pre">-p</span> <span class="pre">proteinfile</span> <span class="pre">[-l</span> <span class="pre">ligandfile]</span> <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[--center</span> <span class="pre">center]</span> <span class="pre">[--innercut</span> <span class="pre">icut]</span> <span class="pre">[--outercut</span> <span class="pre">ocut]</span> <span class="pre">[--flexin</span> <span class="pre">sidechain|flexible|rigid]</span> <span class="pre">[--flexout</span> <span class="pre">sidechain|flexible|rigid]</span> <span class="pre">[--terminal</span> <span class="pre">keep|doublekeep|neutralize]</span> <span class="pre">[--excluded</span> <span class="pre">res1</span> <span class="pre">res2</span> <span class="pre">...]</span> <span class="pre">[--added</span> <span class="pre">res1</span> <span class="pre">res2</span> <span class="pre">...]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-p</span> <span class="pre">proteinfile</span></code> = the name of a PDB file containing the protein</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-l</span> <span class="pre">ligandfile</span></code> = the name of a PDB file containing a ligand</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the name of the truncated PDB file</dt>
<dd><p class="first last">optional, default = scoop.pdb</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--center</span> <span class="pre">center</span></code> = the centre of the scoop</dt>
<dd><p class="first last">optional, default = 0.0,0.0,0.0</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--innercut</span> <span class="pre">icut</span></code> == the inner region cut-off in Angstroms</dt>
<dd><p class="first last">optional, default = 16.0 A</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--outercut</span> <span class="pre">ocut</span></code> == the outer region cut-off in Angstroms</dt>
<dd><p class="first last">optional, default = 20.0 A</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--flexin</span> <span class="pre">sidechain|flexible|rigid</span></code> = determine the flexibility of the inner region</dt>
<dd><p class="first last">optional, default = flexible
<code class="docutils literal"><span class="pre">sidechain</span></code> = only the sidechains will be sampled in the simulation
<code class="docutils literal"><span class="pre">flexible</span></code> = both sidechain and backbone will be sampled in the simulation
<code class="docutils literal"><span class="pre">rigid</span></code> = no residues will be sampled</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--flexout</span></code> sidechain|flexible|rigid = determine the flexibility of the outer region</dt>
<dd><p class="first last">optional, default = sidechain
<code class="docutils literal"><span class="pre">sidechain</span></code> = only the sidechains will be sampled in the simulation
<code class="docutils literal"><span class="pre">flexible</span></code> = both sidechain and backbone will be sampled in the simulation
<code class="docutils literal"><span class="pre">rigid</span></code> = no residues will be sampled</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--terminal</span></code> keep|doublekeep|neutralize = determines the treatment of charged terminal residues</dt>
<dd><p class="first last">optional, default = neutralize
<code class="docutils literal"><span class="pre">keep</span></code> = keep any charged terminal
<code class="docutils literal"><span class="pre">doublekeep</span></code> = keep charged terminal but only if both are in the scoop
<code class="docutils literal"><span class="pre">neutralize</span></code> = neutralize any charged terminal within the scoop</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--excluded</span> <span class="pre">res1</span> <span class="pre">res2</span></code> ...</dt>
<dd><p class="first last">one or more reside numbers
optional, default = none</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">--added</span> <span class="pre">res1</span> <span class="pre">res2</span></code> ...</dt>
<dd><p class="first last">one or more reside numbers
optional, default = none</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>scoop.py -p protein.pdb
scoop.py -p protein.pdb  -l benzene.pdb
scoop.py -p protein.pdb  --center &quot;0.0 0.0 0.0&quot;
scoop.py -p protein.pdb  --center origin.dat
scoop.py -p protein.pdb  --innercut 10 --outercut 16
scoop.py -p protein.pdb  --exclude 189 190
scoop.py -p protein.pdb  --added 57 58 59
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool truncates a protein and thereby creating a scoop.</p>
<p>All residues outside <code class="docutils literal"><span class="pre">ocut</span></code> is removed completely. <code class="docutils literal"><span class="pre">icut</span></code> is used to separate the scoop model into two different regions, that possibly can have different sampling regimes. The sampling regimes are determined by <code class="docutils literal"><span class="pre">--flexin</span></code> and <code class="docutils literal"><span class="pre">--flexout</span></code>.</p>
<p>If the user would like to finetune the residues in the scoop this can be done with <code class="docutils literal"><span class="pre">--excluded</span></code> to discard specific residues or <code class="docutils literal"><span class="pre">--added</span></code> to include specific residues.</p>
<p>The scoop will be centred on the <code class="docutils literal"><span class="pre">ligandfile</span></code> is such a file is provided. Otherwise, it will be centred on the flag <code class="docutils literal"><span class="pre">--center</span></code>. The argument to this flag can be either a string with three numbers specifying the centre, as in example three above. It can also be the name of a file containing the centre, as in example four above.</p>
<p>Crystallographic waters that are in <code class="docutils literal"><span class="pre">proteinfile</span></code> will also be truncated at <code class="docutils literal"><span class="pre">ocut</span></code></p>
<p>The PDB file will contain specific instructions for ProtoMS to automatically enforce the values of  <code class="docutils literal"><span class="pre">--flexin</span></code> and <code class="docutils literal"><span class="pre">--flexout</span></code>.</p>
</div>
<div class="section" id="solvate-py">
<h2>solvate.py<a class="headerlink" href="#solvate-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">solvate.py</span> <span class="pre">-b</span> <span class="pre">boxfile</span> <span class="pre">[-s</span> <span class="pre">solutefile]</span> <span class="pre">[-pr</span> <span class="pre">proteinfile]</span> <span class="pre">[-o</span> <span class="pre">outfile]</span> <span class="pre">[-g</span> <span class="pre">box|droplet|flood]</span> <span class="pre">[-p</span> <span class="pre">padding]</span> <span class="pre">[-r</span> <span class="pre">radius]</span> <span class="pre">[-center]</span> <span class="pre">[-n</span> <span class="pre">Amber|ProtoMS]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-b</span> <span class="pre">boxfile</span></code> = the name of a PDB file with pre-equilibrated waters</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-s</span> <span class="pre">solutefile</span></code> = the name of a PDB file with a solute molecule</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-pr</span> <span class="pre">proteinfile</span></code> = the name of a PDB file with a protein</dt>
<dd><p class="first last">optional, no default</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outfile</span></code> = the name of the created water box</dt>
<dd><p class="first last">optional, default = solvent_box.pdb</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-g</span> <span class="pre">box|droplet|flood</span></code></dt>
<dd><p class="first last">optional, default = box
<code class="docutils literal"><span class="pre">box</span></code> = a box of water molecules will be created
<code class="docutils literal"><span class="pre">droplet</span></code> = a droplet of water molecules will be created
<code class="docutils literal"><span class="pre">flood</span></code> = a box will be flooded with water molecules</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-p</span> <span class="pre">padding</span></code> = the minimum distance between solute and the box edge</dt>
<dd><p class="first last">optional, default = 10.0 A</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-r</span> <span class="pre">radius</span></code> = the radius of the water droplet</dt>
<dd><p class="first last">optional, default = 30.0 A</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-c</span> <span class="pre">center</span></code> = the center of the droplet</dt>
<dd><p class="first last">optional, default = &#8220;cent&#8221;</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-n</span> <span class="pre">Amber|ProtoMS</span></code> = the name style of the created water molecules</dt>
<dd><p class="first last">optional, default = ProtoMS
<code class="docutils literal"><span class="pre">Amber</span></code> = Amber naming convention
<code class="docutils literal"><span class="pre">ProtoMS</span></code> = ProtoMS naming convention</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>solvate.py -b $PROTOMSHOME/data/wbox_tip4p.pdb -s benzene.pdb
solvate.py -b $PROTOMSHOME/data/wbox_tip4p.pdb -s benzene.pdb -p 12.0
solvate.py -b $PROTOMSHOME/data/wbox_tip4p.pdb -s benzene.pdb -pr protein.pdb -g droplet
solvate.py -b $PROTOMSHOME/data/wbox_tip4p.pdb -s benzene.pdb -pr protein.pdb -g droplet -r 24.0
solvate.py -b $PROTOMSHOME/data/wbox_tip4p.pdb -pr protein.pdb -g droplet -c 0.0
solvate.py -b $PROTOMSHOME/data/wbox_tip4p.pdb -pr protein.pdb -g droplet -c &quot;0.0 10.0 20.0&quot;
solvate.py -b $PROTOMSHOME/data/wbox_tip4p.pdb -pr protein.pdb -g droplet -c &quot;76 86&quot;
solvate.py -b $PROTOMSHOME/data/wbox_tip4p.pdb -s gcmc_box.pdb -g flood
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool solvates a ligand in either a droplet or a box of water. It can also flood a GCMC or JAWS-1 simulatios box with waters.</p>
<p>Pre-equilibrated boxes to use can be found in the <code class="docutils literal"><span class="pre">$PROTOMSHOME/data</span></code> folder.</p>
<p>To solvate small molecule it is sufficient to give the <code class="docutils literal"><span class="pre">solutefile</span></code> as in the first example above. This produces a box with at least 10 A between the solute and the edge of the water box, which should be sufficient in most situation. Use <code class="docutils literal"><span class="pre">padding</span></code> to increase or decreas the box size as in the second example. The solvation box is created by replicating the pre-equilibrated box in all dimensions and then removing waters that overlap with solute atoms.</p>
<p>To solvate a protein in a droplet, specify <code class="docutils literal"><span class="pre">proteinfile</span></code> and <code class="docutils literal"><span class="pre">droplet</span></code> as in the third example above. This produces a droplet with radius of 30 A, which was choosen to work well with the default options in <code class="docutils literal"><span class="pre">scoop.py</span></code>. Use <code class="docutils literal"><span class="pre">radius</span></code> to obtain a smaller or larger droplet as in the fourth example. The centre of the droplet can be on a ligand if <code class="docutils literal"><span class="pre">ligandfile</span></code> is specified. Otherwise, the <code class="docutils literal"><span class="pre">center``argument</span> <span class="pre">is</span> <span class="pre">used.</span> <span class="pre">This</span> <span class="pre">argument</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">either</span> <span class="pre">``cent</span></code> (the default) that places the droplet at the centre of the protein. It can also take a single number as in the fifth example above in case it is placed at this coordinate in all dimensions. It can also take a string with three numbers which is the origin of the droplet in x, y, and z dimensions, see the sixth example above. If two numbers are given as in the seventh example above, it is assumed that this is an atom range and the droplet will be placed at the centre of these atoms. The droplet is created by putting random waters from the pre-equilibrated box on a grid, displacing them slightly in a random fashion.</p>
<p>The tool can also be used to fill a box with waters for GCMC and JAWS-1 simulations, similar to <code class="docutils literal"><span class="pre">distribute_waters.py</span></code>. In this case the solute is typically a box created by <code class="docutils literal"><span class="pre">make_gcmcbox.py</span></code> and <code class="docutils literal"><span class="pre">flood</span></code> needs to be specified, see the last example above. This gives a box filled with the bulk number of waters.</p>
</div>
<div class="section" id="split-jawswater-py">
<h2>split_jawswater.py<a class="headerlink" href="#split-jawswater-py" title="Permalink to this headline">¶</a></h2>
<p><strong>Syntax:</strong></p>
<p><code class="docutils literal"><span class="pre">split_jawswater.py</span> <span class="pre">-w</span> <span class="pre">pdbfile</span> <span class="pre">[-o</span> <span class="pre">outprefix]</span></code></p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">-w</span> <span class="pre">pdbfile</span></code> = the name of PDB file with water molecules</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">-o</span> <span class="pre">outprefix</span></code> = the prefix appended to all output files</dt>
<dd><p class="first last">optional, default = &#8220;&#8221; (empty string)</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Examples:</strong></p>
<div class="highlight-python"><div class="highlight"><pre>split_jawswater.py -w waters.pdb
split_jawswater.py -w waters.pdb -o jaws2_
</pre></div>
</div>
<p><strong>Description:</strong></p>
<p>This tool splits a PDB file containing multiple water molecules into PDB files appropriate for JAWS-2.</p>
<p>For each water molecule in <code class="docutils literal"><span class="pre">pdbfile</span></code> the tool will write a PDB file with individual water molecules named <code class="docutils literal"><span class="pre">outprefix+watN.pdb</span></code> where N is the serial number of the water molecule. Furthermore, the tool will write a PDB file with all the other molecules and name if <code class="docutils literal"><span class="pre">outprefix+notN.pdb</span></code> where again N is the serial number of the water molecule. In these latter PDB-files, the water residue name is changed to that of the bulk water, e.g., <code class="docutils literal"><span class="pre">t3p</span></code> or <code class="docutils literal"><span class="pre">t4p</span></code>.</p>
<p>For instance, if <code class="docutils literal"><span class="pre">waters.pdb</span></code> in the second example above contains 3 water molecule, this tool will create the following files:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">jaws2_wat1</span><span class="o">.</span><span class="n">pdb</span>
<span class="n">jaws2_wat2</span><span class="o">.</span><span class="n">pdb</span>
<span class="n">jaws2_wat3</span><span class="o">.</span><span class="n">pdb</span>

<span class="n">jaws2_not1</span><span class="o">.</span><span class="n">pdb</span>
<span class="n">jaws2_not2</span><span class="o">.</span><span class="n">pdb</span>
<span class="n">jaws2_not3</span><span class="o">.</span><span class="n">pdb</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="testsuite.html" title="Test Suite"
             >next</a> |</li>
        <li class="right" >
          <a href="protomspy.html" title="protoms.py"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, C. J. Woods, J Michel, M. Bodnarchuk, S. Genheden, R. Bradshaw, G. Ross, C. Cave-Ayland, A. I. Cabedo Martinez, J. Graham.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
  </body>
</html>